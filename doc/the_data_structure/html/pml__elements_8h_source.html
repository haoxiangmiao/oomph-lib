<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: pml_elements.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../figures/manifest.json">
<link rel="mask-icon" href="../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../html/index.html"><img alt="oomph-lib" src="../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_4075b182e53a3873a42d885f4e1e98c4.html">generic</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">pml_elements.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="pml__elements_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//LIC// ====================================================================</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//LIC// multi-physics finite-element library, available </span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//LIC// at http://www.oomph-lib.org.</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//LIC// </span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//LIC//    Version 1.0; svn revision $LastChangedRevision: 1282 $</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//LIC//</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//LIC// $LastChangedDate: 2017-01-16 08:27:53 +0000 (Mon, 16 Jan 2017) $</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//LIC// </span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//LIC// Copyright (C) 2006-2016 Matthias Heil and Andrew Hazel</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//LIC// </span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//LIC// </span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//LIC// Lesser General Public License for more details.</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//LIC// </span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//LIC// 02110-1301  USA.</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//LIC// </span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">//LIC// </span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">//LIC//====================================================================</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#ifndef OOMPH_PML_ELEMENT_HEADER</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#define OOMPH_PML_ELEMENT_HEADER</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">// Config header generated by autoconfig</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#ifdef HAVE_CONFIG_H</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;oomph-lib-config.h&gt;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pml__mapping__functions_8h.html">pml_mapping_functions.h</a>&quot;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="elements_8h.html">elements.h</a>&quot;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="complex__matrices_8h.html">complex_matrices.h</a>&quot;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &lt;complex&gt;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceoomph.html">oomph</a></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;{</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">// typedef used to avoid inaccessible error in Rip struct</span></div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="namespaceoomph.html#a3a774afab5900fed47e092a013f9efb8">   48</a></span>&#160;<span class="keyword">typedef</span> <a class="code" href="classoomph_1_1FiniteElement.html">FiniteElement</a>* <a class="code" href="namespaceoomph.html#a3a774afab5900fed47e092a013f9efb8">FiniteElementPt</a>;</div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="namespaceoomph.html#a14fee011765f6f5c9d1923650cf4018e">   49</a></span>&#160;<span class="keyword">typedef</span> <a class="code" href="classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> <a class="code" href="namespaceoomph.html#a14fee011765f6f5c9d1923650cf4018e">GeneralisedElementTypedef</a>;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">//=======================================================================</span><span class="comment"></span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">/// Policy class for defining the equivalent quad element for any given</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">/// element. Used for constructing a structured PML around an unstructured</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">/// mesh. Needs to be instantiated for each bulk element class</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div><div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="classoomph_1_1EquivalentQElement.html">   57</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1EquivalentQElement.html">EquivalentQElement</a></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;{</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;};</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">//==============================================================</span><span class="comment"></span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">/// Base class for elements with pml capabilities</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment"></span><span class="comment">//==============================================================</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM&gt;</div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLElementBase.html">   65</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1PMLElementBase.html">PMLElementBase</a> : <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1FiniteElement.html">FiniteElement</a></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;{</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">  /// Constructor</span></div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLElementBase.html#ad29eae1793cca20aafa774086da1fc47">   71</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1PMLElementBase.html#ad29eae1793cca20aafa774086da1fc47">PMLElementBase</a>() : Pml_is_enabled(false) {}</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">  /// Virtual destructor</span></div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLElementBase.html#a2a9399aa63600f5276e865dde49f164a">   74</a></span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <a class="code" href="classoomph_1_1PMLElementBase.html#a2a9399aa63600f5276e865dde49f164a">~PMLElementBase</a>(){}</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">  /// \short Disable pml</span></div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLElementBase.html#a751943790221819c111da99455275bbc">   77</a></span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PMLElementBase.html#a751943790221819c111da99455275bbc">disable_pml</a>()</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    Pml_is_enabled=<span class="keyword">false</span>;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  }</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">  /// \short Enable pml</span></div><div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLElementBase.html#a4eb9bdef561b94ba2e9b515bad6ccf57">   83</a></span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1PMLElementBase.html#a4eb9bdef561b94ba2e9b515bad6ccf57">enable_pml</a>()</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    Pml_is_enabled=<span class="keyword">true</span>;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  }</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">  ///</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> pml_transformation_jacobian(</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x,</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="classoomph_1_1DenseComplexMatrix.html">DenseComplexMatrix</a>&amp; jacobian) = 0;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">  ///</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> pml_transformation_jacobian(</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; s,</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x,</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="classoomph_1_1DenseComplexMatrix.html">DenseComplexMatrix</a>&amp; jacobian_matrix,</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector</a>&lt;std::complex&lt;double&gt; &gt;&amp; transformed_x) = 0;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">  /// \short Pure virtual function in which we have to specify the</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">  /// values to be pinned (and set to zero) on the outer edge of</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">  /// the pml layer. This is usually all of the nodal values</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">  /// (values 0 and 1 (real and imag part) for Helmholtz; </span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">  /// values 0,1,2 and 3 (real and imag part of x- and y-displacement</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">  /// for 2D time-harmonic linear elasticity; etc.). Vector</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">  /// must be resized internally!</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> values_to_be_pinned_on_outer_pml_boundary(</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;unsigned&gt;</a>&amp; values_to_pin)=0;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLElementBase.html#aa5b90942c96259fd87804d5967f0b2ee">  113</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1PMLElementBase.html#aa5b90942c96259fd87804d5967f0b2ee">wavenumber</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(<span class="stringliteral">&quot;PML elements must implement wavenumber()&quot;</span>,</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  }</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">  /// \short Computes laplace matrix (JJ^T)^-1|J| and determinant</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">  /// |J| for jacobian J. Laplace matrix is so named because it</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">  /// appears as the factor when the Laplace operator is transformed </span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <span class="keywordtype">void</span> compute_laplace_matrix_and_det(</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1DenseComplexMatrix.html">DenseComplexMatrix</a>&amp; jacobian,</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="classoomph_1_1DenseComplexMatrix.html">DenseComplexMatrix</a>&amp; laplace_matrix,</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    std::complex&lt;double&gt;&amp; jacobian_det);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">  /// \short Computes laplace matrix (JJ^T)^-1|J| and determinant</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">  /// |J| for diagonal matrix jacobian J. Laplace matrix is so named because it</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">  /// appears as the factor when the Laplace operator is transformed </span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <span class="keywordtype">void</span> compute_laplace_matrix_and_det(</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1DiagonalComplexMatrix.html">DiagonalComplexMatrix</a>&amp; jacobian,</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="classoomph_1_1DiagonalComplexMatrix.html">DiagonalComplexMatrix</a>&amp; laplace_matrix,</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    std::complex&lt;double&gt;&amp; jacobian_det);</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">  /// \short Computes laplace matrix (JJ^T)^-1|J| and determinant</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">  /// |J| for diagonal matrix jacobian J. Laplace matrix is so named because it</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">  /// appears as the factor when the Laplace operator is transformed </span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <span class="keywordtype">void</span> compute_laplace_matrix_and_det(</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1DiagonalComplexMatrix.html">DiagonalComplexMatrix</a>&amp; jacobian,</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <a class="code" href="classoomph_1_1DenseComplexMatrix.html">DenseComplexMatrix</a>&amp; laplace_matrix,</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    std::complex&lt;double&gt;&amp; jacobian_det);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">  /// \short Computes the inverse J^-1 and determinant |J| of a Jacobian J</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"></span>  <span class="keyword">static</span> <span class="keywordtype">void</span> compute_jacobian_inverse_and_det(</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1DiagonalComplexMatrix.html">DiagonalComplexMatrix</a>&amp; jacobian,</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="classoomph_1_1DiagonalComplexMatrix.html">DiagonalComplexMatrix</a>&amp; jacobian_inverse,</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    std::complex&lt;double&gt;&amp; jacobian_det);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="keyword">protected</span>:</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">  /// Boolean indicating if element is used in pml mode</span></div><div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="classoomph_1_1PMLElementBase.html#a0b0e980998764978801a1f0463a31989">  153</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="classoomph_1_1PMLElementBase.html#a0b0e980998764978801a1f0463a31989">Pml_is_enabled</a>;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;};</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="keyword">template</span>&lt;<span class="keywordtype">unsigned</span> DIM&gt;</div><div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisAlignedPMLElement.html">  160</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1AxisAlignedPMLElement.html">AxisAlignedPMLElement</a> : <span class="keyword">public</span> <a class="code" href="classoomph_1_1PMLElementBase.html">PMLElementBase</a>&lt;DIM&gt;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;{</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="comment"></span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">  /// Constructor</span></div><div class="line"><a name="l00165"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisAlignedPMLElement.html#acb3d0ce377bf928f0fa83deedef775f0">  165</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1AxisAlignedPMLElement.html#acb3d0ce377bf928f0fa83deedef775f0">AxisAlignedPMLElement</a>() : </div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    Pml_direction_active(DIM,false),</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    Pml_inner_boundary(DIM,0.0),</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    Pml_outer_boundary(DIM,0.0)</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  {}</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">  ///</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> pml_transformation_jacobian(</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x,</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="classoomph_1_1DiagonalComplexMatrix.html">DiagonalComplexMatrix</a>&amp; jacobian);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    </div><div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisAlignedPMLElement.html#a9fba3c6d10af49f64833ecfe97b730c5">  178</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AxisAlignedPMLElement.html#a9fba3c6d10af49f64833ecfe97b730c5">pml_transformation_jacobian</a>(</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; s,</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x,</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="classoomph_1_1DenseComplexMatrix.html">DenseComplexMatrix</a>&amp; jacobian)</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  {</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(<span class="stringliteral">&quot;AxisAlignedPMLElements produce diagonal matrices,&quot;</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                        <span class="stringliteral">&quot;use the diagonal version of this function instead&quot;</span>,</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  }</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">  ///</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> pml_transformation_jacobian(</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; s,</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x,</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="classoomph_1_1DiagonalComplexMatrix.html">DiagonalComplexMatrix</a>&amp; jacobian_matrix,</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector</a>&lt;std::complex&lt;double&gt; &gt;&amp; transformed_x);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">  ///</span></div><div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisAlignedPMLElement.html#a808e638b642342a84da6749cdcdf78e4">  199</a></span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AxisAlignedPMLElement.html#a808e638b642342a84da6749cdcdf78e4">pml_transformation_jacobian</a>(</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; s,</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x,</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="classoomph_1_1DenseComplexMatrix.html">DenseComplexMatrix</a>&amp; jacobian_matrix,</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector</a>&lt;std::complex&lt;double&gt; &gt;&amp; transformed_x)</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classoomph_1_1OomphLibError.html">OomphLibError</a>(<span class="stringliteral">&quot;AxisAlignedPMLElements produce diagonal matrices,&quot;</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                        <span class="stringliteral">&quot;use the diagonal version of this function instead&quot;</span>,</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  }</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">  /// \short Disable pml. Ensures the PML-ification in all directions</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">  /// has been deactivated</span></div><div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisAlignedPMLElement.html#ace457b4782c083fd8b0925ae6b19a3e3">  214</a></span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AxisAlignedPMLElement.html#ace457b4782c083fd8b0925ae6b19a3e3">disable_pml</a>()</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  {</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">// Disable base class attributes</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="classoomph_1_1PMLElementBase.html#a751943790221819c111da99455275bbc">PMLElementBase&lt;DIM&gt;::disable_pml</a>();</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="comment">// Loop over the entries in Pml_direction_active and deactivate the</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">// PML in this direction</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> direction=0;direction&lt;DIM;direction++)</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    {</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="comment">// Disable the PML in this direction</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      Pml_direction_active[direction]=<span class="keyword">false</span>;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  } <span class="comment">// End of disable_pml</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; <span class="comment"></span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">  /// \short Enable pml. Specify the coordinate direction along which </span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">  /// pml boundary is constant, as well as the coordinate</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">  /// along the dimension for the interface between the physical and artificial</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">  /// domains and the coordinate for the outer boundary.</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">  /// All of these are used to adjust the perfectly matched layer</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">  /// mechanism. Needs to be called separately for each pml-ified direction</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">  /// (if needed -- e.g. in corner elements)</span></div><div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisAlignedPMLElement.html#a76a879c7122fc2e5b723fbc7ce6b602b">  235</a></span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AxisAlignedPMLElement.html#a76a879c7122fc2e5b723fbc7ce6b602b">enable_pml</a>(<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; direction,</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; pml_inner_boundary, </div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; pml_outer_boundary)</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  {</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="classoomph_1_1PMLElementBase.html#a4eb9bdef561b94ba2e9b515bad6ccf57">PMLElementBase&lt;DIM&gt;::enable_pml</a>();</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    Pml_direction_active[direction] = <span class="keyword">true</span>;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    Pml_inner_boundary[direction] = pml_inner_boundary;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    Pml_outer_boundary[direction] = pml_outer_boundary;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  }</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisAlignedPMLElement.html#a157cd9d30c5d1f86d17b4b25bc705f76">  245</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AxisAlignedPMLElement.html#a157cd9d30c5d1f86d17b4b25bc705f76">enable_pml</a>(<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; direction,</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; pml_inner_boundary, </div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; pml_outer_boundary,</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                          <a class="code" href="classoomph_1_1UniaxialPMLMapping.html">UniaxialPMLMapping</a>* pml_mapping_pt)</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  {</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    enable_pml(direction, pml_inner_boundary, pml_outer_boundary);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    Pml_mapping_pt = pml_mapping_pt;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  }</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="comment"></span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">  /// Return a pointer to the PML Mapping object</span></div><div class="line"><a name="l00255"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisAlignedPMLElement.html#adcb4bb14ff2f185cdfd31aa51b1f015d">  255</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1UniaxialPMLMapping.html">UniaxialPMLMapping</a>* &amp;<a class="code" href="classoomph_1_1AxisAlignedPMLElement.html#adcb4bb14ff2f185cdfd31aa51b1f015d">pml_mapping_pt</a>() {<span class="keywordflow">return</span> Pml_mapping_pt;}</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">  /// Return a pointer to the PML Mapping object (const version)</span></div><div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisAlignedPMLElement.html#ab67dd8501cbdeb896ff34d3cd8645434">  258</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1UniaxialPMLMapping.html">UniaxialPMLMapping</a>* <span class="keyword">const</span> &amp;<a class="code" href="classoomph_1_1AxisAlignedPMLElement.html#ab67dd8501cbdeb896ff34d3cd8645434">pml_mapping_pt</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> Pml_mapping_pt;}</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">  /// Vector which points from the inner boundary to x</span></div><div class="line"><a name="l00261"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisAlignedPMLElement.html#a554c5768cdf2543b76a507dacd7fe54b">  261</a></span>&#160;<span class="comment"></span>  <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1AxisAlignedPMLElement.html#a554c5768cdf2543b76a507dacd7fe54b">nu</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x, <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)<span class="keyword"> const</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">return</span> x[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] - this-&gt;Pml_inner_boundary[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  }</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">  /// Vector which points from the inner boundary to x</span></div><div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisAlignedPMLElement.html#ae278a54184e8134f57aa361bfc1cc975">  267</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AxisAlignedPMLElement.html#ae278a54184e8134f57aa361bfc1cc975">nu</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x, <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> nu_vec)<span class="keyword"> const</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    {</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      nu_vec[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = nu(x, <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    }</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  }</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">  /// Vector which points from the inner boundary to x</span></div><div class="line"><a name="l00276"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisAlignedPMLElement.html#af5689e98392072da121eafa0b438e44c">  276</a></span>&#160;<span class="comment"></span>  <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1AxisAlignedPMLElement.html#af5689e98392072da121eafa0b438e44c">delta</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>)<span class="keyword"> const</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">return</span> this-&gt;Pml_outer_boundary[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] - this-&gt;Pml_inner_boundary[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">  /// Vector which points from the inner boundary to x</span></div><div class="line"><a name="l00282"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisAlignedPMLElement.html#a37d292c06ab74db30dcb6e8f7cea4033">  282</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AxisAlignedPMLElement.html#a37d292c06ab74db30dcb6e8f7cea4033">delta</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x, <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> delta)<span class="keyword"> const</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>=0; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>&lt;DIM; <a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>++)</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    {</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      delta[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] = this-&gt;Pml_outer_boundary[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>] - this-&gt;Pml_inner_boundary[<a class="code" href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a>];</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    }</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  }</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="keyword">protected</span>:</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="comment"></span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">  /// \short Coordinate direction along which pml boundary is constant; </span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">  /// alternatively: coordinate direction in which coordinate stretching</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">  /// is performed.</span></div><div class="line"><a name="l00295"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisAlignedPMLElement.html#a6cc25fecc2e0f0b8a4920aae2e64964a">  295</a></span>&#160;<span class="comment"></span>  std::vector&lt;bool&gt; <a class="code" href="classoomph_1_1AxisAlignedPMLElement.html#a6cc25fecc2e0f0b8a4920aae2e64964a">Pml_direction_active</a>;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">  /// \short Coordinate of inner pml boundary </span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">  /// (Storage is provided for any coordinate</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">  /// direction; only the entries for &quot;active&quot; directions is used.)</span></div><div class="line"><a name="l00300"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisAlignedPMLElement.html#adecf1b401aeab5399ce576c19667e455">  300</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="classoomph_1_1AxisAlignedPMLElement.html#adecf1b401aeab5399ce576c19667e455">Pml_inner_boundary</a>;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">  /// \short Coordinate of outer pml boundary </span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">  /// (Storage is provided for any coordinate</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">  /// direction; only the entries for &quot;active&quot; directions is used.)</span></div><div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisAlignedPMLElement.html#aff04e9e225d24b9ce877204b7ae22921">  305</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="classoomph_1_1AxisAlignedPMLElement.html#aff04e9e225d24b9ce877204b7ae22921">Pml_outer_boundary</a>;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  </div><div class="line"><a name="l00307"></a><span class="lineno"><a class="line" href="classoomph_1_1AxisAlignedPMLElement.html#abb5b63cb5d08885239627640a74dd9d9">  307</a></span>&#160;  <a class="code" href="classoomph_1_1UniaxialPMLMapping.html">UniaxialPMLMapping</a>* <a class="code" href="classoomph_1_1AxisAlignedPMLElement.html#abb5b63cb5d08885239627640a74dd9d9">Pml_mapping_pt</a>;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;};</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularPMLElementBase.html">  310</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1AnnularPMLElementBase.html">AnnularPMLElementBase</a> : <span class="keyword">public</span> <a class="code" href="classoomph_1_1PMLElementBase.html">PMLElementBase</a>&lt;2&gt;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;{</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">  ///</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> pml_transformation_jacobian(</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x,</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="classoomph_1_1DenseComplexMatrix.html">DenseComplexMatrix</a>&amp; jacobian) = 0;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">  ///</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> pml_transformation_jacobian(</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; s,</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x,</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <a class="code" href="classoomph_1_1DenseComplexMatrix.html">DenseComplexMatrix</a>&amp; jacobian_matrix,</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector</a>&lt;std::complex&lt;double&gt; &gt;&amp; transformed_x) = 0;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordtype">void</span> radial_to_cartesian_jacobian(</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; r,</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; theta,</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keyword">const</span> std::complex&lt;double&gt;&amp; transformed_r,</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keyword">const</span> std::complex&lt;double&gt;&amp; dtransformed_r_dr,</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <a class="code" href="classoomph_1_1DenseComplexMatrix.html">DenseComplexMatrix</a>&amp; cartesian_jacobian) <span class="keyword">const</span>;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keywordtype">void</span> radial_to_cartesian_jacobian(</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; r,</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; theta,</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keyword">const</span> std::complex&lt;double&gt;&amp; rt,</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1DenseComplexMatrix.html">DenseComplexMatrix</a>&amp; radial_jacobian,</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <a class="code" href="classoomph_1_1DenseComplexMatrix.html">DenseComplexMatrix</a>&amp; cartesian_jacobian) <span class="keyword">const</span>;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">  /// \short get the Jacobian of the mapping from transformed r to the radial</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">  /// through-the-pml coordinate. Also returns the transformed_r at this point too</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">  /// as it is required for the transformation to cartesian coordinates</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> radial_transformation_jacobian(</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; nu,</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; delta,</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    std::complex&lt;double&gt;&amp; transformed_r,</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    std::complex&lt;double&gt;&amp; dtransformed_r_dr) <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  </div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> radius(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; s, <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x) = 0;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> nu(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; s, <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x) = 0;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> theta(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; s, <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x) = 0;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  </div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> delta() = 0;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;};</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromCartesianPMLElement.html">  368</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1AnnularFromCartesianPMLElement.html">AnnularFromCartesianPMLElement</a> : <span class="keyword">public</span> <a class="code" href="classoomph_1_1AnnularPMLElementBase.html">AnnularPMLElementBase</a></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;{</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="comment"></span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">  /// Constructor</span></div><div class="line"><a name="l00373"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromCartesianPMLElement.html#aa54f360cf010ad8f30c3dbf27f699ae3">  373</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1AnnularFromCartesianPMLElement.html#aa54f360cf010ad8f30c3dbf27f699ae3">AnnularFromCartesianPMLElement</a>() :</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    Pml_inner_radius(0.0),</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    Pml_outer_radius(0.0),</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    Origin(2, 0.0),</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    Pml_mapping_pt(0)</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    {}</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">  /// Enable pml. Specify the inner and outer radius of PML and the origin</span></div><div class="line"><a name="l00381"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromCartesianPMLElement.html#ad5ac4bafd6684b1cff949e74493aff83">  381</a></span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AnnularFromCartesianPMLElement.html#ad5ac4bafd6684b1cff949e74493aff83">enable_pml</a>(</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; inner_pml_radius, </div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; outer_pml_radius,</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; origin,</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <a class="code" href="classoomph_1_1UniaxialPMLMapping.html">UniaxialPMLMapping</a>* pml_mapping_pt)</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  {</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <a class="code" href="classoomph_1_1PMLElementBase.html#a4eb9bdef561b94ba2e9b515bad6ccf57">PMLElementBase&lt;2&gt;::enable_pml</a>();</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    Pml_inner_radius = inner_pml_radius;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    Pml_outer_radius = outer_pml_radius;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    Origin = origin;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    Pml_mapping_pt = pml_mapping_pt;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  }</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromCartesianPMLElement.html#acb66a5412d96aef573a498ffc8f7a72d">  394</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1AnnularFromCartesianPMLElement.html#acb66a5412d96aef573a498ffc8f7a72d">radius</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x)</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  {</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordflow">return</span> sqrt(std::pow(x[0]-Origin[0],2) + std::pow(x[1]-Origin[1],2));</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  }</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">  /// Coordinate which goes through the PML</span></div><div class="line"><a name="l00400"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromCartesianPMLElement.html#acac12e9f2f6df3e9edebb7747ce4fab8">  400</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1AnnularFromCartesianPMLElement.html#acac12e9f2f6df3e9edebb7747ce4fab8">nu</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x)</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordflow">return</span> nu(radius(s, x));</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  }</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">  /// Coordinate which goes through the PML</span></div><div class="line"><a name="l00406"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromCartesianPMLElement.html#a28f1b489affa8a37c0c0973cf9324157">  406</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1AnnularFromCartesianPMLElement.html#a28f1b489affa8a37c0c0973cf9324157">nu</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; r)</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">return</span> r - Pml_inner_radius;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  }</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">  /// Thickness of PML</span></div><div class="line"><a name="l00412"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromCartesianPMLElement.html#a9cf84a8abb2f74bf71b6dbf4cc3958f1">  412</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1AnnularFromCartesianPMLElement.html#a9cf84a8abb2f74bf71b6dbf4cc3958f1">delta</a>() { <span class="keywordflow">return</span> Pml_outer_radius - Pml_inner_radius; }</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">  /// Angle relative to origin</span></div><div class="line"><a name="l00415"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromCartesianPMLElement.html#a7c681a8ec4f83f5e9989a8d2fee4de91">  415</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1AnnularFromCartesianPMLElement.html#a7c681a8ec4f83f5e9989a8d2fee4de91">theta</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x)</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  {</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordflow">return</span> atan2(x[1]-Origin[1], x[0]-Origin[0]);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  }</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">  /// \short get the Jacobian of the mapping from transformed r to the radial</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">  /// through-the-pml coordinate. Also returns the transformed_r at this point too</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">  /// as it is required for the transformation to cartesian coordinates</span></div><div class="line"><a name="l00423"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromCartesianPMLElement.html#a4095e343d2a36dac4e1d5f69402a4ff3">  423</a></span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AnnularFromCartesianPMLElement.html#a4095e343d2a36dac4e1d5f69402a4ff3">radial_transformation_jacobian</a>(</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; nu,</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; delta,</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    std::complex&lt;double&gt;&amp; transformed_r,</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    std::complex&lt;double&gt;&amp; dtransformed_r_dr)</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  {</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> k = this-&gt;wavenumber();</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    transformed_r = Pml_inner_radius</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                    + Pml_mapping_pt-&gt;transformed_nu(nu, delta, k);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    dtransformed_r_dr = Pml_mapping_pt-&gt;dtransformed_nu_dnu(nu, delta, k);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  }</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="keyword">protected</span>:</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="comment"></span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">  /// \short Coordinate direction along which pml boundary is constant; </span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">  /// alternatively: coordinate direction in which coordinate stretching</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">  /// is performed.</span></div><div class="line"><a name="l00440"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromCartesianPMLElement.html#ab456fc3ba012d0fe871df2f580298a52">  440</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1AnnularFromCartesianPMLElement.html#ab456fc3ba012d0fe871df2f580298a52">Pml_inner_radius</a>;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">  /// \short Coordinate of inner pml boundary </span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">  /// (Storage is provided for any coordinate</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">  /// direction; only the entries for &quot;active&quot; directions is used.)</span></div><div class="line"><a name="l00445"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromCartesianPMLElement.html#a2dd7b0074775618fcb2e1072fd81d10a">  445</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1AnnularFromCartesianPMLElement.html#a2dd7b0074775618fcb2e1072fd81d10a">Pml_outer_radius</a>;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">  /// \short Coordinate of outer pml boundary </span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">  /// (Storage is provided for any coordinate</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">  /// direction; only the entries for &quot;active&quot; directions is used.)</span></div><div class="line"><a name="l00450"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromCartesianPMLElement.html#aa31e399eca5049053bce373144a52de0">  450</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> <a class="code" href="classoomph_1_1AnnularFromCartesianPMLElement.html#aa31e399eca5049053bce373144a52de0">Origin</a>;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  </div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="comment">// A uniaxial PML mapping used to transform the radial coordinate</span></div><div class="line"><a name="l00453"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromCartesianPMLElement.html#aae716d46c00db3cec8b6cf2816440f55">  453</a></span>&#160;  <a class="code" href="classoomph_1_1UniaxialPMLMapping.html">UniaxialPMLMapping</a>* <a class="code" href="classoomph_1_1AnnularFromCartesianPMLElement.html#aae716d46c00db3cec8b6cf2816440f55">Pml_mapping_pt</a>;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;};</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html">  457</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html">AnnularFromLocalCoordinatePMLElement</a> : <span class="keyword">public</span> <a class="code" href="classoomph_1_1AnnularPMLElementBase.html">AnnularPMLElementBase</a></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;{</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="comment"></span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">  /// Constructor</span></div><div class="line"><a name="l00462"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a3e7cb53dd208524cb5378d1ec2ee1e89">  462</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a3e7cb53dd208524cb5378d1ec2ee1e89">AnnularFromLocalCoordinatePMLElement</a>() :</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    Nu_s_index(0),</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    Nu_at_s_min(0.0),</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    Nu_at_s_max(0.0),</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    Theta_s_index(0),</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    Theta_at_s_min(0.0),</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    Theta_at_s_max(0.0),</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    Pml_inner_radius(0.0),</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    Pml_outer_radius(0.0)</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  {}</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="comment"></span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">  /// Constructor</span></div><div class="line"><a name="l00474"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a32ef4115b2cce33d4ec93a5620807685">  474</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a32ef4115b2cce33d4ec93a5620807685">AnnularFromLocalCoordinatePMLElement</a>(</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordtype">unsigned</span> nu_s_index,</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordtype">double</span> nu_at_s_min,</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordtype">double</span> nu_at_s_max,</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordtype">unsigned</span> theta_s_index,</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordtype">double</span> theta_at_s_min,</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keywordtype">double</span> theta_at_s_max,</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordtype">double</span> pml_inner_radius,</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordtype">double</span> pml_outer_radius) :</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    Nu_s_index(nu_s_index),</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    Nu_at_s_min(nu_at_s_min),</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    Nu_at_s_max(nu_at_s_max),</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    Theta_s_index(theta_s_index),</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    Theta_at_s_min(theta_at_s_min),</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    Theta_at_s_max(theta_at_s_max),</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    Pml_inner_radius(pml_inner_radius),</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    Pml_outer_radius(pml_outer_radius)</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  {}</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">  /// Enable pml. Specify the inner and outer radius of PML and the origin</span></div><div class="line"><a name="l00494"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a232008f72c0ee625d59b1e588c850dfe">  494</a></span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a232008f72c0ee625d59b1e588c850dfe">enable_pml</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; inner_pml_radius, </div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; outer_pml_radius, <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; origin)</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  {</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <a class="code" href="classoomph_1_1PMLElementBase.html#a4eb9bdef561b94ba2e9b515bad6ccf57">PMLElementBase&lt;2&gt;::enable_pml</a>();</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  }</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> s_min();</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> s_max();</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">  /// Coordinate which goes through the PML in terms of local coordinate</span></div><div class="line"><a name="l00505"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a161e427b6f1fc6349b9667caf346cf8a">  505</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a161e427b6f1fc6349b9667caf346cf8a">nu</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x)</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  {</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordflow">return</span> (s[Nu_s_index]-s_min())/(s_max()-s_min())*(Nu_at_s_max-Nu_at_s_min)</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;           + Nu_at_s_min;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  }</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">  /// Thickness of PML</span></div><div class="line"><a name="l00512"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#affe7de11a2275aac57b0ea2c0594ce7d">  512</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#affe7de11a2275aac57b0ea2c0594ce7d">delta</a>() { <span class="keywordflow">return</span> Pml_outer_radius - Pml_inner_radius; }</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">  /// Angle relative to origin</span></div><div class="line"><a name="l00515"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#ae9f56654db4d7979163db0529d9a1408">  515</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#ae9f56654db4d7979163db0529d9a1408">theta</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>, <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x)</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  {</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordflow">return</span> (s[Theta_s_index]-s_min())/(s_max()-s_min())</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;              *(Theta_at_s_max - Theta_at_s_min)</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;           + Theta_at_s_min;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  }</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">  /// \short get the Jacobian of the mapping from transformed r to the radial</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">  /// through-the-pml coordinate. Also returns the transformed_r at this point too</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">  /// as it is required for the transformation to cartesian coordinates</span></div><div class="line"><a name="l00525"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#ab44027b0ebf468154752cc09d46d3a5d">  525</a></span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#ab44027b0ebf468154752cc09d46d3a5d">radial_transformation_jacobian</a>(</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; nu,</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; delta,</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    std::complex&lt;double&gt;&amp; transformed_r,</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    std::complex&lt;double&gt;&amp; dtransformed_r_dr)</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  {</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> k = this-&gt;wavenumber();</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    transformed_r = Pml_inner_radius</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                    + Pml_mapping_pt-&gt;transformed_nu(nu, delta, k);</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    dtransformed_r_dr = Pml_mapping_pt-&gt;dtransformed_nu_dnu(nu, delta, k);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  }</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="keyword">protected</span>:</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">  /// \short Index of local coordinate which nu (through the PML coordinate) is</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">  /// parametrised by</span></div><div class="line"><a name="l00541"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a83bac6e18a318693e37b69f658d522e9">  541</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a83bac6e18a318693e37b69f658d522e9">Nu_s_index</a>;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">  /// Value of nu at the minimum value of local coordinate</span></div><div class="line"><a name="l00544"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#ae858cd7ca5348175f26b2d662a607e43">  544</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#ae858cd7ca5348175f26b2d662a607e43">Nu_at_s_min</a>;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">  /// Value of nu at the maximum value of local coordinate</span></div><div class="line"><a name="l00547"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#abeba5fad805f67b4806361f9c2c43d70">  547</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#abeba5fad805f67b4806361f9c2c43d70">Nu_at_s_max</a>;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">  /// Index of local coordinate which theta is parametrised by</span></div><div class="line"><a name="l00550"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#ac4bc071b8e8c384504a4a61113ec2ecd">  550</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#ac4bc071b8e8c384504a4a61113ec2ecd">Theta_s_index</a>;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">  /// Value of theta at the minimum value of local coordinate</span></div><div class="line"><a name="l00553"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a6f88cc81d5f43c10da316bd6b56b3fb1">  553</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a6f88cc81d5f43c10da316bd6b56b3fb1">Theta_at_s_min</a>;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">  /// Value of theta at the maximum value of local coordinate</span></div><div class="line"><a name="l00556"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#ae191ccf4540974d4923b80353955dbf1">  556</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#ae191ccf4540974d4923b80353955dbf1">Theta_at_s_max</a>;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="comment"></span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">  /// \short Value of radius at inner PML boundary</span></div><div class="line"><a name="l00559"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a90aa4d2d40c250c35e0bfbac50c9a9d1">  559</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a90aa4d2d40c250c35e0bfbac50c9a9d1">Pml_inner_radius</a>;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">  /// \short Value of radius at outer PML boundary</span></div><div class="line"><a name="l00562"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a360bd3ab9afbcfd1007a626b780d51d8">  562</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a360bd3ab9afbcfd1007a626b780d51d8">Pml_outer_radius</a>;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="comment">// A uniaxial PML mapping used to transform the radial coordinate</span></div><div class="line"><a name="l00565"></a><span class="lineno"><a class="line" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a51049d96dbdb41fc740bdabd5657b99b">  565</a></span>&#160;  <a class="code" href="classoomph_1_1UniaxialPMLMapping.html">UniaxialPMLMapping</a>* <a class="code" href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a51049d96dbdb41fc740bdabd5657b99b">Pml_mapping_pt</a>;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;};</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00569"></a><span class="lineno"><a class="line" href="classoomph_1_1Conformal2DPMLElement.html">  569</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1Conformal2DPMLElement.html">Conformal2DPMLElement</a> : <span class="keyword">public</span> <a class="code" href="classoomph_1_1PMLElementBase.html">PMLElementBase</a>&lt;2&gt;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;{</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="comment"></span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">  /// Constructor</span></div><div class="line"><a name="l00574"></a><span class="lineno"><a class="line" href="classoomph_1_1Conformal2DPMLElement.html#a6279ae664761a04681287176cc0ae9d4">  574</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1Conformal2DPMLElement.html#a6279ae664761a04681287176cc0ae9d4">Conformal2DPMLElement</a>() :</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    Nu_s_index(0),</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    Nu_at_s_min(0.0),</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    Nu_at_s_max(0.0),</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    Pml_mapping_pt(0)</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  {}</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="comment"></span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">  /// Constructor</span></div><div class="line"><a name="l00582"></a><span class="lineno"><a class="line" href="classoomph_1_1Conformal2DPMLElement.html#a90de10011a8fb7062707d5c028a22d50">  582</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1Conformal2DPMLElement.html#a90de10011a8fb7062707d5c028a22d50">Conformal2DPMLElement</a>(</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> nu_s_index,</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> nu_at_s_min,</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> nu_at_s_max) :</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    Nu_s_index(nu_s_index),</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    Nu_at_s_min(nu_at_s_min),</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    Nu_at_s_max(nu_at_s_max),</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    Pml_mapping_pt(0)</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  {}</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">  ///</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> pml_transformation_jacobian(</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x,</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <a class="code" href="classoomph_1_1DenseComplexMatrix.html">DenseComplexMatrix</a>&amp; jacobian);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">  ///</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> pml_transformation_jacobian(</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; s,</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x,</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <a class="code" href="classoomph_1_1DenseComplexMatrix.html">DenseComplexMatrix</a>&amp; jacobian_matrix,</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector</a>&lt;std::complex&lt;double&gt; &gt;&amp; transformed_x);</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">  /// Enable pml. Set the pointer to a PML mapping function</span></div><div class="line"><a name="l00608"></a><span class="lineno"><a class="line" href="classoomph_1_1Conformal2DPMLElement.html#a8ac82beb6f246e627340df19ecd8c078">  608</a></span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1Conformal2DPMLElement.html#a8ac82beb6f246e627340df19ecd8c078">enable_pml</a>(<a class="code" href="classoomph_1_1UniaxialPMLMapping.html">UniaxialPMLMapping</a>* pml_mapping_pt)</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  {</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <a class="code" href="classoomph_1_1PMLElementBase.html#a4eb9bdef561b94ba2e9b515bad6ccf57">PMLElementBase::enable_pml</a>();</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    pml_mapping_pt = Pml_mapping_pt;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  }</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">  /// Coordinate which goes through the PML in terms of local coordinate</span></div><div class="line"><a name="l00615"></a><span class="lineno"><a class="line" href="classoomph_1_1Conformal2DPMLElement.html#ab11344b74ec10ba88440e04ab95b7426">  615</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1Conformal2DPMLElement.html#ab11344b74ec10ba88440e04ab95b7426">nu</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; s)</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  {</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordflow">return</span> (s[Nu_s_index]-s_min())/(s_max()-s_min())*(Nu_at_s_max-Nu_at_s_min)</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;           + Nu_at_s_min;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  }</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="keywordtype">void</span> assemble_conformal_jacobian(</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; p,</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; dx_inner_dacross,</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; dp_dacross,</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; nu,</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keyword">const</span> std::complex&lt;double&gt;&amp; tnu,</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keyword">const</span> std::complex&lt;double&gt;&amp; dtnu_dnu,</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <a class="code" href="classoomph_1_1DenseComplexMatrix.html">DenseComplexMatrix</a>&amp; mapping_jacobian);</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00632"></a><span class="lineno"><a class="line" href="classoomph_1_1Conformal2DPMLElement.html#ac0fae35f94a70e615a8bbd47716a32d3">  632</a></span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1Conformal2DPMLElement.html#ac0fae35f94a70e615a8bbd47716a32d3">nu_s_index</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Nu_s_index; }</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  </div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00635"></a><span class="lineno"><a class="line" href="classoomph_1_1Conformal2DPMLElement.html#a6692b634a5f689910e4acc42b7244868">  635</a></span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1Conformal2DPMLElement.html#a6692b634a5f689910e4acc42b7244868">across_s_index</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (Nu_s_index+1) % 2; }</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="keyword">protected</span>:</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <span class="comment">// Extract various vectors which characterise the PML and its geometry</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="keywordtype">void</span> get_pml_properties(<span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; s,</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                          <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x_inner,</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                          <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x_outer,</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                          <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; p,</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                          <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; dx_inner_dacross,</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                          <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; dp_dacross,</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                          <span class="keywordtype">double</span>&amp; delta);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">  /// \short Index of local coordinate which nu (through the PML coordinate) is</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">  /// parametrised by</span></div><div class="line"><a name="l00650"></a><span class="lineno"><a class="line" href="classoomph_1_1Conformal2DPMLElement.html#a8c2bbfc42eb94014640a9945b698e107">  650</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1Conformal2DPMLElement.html#a8c2bbfc42eb94014640a9945b698e107">Nu_s_index</a>;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">  /// Value of nu at the minimum value of local coordinate</span></div><div class="line"><a name="l00653"></a><span class="lineno"><a class="line" href="classoomph_1_1Conformal2DPMLElement.html#ad8d7cc7a1c6e6daf1e70f33e86ba6e89">  653</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1Conformal2DPMLElement.html#ad8d7cc7a1c6e6daf1e70f33e86ba6e89">Nu_at_s_min</a>;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">  /// Value of nu at the maximum value of local coordinate</span></div><div class="line"><a name="l00656"></a><span class="lineno"><a class="line" href="classoomph_1_1Conformal2DPMLElement.html#a465f23e8087bb37ff3f61f25c2722735">  656</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1Conformal2DPMLElement.html#a465f23e8087bb37ff3f61f25c2722735">Nu_at_s_max</a>;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  </div><div class="line"><a name="l00658"></a><span class="lineno"><a class="line" href="classoomph_1_1Conformal2DPMLElement.html#a8e9046efb4999dbb5840917a9568aad4">  658</a></span>&#160;  <a class="code" href="classoomph_1_1UniaxialPMLMapping.html">UniaxialPMLMapping</a>* <a class="code" href="classoomph_1_1Conformal2DPMLElement.html#a8e9046efb4999dbb5840917a9568aad4">Pml_mapping_pt</a>;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;};</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno"><a class="line" href="classoomph_1_1TangentiallyVaryingConformal2DPMLElement.html">  661</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1TangentiallyVaryingConformal2DPMLElement.html">TangentiallyVaryingConformal2DPMLElement</a> : <span class="keyword">public</span> <a class="code" href="classoomph_1_1Conformal2DPMLElement.html">Conformal2DPMLElement</a></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;{</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="comment"></span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">  /// Constructor</span></div><div class="line"><a name="l00666"></a><span class="lineno"><a class="line" href="classoomph_1_1TangentiallyVaryingConformal2DPMLElement.html#af5a81c47058e7456508994e6ea86fcf3">  666</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1TangentiallyVaryingConformal2DPMLElement.html#af5a81c47058e7456508994e6ea86fcf3">TangentiallyVaryingConformal2DPMLElement</a>() : <a class="code" href="classoomph_1_1Conformal2DPMLElement.html">Conformal2DPMLElement</a>()</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  {}</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">  /// Constructor</span></div><div class="line"><a name="l00670"></a><span class="lineno"><a class="line" href="classoomph_1_1TangentiallyVaryingConformal2DPMLElement.html#acf3f8264868e48e5b67ed35dc2ab077a">  670</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1TangentiallyVaryingConformal2DPMLElement.html#acf3f8264868e48e5b67ed35dc2ab077a">TangentiallyVaryingConformal2DPMLElement</a>(</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> nu_s_index,</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> nu_at_s_min,</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> nu_at_s_max) :</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <a class="code" href="classoomph_1_1Conformal2DPMLElement.html">Conformal2DPMLElement</a>(nu_s_index, nu_at_s_min, nu_at_s_max)</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  {}</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">  /// Enable pml. Set the pointer to a PML mapping function</span></div><div class="line"><a name="l00678"></a><span class="lineno"><a class="line" href="classoomph_1_1TangentiallyVaryingConformal2DPMLElement.html#ac8b6cad9a9b917809dc3e5e60653bd7b">  678</a></span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1TangentiallyVaryingConformal2DPMLElement.html#ac8b6cad9a9b917809dc3e5e60653bd7b">enable_pml</a>(<a class="code" href="classoomph_1_1TangentiallyVaryingConformalPMLMapping.html">TangentiallyVaryingConformalPMLMapping</a>* pml_mapping_pt)</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  {</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <a class="code" href="classoomph_1_1PMLElementBase.html#a4eb9bdef561b94ba2e9b515bad6ccf57">PMLElementBase&lt;2&gt;::enable_pml</a>();</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    Tangentially_varying_pml_mapping_pt = pml_mapping_pt;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  }</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">  ///</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> pml_transformation_jacobian(</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x,</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <a class="code" href="classoomph_1_1DenseComplexMatrix.html">DenseComplexMatrix</a>&amp; jacobian);</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">  ///</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> pml_transformation_jacobian(</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; s,</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x,</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <a class="code" href="classoomph_1_1DenseComplexMatrix.html">DenseComplexMatrix</a>&amp; jacobian_matrix,</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector</a>&lt;std::complex&lt;double&gt; &gt;&amp; transformed_x);</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <span class="keywordtype">void</span> assemble_conformal_jacobian(</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; p,</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; dx_inner_dacross,</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; dp_dacross,</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; nu,</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keyword">const</span> std::complex&lt;double&gt;&amp; tnu,</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keyword">const</span> std::complex&lt;double&gt;&amp; dtnu_dnu,</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keyword">const</span> std::complex&lt;double&gt;&amp; dtnu_dacross,</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <a class="code" href="classoomph_1_1DenseComplexMatrix.html">DenseComplexMatrix</a>&amp; mapping_jacobian);</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="keyword">protected</span>:</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  </div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <span class="comment">// Extract various vectors which characterise the PML and its geometry</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <span class="keywordtype">void</span> get_pml_properties(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; s_across_the_pml,</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                          <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x_inner,</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                          <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x_outer,</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                          <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; p,</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                          <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; dx_inner_dacross,</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                          <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; dp_dacross,</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                          <span class="keywordtype">double</span>&amp; delta,</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                          <span class="keywordtype">unsigned</span>&amp; across_the_pml_index,</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                          <span class="keywordtype">unsigned</span>&amp; through_the_pml_index);</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;</div><div class="line"><a name="l00723"></a><span class="lineno"><a class="line" href="classoomph_1_1TangentiallyVaryingConformal2DPMLElement.html#a20be46fe19da89f6f2c799509ab38491">  723</a></span>&#160;   <a class="code" href="classoomph_1_1TangentiallyVaryingConformalPMLMapping.html">TangentiallyVaryingConformalPMLMapping</a>* <a class="code" href="classoomph_1_1TangentiallyVaryingConformal2DPMLElement.html#a20be46fe19da89f6f2c799509ab38491">Tangentially_varying_pml_mapping_pt</a>;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;};</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;</div><div class="line"><a name="l00727"></a><span class="lineno"><a class="line" href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html">  727</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html">TangentiallyDiscontinuousConformal2DPMLElement</a> :</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <span class="keyword">public</span> <a class="code" href="classoomph_1_1TangentiallyVaryingConformal2DPMLElement.html">TangentiallyVaryingConformal2DPMLElement</a></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;{</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="comment"></span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment">  /// Constructor</span></div><div class="line"><a name="l00733"></a><span class="lineno"><a class="line" href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a172381a66f0efa02d3827d8c1a50ac80">  733</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a172381a66f0efa02d3827d8c1a50ac80">TangentiallyDiscontinuousConformal2DPMLElement</a>() :</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <a class="code" href="classoomph_1_1TangentiallyVaryingConformal2DPMLElement.html">TangentiallyVaryingConformal2DPMLElement</a>()</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  {}</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment">  /// Constructor</span></div><div class="line"><a name="l00738"></a><span class="lineno"><a class="line" href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a207d8cad6fb66361a2235b2386aab814">  738</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a207d8cad6fb66361a2235b2386aab814">TangentiallyDiscontinuousConformal2DPMLElement</a>(</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> nu_s_index,</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> nu_at_s_min,</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> nu_at_s_max) :</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <a class="code" href="classoomph_1_1TangentiallyVaryingConformal2DPMLElement.html">TangentiallyVaryingConformal2DPMLElement</a>(nu_s_index, nu_at_s_min,</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      nu_at_s_max)</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  {}</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">  /// Enable pml. Set the pointer to a PML mapping function</span></div><div class="line"><a name="l00747"></a><span class="lineno"><a class="line" href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a656d6b337a04f9b889637f0cbbcf209b">  747</a></span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a656d6b337a04f9b889637f0cbbcf209b">enable_pml</a>(<a class="code" href="classoomph_1_1TangentiallyDiscontinuousConformalPMLMapping.html">TangentiallyDiscontinuousConformalPMLMapping</a>* pml_mapping_pt)</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  {</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <a class="code" href="classoomph_1_1PMLElementBase.html#a4eb9bdef561b94ba2e9b515bad6ccf57">PMLElementBase&lt;2&gt;::enable_pml</a>();</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    Tangentially_discontinuous_pml_mapping_pt = pml_mapping_pt;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  }</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">  ///</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> pml_transformation_jacobian(</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; <a class="code" href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a>,</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x,</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <a class="code" href="classoomph_1_1DenseComplexMatrix.html">DenseComplexMatrix</a>&amp; jacobian);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">  ///</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> pml_transformation_jacobian(</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; s,</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x,</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <a class="code" href="classoomph_1_1DenseComplexMatrix.html">DenseComplexMatrix</a>&amp; jacobian_matrix,</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector</a>&lt;std::complex&lt;double&gt; &gt;&amp; transformed_x);</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  <span class="comment">// Use this mode to hijack the assembly process to find rips</span></div><div class="line"><a name="l00769"></a><span class="lineno"><a class="line" href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a3a613124c2aa4fded1f74658dcc523c9">  769</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a3a613124c2aa4fded1f74658dcc523c9">Find_rips_mode</a>;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment">  /// Information about a rip in two dimensions</span></div><div class="line"><a name="l00772"></a><span class="lineno"><a class="line" href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html">  772</a></span>&#160;<span class="comment"></span>  <span class="keyword">struct </span><a class="code" href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html">TwoDimRip</a>{<span class="comment"></span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment">    /// Position of onset of rip in local and global coordinates</span></div><div class="line"><a name="l00774"></a><span class="lineno"><a class="line" href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#a2808306cb7a88c96122af09c76d22f51">  774</a></span>&#160;<span class="comment"></span>    FiniteElementPt <a class="code" href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#a2808306cb7a88c96122af09c76d22f51">ripped_element_pt</a>;</div><div class="line"><a name="l00775"></a><span class="lineno"><a class="line" href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#a2152ee92d801d56663917dfe76f02059">  775</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#a2152ee92d801d56663917dfe76f02059">s_across</a>;</div><div class="line"><a name="l00776"></a><span class="lineno"><a class="line" href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#acccff7acf91921b1366dd808d41266e1">  776</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#acccff7acf91921b1366dd808d41266e1">s_through</a>;</div><div class="line"><a name="l00777"></a><span class="lineno"><a class="line" href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#a745d089012538b48a8f24e7356ea8be0">  777</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#a745d089012538b48a8f24e7356ea8be0">x</a>;</div><div class="line"><a name="l00778"></a><span class="lineno"><a class="line" href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#af2081c6f577dfc1aaa732bb67b14bcca">  778</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#af2081c6f577dfc1aaa732bb67b14bcca">y</a>;</div><div class="line"><a name="l00779"></a><span class="lineno"><a class="line" href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#a3ce793a545c5477771a6f02ccbafd2f6">  779</a></span>&#160;    std::complex&lt;double&gt; <a class="code" href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#a3ce793a545c5477771a6f02ccbafd2f6">tnu</a>;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="comment">// Factor which describes behaviour near rip through the PML</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="comment">// - \frac{partial^2 u}{\partial \tilde\nu^2} / U at rip</span></div><div class="line"><a name="l00782"></a><span class="lineno"><a class="line" href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#afe6c1339363823496527b537316c877d">  782</a></span>&#160;    std::complex&lt;double&gt; <a class="code" href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#afe6c1339363823496527b537316c877d">alpha</a>;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="comment">// Factor which describes behaviour near rip across the PML</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="comment">// - i \frac{partial^2 u}{\partial \tilde\nu^2}</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="comment">//     / (U&#39;(1-\bar\nu) -\frac{\partial u}{\partial \zeta}) at rip</span></div><div class="line"><a name="l00786"></a><span class="lineno"><a class="line" href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#a6dc020a09af5c84b63856302fc94f5dd">  786</a></span>&#160;    std::complex&lt;double&gt; <a class="code" href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#a6dc020a09af5c84b63856302fc94f5dd">beta</a>;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="comment">// Constructor with all parameters</span></div><div class="line"><a name="l00789"></a><span class="lineno"><a class="line" href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#ab238ef0f30bafbf3ed5515ec15f4af9a">  789</a></span>&#160;    <a class="code" href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#ab238ef0f30bafbf3ed5515ec15f4af9a">TwoDimRip</a>(FiniteElementPt Ripped_element_pt, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; S_across,</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; S_through, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; X, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; Y,</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      <span class="keyword">const</span> std::complex&lt;double&gt; Tnu, <span class="keyword">const</span> std::complex&lt;double&gt; Alpha,</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      <span class="keyword">const</span> std::complex&lt;double&gt; Beta):</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      ripped_element_pt(Ripped_element_pt), s_across(S_across),</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      s_through(S_through), x(X), y(Y), tnu(Tnu), alpha(Alpha), beta(Beta)</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    { }</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  };</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="comment">// Holds information about all known rips, which we will use to inform our</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="comment">// integration scheme</span></div><div class="line"><a name="l00800"></a><span class="lineno"><a class="line" href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a07ddc8f71f75a3418fb36917f61d604f">  800</a></span>&#160;  <span class="keyword">static</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;TwoDimRip&gt;</a> <a class="code" href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a07ddc8f71f75a3418fb36917f61d604f">rips</a>;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">  /// Look for rips in the transformation and store in rips vector</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> find_rips();</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment">  /// Compute distance from rip to PML element edge</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span>  distance_from_element_edge( <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x_inner,</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; x_outer, <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; p,</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; r);</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">  /// \short Compute n&#39;J^{-1}, which when applied to the untransformed</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment">  /// grad operator gives us the transformed normal derivative</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> compute_transformed_normal_derivative(</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1DenseComplexMatrix.html">DenseComplexMatrix</a>&amp; J,</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a>&amp; n,</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector</a>&lt;std::complex&lt;double&gt; &gt;&amp; result);</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <span class="comment">// You must overload this to do the normal things in your specific element</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> fill_in_contribution_to_jacobian_no_rips(</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;residuals,</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;jacobian, <span class="keywordtype">bool</span> flag) = 0;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  <span class="comment">// You must overload this and handle the rips in your specific element</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> fill_in_contribution_to_jacobian_with_rips(</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;residuals,</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;jacobian, <span class="keywordtype">bool</span> flag) = 0;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment">  /// Add the element&#39;s contribution to its residual vector (wrapper)</span></div><div class="line"><a name="l00828"></a><span class="lineno"><a class="line" href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a9f5ccd0826199bd3161c5d67c14344b3">  828</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a9f5ccd0826199bd3161c5d67c14344b3">fill_in_contribution_to_residuals</a>(<a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;residuals)</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  {</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="keywordflow">if</span>(this-&gt;Pml_is_enabled &amp;&amp; !Disable_rip_integration)</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    {</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      <span class="comment">// Use this mode to hijack the assembly process to find rips</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      <span class="keywordflow">if</span>(Find_rips_mode)</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      {</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        find_rips();</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      }</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      <span class="comment">//Call the generic residuals function with flag set to 0</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      <span class="comment">//using a dummy matrix argument</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;      fill_in_contribution_to_jacobian_with_rips(residuals,</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        <a class="code" href="classoomph_1_1GeneralisedElement.html#a4bff11b8ff97aefabb2df41e61e1779f">GeneralisedElementTypedef::Dummy_matrix</a>, 0);</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    }</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    {</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      <span class="comment">//Call the generic residuals function with flag set to 0</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <span class="comment">//using a dummy matrix argument</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      fill_in_contribution_to_jacobian_no_rips(</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        residuals, <a class="code" href="classoomph_1_1GeneralisedElement.html#a4bff11b8ff97aefabb2df41e61e1779f">GeneralisedElementTypedef::Dummy_matrix</a>, 0);</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    }</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  }</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment">  /// \short Add the element&#39;s contribution to its residual vector and</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment">  /// element Jacobian matrix (wrapper)</span></div><div class="line"><a name="l00855"></a><span class="lineno"><a class="line" href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a0ed7e453ed779544372498057d197e6a">  855</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a0ed7e453ed779544372498057d197e6a">fill_in_contribution_to_jacobian</a>(</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <a class="code" href="classoomph_1_1Vector.html">Vector&lt;double&gt;</a> &amp;residuals,</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <a class="code" href="classoomph_1_1DenseMatrix.html">DenseMatrix&lt;double&gt;</a> &amp;jacobian)</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  {</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="keywordflow">if</span>(this-&gt;Pml_is_enabled &amp;&amp; !Disable_rip_integration)</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    {</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <span class="comment">// Use this mode to hijack the assembly process to find rips</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      <span class="keywordflow">if</span>(Find_rips_mode)</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      {</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        find_rips();</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      }</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      <span class="comment">// Call the generic routine with the flag set to 1</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      fill_in_contribution_to_jacobian_with_rips(</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        residuals, jacobian, 1);</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    }</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    {</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      <span class="comment">//Call the generic routine with the flag set to 1</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      fill_in_contribution_to_jacobian_no_rips(residuals, jacobian,1);</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    }</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  }</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="keyword">protected</span>:</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <span class="comment">// Pretend that there is a rip at some point in the element to test that it has</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <span class="comment">// no effect. This is overridden by disable rip integration</span></div><div class="line"><a name="l00880"></a><span class="lineno"><a class="line" href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a41eb2a90f1cb709fcdfb9a9ab3e3a101">  880</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a41eb2a90f1cb709fcdfb9a9ab3e3a101">Force_rip_integration</a>;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <span class="comment">// Do not do the integration process which find and treats rips separately</span></div><div class="line"><a name="l00883"></a><span class="lineno"><a class="line" href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a9dea74889c96ed8eb7c494e93afc6093">  883</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a9dea74889c96ed8eb7c494e93afc6093">Disable_rip_integration</a>;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  </div><div class="line"><a name="l00885"></a><span class="lineno"><a class="line" href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a1f0b38329426028a291d84464e24ef44">  885</a></span>&#160;  <a class="code" href="classoomph_1_1TangentiallyDiscontinuousConformalPMLMapping.html">TangentiallyDiscontinuousConformalPMLMapping</a>* <a class="code" href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a1f0b38329426028a291d84464e24ef44">Tangentially_discontinuous_pml_mapping_pt</a>;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;};</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;}</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="classoomph_1_1DiagonalComplexMatrix_html"><div class="ttname"><a href="classoomph_1_1DiagonalComplexMatrix.html">oomph::DiagonalComplexMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="complex__matrices_8h_source.html#l00161">complex_matrices.h:161</a></div></div>
<div class="ttc" id="classoomph_1_1GeneralisedElement_html"><div class="ttname"><a href="classoomph_1_1GeneralisedElement.html">oomph::GeneralisedElement</a></div><div class="ttdoc">A Generalised Element class. </div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l00076">elements.h:76</a></div></div>
<div class="ttc" id="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip_html_a3ce793a545c5477771a6f02ccbafd2f6"><div class="ttname"><a href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#a3ce793a545c5477771a6f02ccbafd2f6">oomph::TangentiallyDiscontinuousConformal2DPMLElement::TwoDimRip::tnu</a></div><div class="ttdeci">std::complex&lt; double &gt; tnu</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00779">pml_elements.h:779</a></div></div>
<div class="ttc" id="classoomph_1_1AxisAlignedPMLElement_html_ae278a54184e8134f57aa361bfc1cc975"><div class="ttname"><a href="classoomph_1_1AxisAlignedPMLElement.html#ae278a54184e8134f57aa361bfc1cc975">oomph::AxisAlignedPMLElement::nu</a></div><div class="ttdeci">void nu(const Vector&lt; double &gt; &amp;x, Vector&lt; double &gt; nu_vec) const</div><div class="ttdoc">Vector which points from the inner boundary to x. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00267">pml_elements.h:267</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromLocalCoordinatePMLElement_html_a83bac6e18a318693e37b69f658d522e9"><div class="ttname"><a href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a83bac6e18a318693e37b69f658d522e9">oomph::AnnularFromLocalCoordinatePMLElement::Nu_s_index</a></div><div class="ttdeci">unsigned Nu_s_index</div><div class="ttdoc">Index of local coordinate which nu (through the PML coordinate) is parametrised by. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00541">pml_elements.h:541</a></div></div>
<div class="ttc" id="classoomph_1_1AxisAlignedPMLElement_html_a37d292c06ab74db30dcb6e8f7cea4033"><div class="ttname"><a href="classoomph_1_1AxisAlignedPMLElement.html#a37d292c06ab74db30dcb6e8f7cea4033">oomph::AxisAlignedPMLElement::delta</a></div><div class="ttdeci">void delta(const Vector&lt; double &gt; &amp;x, Vector&lt; double &gt; delta) const</div><div class="ttdoc">Vector which points from the inner boundary to x. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00282">pml_elements.h:282</a></div></div>
<div class="ttc" id="complex__matrices_8h_html"><div class="ttname"><a href="complex__matrices_8h.html">complex_matrices.h</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromLocalCoordinatePMLElement_html_a6f88cc81d5f43c10da316bd6b56b3fb1"><div class="ttname"><a href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a6f88cc81d5f43c10da316bd6b56b3fb1">oomph::AnnularFromLocalCoordinatePMLElement::Theta_at_s_min</a></div><div class="ttdeci">double Theta_at_s_min</div><div class="ttdoc">Value of theta at the minimum value of local coordinate. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00553">pml_elements.h:553</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromLocalCoordinatePMLElement_html_a90aa4d2d40c250c35e0bfbac50c9a9d1"><div class="ttname"><a href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a90aa4d2d40c250c35e0bfbac50c9a9d1">oomph::AnnularFromLocalCoordinatePMLElement::Pml_inner_radius</a></div><div class="ttdeci">double Pml_inner_radius</div><div class="ttdoc">Value of radius at inner PML boundary. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00559">pml_elements.h:559</a></div></div>
<div class="ttc" id="classoomph_1_1Conformal2DPMLElement_html"><div class="ttname"><a href="classoomph_1_1Conformal2DPMLElement.html">oomph::Conformal2DPMLElement</a></div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00569">pml_elements.h:569</a></div></div>
<div class="ttc" id="namespaceoomph_html_a3a774afab5900fed47e092a013f9efb8"><div class="ttname"><a href="namespaceoomph.html#a3a774afab5900fed47e092a013f9efb8">oomph::FiniteElementPt</a></div><div class="ttdeci">FiniteElement * FiniteElementPt</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00048">pml_elements.h:48</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromLocalCoordinatePMLElement_html_ab44027b0ebf468154752cc09d46d3a5d"><div class="ttname"><a href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#ab44027b0ebf468154752cc09d46d3a5d">oomph::AnnularFromLocalCoordinatePMLElement::radial_transformation_jacobian</a></div><div class="ttdeci">virtual void radial_transformation_jacobian(const double &amp;nu, const double &amp;delta, std::complex&lt; double &gt; &amp;transformed_r, std::complex&lt; double &gt; &amp;dtransformed_r_dr)</div><div class="ttdoc">get the Jacobian of the mapping from transformed r to the radial through-the-pml coordinate. Also returns the transformed_r at this point too as it is required for the transformation to cartesian coordinates </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00525">pml_elements.h:525</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromCartesianPMLElement_html_a2dd7b0074775618fcb2e1072fd81d10a"><div class="ttname"><a href="classoomph_1_1AnnularFromCartesianPMLElement.html#a2dd7b0074775618fcb2e1072fd81d10a">oomph::AnnularFromCartesianPMLElement::Pml_outer_radius</a></div><div class="ttdeci">double Pml_outer_radius</div><div class="ttdoc">Coordinate of inner pml boundary (Storage is provided for any coordinate direction; only the entries ...</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00445">pml_elements.h:445</a></div></div>
<div class="ttc" id="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip_html_ab238ef0f30bafbf3ed5515ec15f4af9a"><div class="ttname"><a href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#ab238ef0f30bafbf3ed5515ec15f4af9a">oomph::TangentiallyDiscontinuousConformal2DPMLElement::TwoDimRip::TwoDimRip</a></div><div class="ttdeci">TwoDimRip(FiniteElementPt Ripped_element_pt, const double &amp;S_across, const double &amp;S_through, const double &amp;X, const double &amp;Y, const std::complex&lt; double &gt; Tnu, const std::complex&lt; double &gt; Alpha, const std::complex&lt; double &gt; Beta)</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00789">pml_elements.h:789</a></div></div>
<div class="ttc" id="classoomph_1_1Conformal2DPMLElement_html_ad8d7cc7a1c6e6daf1e70f33e86ba6e89"><div class="ttname"><a href="classoomph_1_1Conformal2DPMLElement.html#ad8d7cc7a1c6e6daf1e70f33e86ba6e89">oomph::Conformal2DPMLElement::Nu_at_s_min</a></div><div class="ttdeci">double Nu_at_s_min</div><div class="ttdoc">Value of nu at the minimum value of local coordinate. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00653">pml_elements.h:653</a></div></div>
<div class="ttc" id="classoomph_1_1EquivalentQElement_html"><div class="ttname"><a href="classoomph_1_1EquivalentQElement.html">oomph::EquivalentQElement</a></div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00057">pml_elements.h:57</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromLocalCoordinatePMLElement_html_a3e7cb53dd208524cb5378d1ec2ee1e89"><div class="ttname"><a href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a3e7cb53dd208524cb5378d1ec2ee1e89">oomph::AnnularFromLocalCoordinatePMLElement::AnnularFromLocalCoordinatePMLElement</a></div><div class="ttdeci">AnnularFromLocalCoordinatePMLElement()</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00462">pml_elements.h:462</a></div></div>
<div class="ttc" id="classoomph_1_1AxisAlignedPMLElement_html_a9fba3c6d10af49f64833ecfe97b730c5"><div class="ttname"><a href="classoomph_1_1AxisAlignedPMLElement.html#a9fba3c6d10af49f64833ecfe97b730c5">oomph::AxisAlignedPMLElement::pml_transformation_jacobian</a></div><div class="ttdeci">virtual void pml_transformation_jacobian(const unsigned &amp;ipt, const Vector&lt; double &gt; &amp;s, const Vector&lt; double &gt; &amp;x, DenseComplexMatrix &amp;jacobian)</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00178">pml_elements.h:178</a></div></div>
<div class="ttc" id="classoomph_1_1AxisAlignedPMLElement_html_abb5b63cb5d08885239627640a74dd9d9"><div class="ttname"><a href="classoomph_1_1AxisAlignedPMLElement.html#abb5b63cb5d08885239627640a74dd9d9">oomph::AxisAlignedPMLElement::Pml_mapping_pt</a></div><div class="ttdeci">UniaxialPMLMapping * Pml_mapping_pt</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00307">pml_elements.h:307</a></div></div>
<div class="ttc" id="cfortran_8h_html_adb50e893b86b3e55e751a42eab3cba82"><div class="ttname"><a href="cfortran_8h.html#adb50e893b86b3e55e751a42eab3cba82">i</a></div><div class="ttdeci">cstr elem_len * i</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00607">cfortran.h:607</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromCartesianPMLElement_html_acb66a5412d96aef573a498ffc8f7a72d"><div class="ttname"><a href="classoomph_1_1AnnularFromCartesianPMLElement.html#acb66a5412d96aef573a498ffc8f7a72d">oomph::AnnularFromCartesianPMLElement::radius</a></div><div class="ttdeci">double radius(const Vector&lt; double &gt; &amp;s, const Vector&lt; double &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00394">pml_elements.h:394</a></div></div>
<div class="ttc" id="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_html_a172381a66f0efa02d3827d8c1a50ac80"><div class="ttname"><a href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a172381a66f0efa02d3827d8c1a50ac80">oomph::TangentiallyDiscontinuousConformal2DPMLElement::TangentiallyDiscontinuousConformal2DPMLElement</a></div><div class="ttdeci">TangentiallyDiscontinuousConformal2DPMLElement()</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00733">pml_elements.h:733</a></div></div>
<div class="ttc" id="classoomph_1_1PMLElementBase_html_a751943790221819c111da99455275bbc"><div class="ttname"><a href="classoomph_1_1PMLElementBase.html#a751943790221819c111da99455275bbc">oomph::PMLElementBase::disable_pml</a></div><div class="ttdeci">virtual void disable_pml()</div><div class="ttdoc">Disable pml. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00077">pml_elements.h:77</a></div></div>
<div class="ttc" id="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_html_a07ddc8f71f75a3418fb36917f61d604f"><div class="ttname"><a href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a07ddc8f71f75a3418fb36917f61d604f">oomph::TangentiallyDiscontinuousConformal2DPMLElement::rips</a></div><div class="ttdeci">static Vector&lt; TwoDimRip &gt; rips</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00800">pml_elements.h:800</a></div></div>
<div class="ttc" id="classoomph_1_1UniaxialPMLMapping_html"><div class="ttname"><a href="classoomph_1_1UniaxialPMLMapping.html">oomph::UniaxialPMLMapping</a></div><div class="ttdef"><b>Definition:</b> <a href="pml__mapping__functions_8h_source.html#l00049">pml_mapping_functions.h:49</a></div></div>
<div class="ttc" id="classoomph_1_1FiniteElement_html"><div class="ttname"><a href="classoomph_1_1FiniteElement.html">oomph::FiniteElement</a></div><div class="ttdoc">A general Finite Element class. </div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l01274">elements.h:1274</a></div></div>
<div class="ttc" id="classoomph_1_1OomphLibError_html"><div class="ttname"><a href="classoomph_1_1OomphLibError.html">oomph::OomphLibError</a></div><div class="ttdef"><b>Definition:</b> <a href="oomph__definitions_8h_source.html#l00225">oomph_definitions.h:225</a></div></div>
<div class="ttc" id="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip_html_a6dc020a09af5c84b63856302fc94f5dd"><div class="ttname"><a href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#a6dc020a09af5c84b63856302fc94f5dd">oomph::TangentiallyDiscontinuousConformal2DPMLElement::TwoDimRip::beta</a></div><div class="ttdeci">std::complex&lt; double &gt; beta</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00786">pml_elements.h:786</a></div></div>
<div class="ttc" id="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip_html_a745d089012538b48a8f24e7356ea8be0"><div class="ttname"><a href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#a745d089012538b48a8f24e7356ea8be0">oomph::TangentiallyDiscontinuousConformal2DPMLElement::TwoDimRip::x</a></div><div class="ttdeci">double x</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00777">pml_elements.h:777</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromLocalCoordinatePMLElement_html_ae858cd7ca5348175f26b2d662a607e43"><div class="ttname"><a href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#ae858cd7ca5348175f26b2d662a607e43">oomph::AnnularFromLocalCoordinatePMLElement::Nu_at_s_min</a></div><div class="ttdeci">double Nu_at_s_min</div><div class="ttdoc">Value of nu at the minimum value of local coordinate. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00544">pml_elements.h:544</a></div></div>
<div class="ttc" id="elements_8h_html"><div class="ttname"><a href="elements_8h.html">elements.h</a></div></div>
<div class="ttc" id="classoomph_1_1AxisAlignedPMLElement_html_af5689e98392072da121eafa0b438e44c"><div class="ttname"><a href="classoomph_1_1AxisAlignedPMLElement.html#af5689e98392072da121eafa0b438e44c">oomph::AxisAlignedPMLElement::delta</a></div><div class="ttdeci">double delta(const unsigned &amp;i) const</div><div class="ttdoc">Vector which points from the inner boundary to x. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00276">pml_elements.h:276</a></div></div>
<div class="ttc" id="classoomph_1_1Conformal2DPMLElement_html_a465f23e8087bb37ff3f61f25c2722735"><div class="ttname"><a href="classoomph_1_1Conformal2DPMLElement.html#a465f23e8087bb37ff3f61f25c2722735">oomph::Conformal2DPMLElement::Nu_at_s_max</a></div><div class="ttdeci">double Nu_at_s_max</div><div class="ttdoc">Value of nu at the maximum value of local coordinate. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00656">pml_elements.h:656</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromCartesianPMLElement_html_acac12e9f2f6df3e9edebb7747ce4fab8"><div class="ttname"><a href="classoomph_1_1AnnularFromCartesianPMLElement.html#acac12e9f2f6df3e9edebb7747ce4fab8">oomph::AnnularFromCartesianPMLElement::nu</a></div><div class="ttdeci">double nu(const Vector&lt; double &gt; &amp;s, const Vector&lt; double &gt; &amp;x)</div><div class="ttdoc">Coordinate which goes through the PML. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00400">pml_elements.h:400</a></div></div>
<div class="ttc" id="classoomph_1_1AxisAlignedPMLElement_html_adecf1b401aeab5399ce576c19667e455"><div class="ttname"><a href="classoomph_1_1AxisAlignedPMLElement.html#adecf1b401aeab5399ce576c19667e455">oomph::AxisAlignedPMLElement::Pml_inner_boundary</a></div><div class="ttdeci">Vector&lt; double &gt; Pml_inner_boundary</div><div class="ttdoc">Coordinate of inner pml boundary (Storage is provided for any coordinate direction; only the entries ...</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00300">pml_elements.h:300</a></div></div>
<div class="ttc" id="classoomph_1_1TangentiallyVaryingConformal2DPMLElement_html_ac8b6cad9a9b917809dc3e5e60653bd7b"><div class="ttname"><a href="classoomph_1_1TangentiallyVaryingConformal2DPMLElement.html#ac8b6cad9a9b917809dc3e5e60653bd7b">oomph::TangentiallyVaryingConformal2DPMLElement::enable_pml</a></div><div class="ttdeci">virtual void enable_pml(TangentiallyVaryingConformalPMLMapping *pml_mapping_pt)</div><div class="ttdoc">Enable pml. Set the pointer to a PML mapping function. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00678">pml_elements.h:678</a></div></div>
<div class="ttc" id="classoomph_1_1TangentiallyVaryingConformal2DPMLElement_html"><div class="ttname"><a href="classoomph_1_1TangentiallyVaryingConformal2DPMLElement.html">oomph::TangentiallyVaryingConformal2DPMLElement</a></div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00661">pml_elements.h:661</a></div></div>
<div class="ttc" id="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_html_a1f0b38329426028a291d84464e24ef44"><div class="ttname"><a href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a1f0b38329426028a291d84464e24ef44">oomph::TangentiallyDiscontinuousConformal2DPMLElement::Tangentially_discontinuous_pml_mapping_pt</a></div><div class="ttdeci">TangentiallyDiscontinuousConformalPMLMapping * Tangentially_discontinuous_pml_mapping_pt</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00885">pml_elements.h:885</a></div></div>
<div class="ttc" id="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_html_a9f5ccd0826199bd3161c5d67c14344b3"><div class="ttname"><a href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a9f5ccd0826199bd3161c5d67c14344b3">oomph::TangentiallyDiscontinuousConformal2DPMLElement::fill_in_contribution_to_residuals</a></div><div class="ttdeci">void fill_in_contribution_to_residuals(Vector&lt; double &gt; &amp;residuals)</div><div class="ttdoc">Add the element&amp;#39;s contribution to its residual vector (wrapper) </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00828">pml_elements.h:828</a></div></div>
<div class="ttc" id="classoomph_1_1AxisAlignedPMLElement_html_adcb4bb14ff2f185cdfd31aa51b1f015d"><div class="ttname"><a href="classoomph_1_1AxisAlignedPMLElement.html#adcb4bb14ff2f185cdfd31aa51b1f015d">oomph::AxisAlignedPMLElement::pml_mapping_pt</a></div><div class="ttdeci">UniaxialPMLMapping *&amp; pml_mapping_pt()</div><div class="ttdoc">Return a pointer to the PML Mapping object. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00255">pml_elements.h:255</a></div></div>
<div class="ttc" id="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip_html"><div class="ttname"><a href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html">oomph::TangentiallyDiscontinuousConformal2DPMLElement::TwoDimRip</a></div><div class="ttdoc">Information about a rip in two dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00772">pml_elements.h:772</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromLocalCoordinatePMLElement_html_a161e427b6f1fc6349b9667caf346cf8a"><div class="ttname"><a href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a161e427b6f1fc6349b9667caf346cf8a">oomph::AnnularFromLocalCoordinatePMLElement::nu</a></div><div class="ttdeci">double nu(const Vector&lt; double &gt; &amp;s, const Vector&lt; double &gt; &amp;x)</div><div class="ttdoc">Coordinate which goes through the PML in terms of local coordinate. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00505">pml_elements.h:505</a></div></div>
<div class="ttc" id="classoomph_1_1AxisAlignedPMLElement_html_a157cd9d30c5d1f86d17b4b25bc705f76"><div class="ttname"><a href="classoomph_1_1AxisAlignedPMLElement.html#a157cd9d30c5d1f86d17b4b25bc705f76">oomph::AxisAlignedPMLElement::enable_pml</a></div><div class="ttdeci">virtual void enable_pml(const int &amp;direction, const double &amp;pml_inner_boundary, const double &amp;pml_outer_boundary, UniaxialPMLMapping *pml_mapping_pt)</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00245">pml_elements.h:245</a></div></div>
<div class="ttc" id="namespaceoomph_html"><div class="ttname"><a href="namespaceoomph.html">oomph</a></div><div class="ttdef"><b>Definition:</b> <a href="advection__diffusion__elements_8cc_source.html#l00033">advection_diffusion_elements.cc:33</a></div></div>
<div class="ttc" id="classoomph_1_1Conformal2DPMLElement_html_a6279ae664761a04681287176cc0ae9d4"><div class="ttname"><a href="classoomph_1_1Conformal2DPMLElement.html#a6279ae664761a04681287176cc0ae9d4">oomph::Conformal2DPMLElement::Conformal2DPMLElement</a></div><div class="ttdeci">Conformal2DPMLElement()</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00574">pml_elements.h:574</a></div></div>
<div class="ttc" id="classoomph_1_1Vector_html"><div class="ttname"><a href="classoomph_1_1Vector.html">oomph::Vector&lt; double &gt;</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromCartesianPMLElement_html_aae716d46c00db3cec8b6cf2816440f55"><div class="ttname"><a href="classoomph_1_1AnnularFromCartesianPMLElement.html#aae716d46c00db3cec8b6cf2816440f55">oomph::AnnularFromCartesianPMLElement::Pml_mapping_pt</a></div><div class="ttdeci">UniaxialPMLMapping * Pml_mapping_pt</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00453">pml_elements.h:453</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromCartesianPMLElement_html_a7c681a8ec4f83f5e9989a8d2fee4de91"><div class="ttname"><a href="classoomph_1_1AnnularFromCartesianPMLElement.html#a7c681a8ec4f83f5e9989a8d2fee4de91">oomph::AnnularFromCartesianPMLElement::theta</a></div><div class="ttdeci">double theta(const Vector&lt; double &gt; &amp;x)</div><div class="ttdoc">Angle relative to origin. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00415">pml_elements.h:415</a></div></div>
<div class="ttc" id="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip_html_af2081c6f577dfc1aaa732bb67b14bcca"><div class="ttname"><a href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#af2081c6f577dfc1aaa732bb67b14bcca">oomph::TangentiallyDiscontinuousConformal2DPMLElement::TwoDimRip::y</a></div><div class="ttdeci">double y</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00778">pml_elements.h:778</a></div></div>
<div class="ttc" id="classoomph_1_1PMLElementBase_html"><div class="ttname"><a href="classoomph_1_1PMLElementBase.html">oomph::PMLElementBase</a></div><div class="ttdoc">Base class for elements with pml capabilities. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00065">pml_elements.h:65</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromLocalCoordinatePMLElement_html_affe7de11a2275aac57b0ea2c0594ce7d"><div class="ttname"><a href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#affe7de11a2275aac57b0ea2c0594ce7d">oomph::AnnularFromLocalCoordinatePMLElement::delta</a></div><div class="ttdeci">double delta()</div><div class="ttdoc">Thickness of PML. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00512">pml_elements.h:512</a></div></div>
<div class="ttc" id="classoomph_1_1AxisAlignedPMLElement_html_acb3d0ce377bf928f0fa83deedef775f0"><div class="ttname"><a href="classoomph_1_1AxisAlignedPMLElement.html#acb3d0ce377bf928f0fa83deedef775f0">oomph::AxisAlignedPMLElement::AxisAlignedPMLElement</a></div><div class="ttdeci">AxisAlignedPMLElement()</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00165">pml_elements.h:165</a></div></div>
<div class="ttc" id="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_html_a656d6b337a04f9b889637f0cbbcf209b"><div class="ttname"><a href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a656d6b337a04f9b889637f0cbbcf209b">oomph::TangentiallyDiscontinuousConformal2DPMLElement::enable_pml</a></div><div class="ttdeci">virtual void enable_pml(TangentiallyDiscontinuousConformalPMLMapping *pml_mapping_pt)</div><div class="ttdoc">Enable pml. Set the pointer to a PML mapping function. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00747">pml_elements.h:747</a></div></div>
<div class="ttc" id="cfortran_8h_html_ab7123126e4885ef647dd9c6e3807a21c"><div class="ttname"><a href="cfortran_8h.html#ab7123126e4885ef647dd9c6e3807a21c">s</a></div><div class="ttdeci">static char t char * s</div><div class="ttdef"><b>Definition:</b> <a href="cfortran_8h_source.html#l00572">cfortran.h:572</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromLocalCoordinatePMLElement_html_ac4bc071b8e8c384504a4a61113ec2ecd"><div class="ttname"><a href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#ac4bc071b8e8c384504a4a61113ec2ecd">oomph::AnnularFromLocalCoordinatePMLElement::Theta_s_index</a></div><div class="ttdeci">unsigned Theta_s_index</div><div class="ttdoc">Index of local coordinate which theta is parametrised by. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00550">pml_elements.h:550</a></div></div>
<div class="ttc" id="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_html_a0ed7e453ed779544372498057d197e6a"><div class="ttname"><a href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a0ed7e453ed779544372498057d197e6a">oomph::TangentiallyDiscontinuousConformal2DPMLElement::fill_in_contribution_to_jacobian</a></div><div class="ttdeci">void fill_in_contribution_to_jacobian(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian)</div><div class="ttdoc">Add the element&amp;#39;s contribution to its residual vector and element Jacobian matrix (wrapper) ...</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00855">pml_elements.h:855</a></div></div>
<div class="ttc" id="classoomph_1_1Conformal2DPMLElement_html_ab11344b74ec10ba88440e04ab95b7426"><div class="ttname"><a href="classoomph_1_1Conformal2DPMLElement.html#ab11344b74ec10ba88440e04ab95b7426">oomph::Conformal2DPMLElement::nu</a></div><div class="ttdeci">double nu(const Vector&lt; double &gt; &amp;s)</div><div class="ttdoc">Coordinate which goes through the PML in terms of local coordinate. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00615">pml_elements.h:615</a></div></div>
<div class="ttc" id="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_html"><div class="ttname"><a href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html">oomph::TangentiallyDiscontinuousConformal2DPMLElement</a></div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00727">pml_elements.h:727</a></div></div>
<div class="ttc" id="classoomph_1_1PMLElementBase_html_a0b0e980998764978801a1f0463a31989"><div class="ttname"><a href="classoomph_1_1PMLElementBase.html#a0b0e980998764978801a1f0463a31989">oomph::PMLElementBase::Pml_is_enabled</a></div><div class="ttdeci">bool Pml_is_enabled</div><div class="ttdoc">Boolean indicating if element is used in pml mode. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00153">pml_elements.h:153</a></div></div>
<div class="ttc" id="classoomph_1_1Conformal2DPMLElement_html_a6692b634a5f689910e4acc42b7244868"><div class="ttname"><a href="classoomph_1_1Conformal2DPMLElement.html#a6692b634a5f689910e4acc42b7244868">oomph::Conformal2DPMLElement::across_s_index</a></div><div class="ttdeci">unsigned across_s_index() const</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00635">pml_elements.h:635</a></div></div>
<div class="ttc" id="classoomph_1_1Conformal2DPMLElement_html_ac0fae35f94a70e615a8bbd47716a32d3"><div class="ttname"><a href="classoomph_1_1Conformal2DPMLElement.html#ac0fae35f94a70e615a8bbd47716a32d3">oomph::Conformal2DPMLElement::nu_s_index</a></div><div class="ttdeci">unsigned nu_s_index() const</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00632">pml_elements.h:632</a></div></div>
<div class="ttc" id="classoomph_1_1Conformal2DPMLElement_html_a90de10011a8fb7062707d5c028a22d50"><div class="ttname"><a href="classoomph_1_1Conformal2DPMLElement.html#a90de10011a8fb7062707d5c028a22d50">oomph::Conformal2DPMLElement::Conformal2DPMLElement</a></div><div class="ttdeci">Conformal2DPMLElement(const unsigned nu_s_index, const double nu_at_s_min, const double nu_at_s_max)</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00582">pml_elements.h:582</a></div></div>
<div class="ttc" id="namespaceoomph_html_a14fee011765f6f5c9d1923650cf4018e"><div class="ttname"><a href="namespaceoomph.html#a14fee011765f6f5c9d1923650cf4018e">oomph::GeneralisedElementTypedef</a></div><div class="ttdeci">GeneralisedElement GeneralisedElementTypedef</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00049">pml_elements.h:49</a></div></div>
<div class="ttc" id="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip_html_acccff7acf91921b1366dd808d41266e1"><div class="ttname"><a href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#acccff7acf91921b1366dd808d41266e1">oomph::TangentiallyDiscontinuousConformal2DPMLElement::TwoDimRip::s_through</a></div><div class="ttdeci">double s_through</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00776">pml_elements.h:776</a></div></div>
<div class="ttc" id="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip_html_a2152ee92d801d56663917dfe76f02059"><div class="ttname"><a href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#a2152ee92d801d56663917dfe76f02059">oomph::TangentiallyDiscontinuousConformal2DPMLElement::TwoDimRip::s_across</a></div><div class="ttdeci">double s_across</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00775">pml_elements.h:775</a></div></div>
<div class="ttc" id="classoomph_1_1PMLElementBase_html_a2a9399aa63600f5276e865dde49f164a"><div class="ttname"><a href="classoomph_1_1PMLElementBase.html#a2a9399aa63600f5276e865dde49f164a">oomph::PMLElementBase::~PMLElementBase</a></div><div class="ttdeci">virtual ~PMLElementBase()</div><div class="ttdoc">Virtual destructor. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00074">pml_elements.h:74</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromLocalCoordinatePMLElement_html_a32ef4115b2cce33d4ec93a5620807685"><div class="ttname"><a href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a32ef4115b2cce33d4ec93a5620807685">oomph::AnnularFromLocalCoordinatePMLElement::AnnularFromLocalCoordinatePMLElement</a></div><div class="ttdeci">AnnularFromLocalCoordinatePMLElement(unsigned nu_s_index, double nu_at_s_min, double nu_at_s_max, unsigned theta_s_index, double theta_at_s_min, double theta_at_s_max, double pml_inner_radius, double pml_outer_radius)</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00474">pml_elements.h:474</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromCartesianPMLElement_html_a4095e343d2a36dac4e1d5f69402a4ff3"><div class="ttname"><a href="classoomph_1_1AnnularFromCartesianPMLElement.html#a4095e343d2a36dac4e1d5f69402a4ff3">oomph::AnnularFromCartesianPMLElement::radial_transformation_jacobian</a></div><div class="ttdeci">virtual void radial_transformation_jacobian(const double &amp;nu, const double &amp;delta, std::complex&lt; double &gt; &amp;transformed_r, std::complex&lt; double &gt; &amp;dtransformed_r_dr)</div><div class="ttdoc">get the Jacobian of the mapping from transformed r to the radial through-the-pml coordinate. Also returns the transformed_r at this point too as it is required for the transformation to cartesian coordinates </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00423">pml_elements.h:423</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromLocalCoordinatePMLElement_html_abeba5fad805f67b4806361f9c2c43d70"><div class="ttname"><a href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#abeba5fad805f67b4806361f9c2c43d70">oomph::AnnularFromLocalCoordinatePMLElement::Nu_at_s_max</a></div><div class="ttdeci">double Nu_at_s_max</div><div class="ttdoc">Value of nu at the maximum value of local coordinate. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00547">pml_elements.h:547</a></div></div>
<div class="ttc" id="classoomph_1_1AxisAlignedPMLElement_html_a6cc25fecc2e0f0b8a4920aae2e64964a"><div class="ttname"><a href="classoomph_1_1AxisAlignedPMLElement.html#a6cc25fecc2e0f0b8a4920aae2e64964a">oomph::AxisAlignedPMLElement::Pml_direction_active</a></div><div class="ttdeci">std::vector&lt; bool &gt; Pml_direction_active</div><div class="ttdoc">Coordinate direction along which pml boundary is constant; alternatively: coordinate direction in whi...</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00295">pml_elements.h:295</a></div></div>
<div class="ttc" id="classoomph_1_1PMLElementBase_html_a4eb9bdef561b94ba2e9b515bad6ccf57"><div class="ttname"><a href="classoomph_1_1PMLElementBase.html#a4eb9bdef561b94ba2e9b515bad6ccf57">oomph::PMLElementBase::enable_pml</a></div><div class="ttdeci">virtual void enable_pml()</div><div class="ttdoc">Enable pml. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00083">pml_elements.h:83</a></div></div>
<div class="ttc" id="classoomph_1_1AxisAlignedPMLElement_html_ab67dd8501cbdeb896ff34d3cd8645434"><div class="ttname"><a href="classoomph_1_1AxisAlignedPMLElement.html#ab67dd8501cbdeb896ff34d3cd8645434">oomph::AxisAlignedPMLElement::pml_mapping_pt</a></div><div class="ttdeci">UniaxialPMLMapping *const  &amp; pml_mapping_pt() const</div><div class="ttdoc">Return a pointer to the PML Mapping object (const version) </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00258">pml_elements.h:258</a></div></div>
<div class="ttc" id="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_html_a207d8cad6fb66361a2235b2386aab814"><div class="ttname"><a href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a207d8cad6fb66361a2235b2386aab814">oomph::TangentiallyDiscontinuousConformal2DPMLElement::TangentiallyDiscontinuousConformal2DPMLElement</a></div><div class="ttdeci">TangentiallyDiscontinuousConformal2DPMLElement(const unsigned nu_s_index, const double nu_at_s_min, const double nu_at_s_max)</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00738">pml_elements.h:738</a></div></div>
<div class="ttc" id="classoomph_1_1TangentiallyVaryingConformal2DPMLElement_html_af5a81c47058e7456508994e6ea86fcf3"><div class="ttname"><a href="classoomph_1_1TangentiallyVaryingConformal2DPMLElement.html#af5a81c47058e7456508994e6ea86fcf3">oomph::TangentiallyVaryingConformal2DPMLElement::TangentiallyVaryingConformal2DPMLElement</a></div><div class="ttdeci">TangentiallyVaryingConformal2DPMLElement()</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00666">pml_elements.h:666</a></div></div>
<div class="ttc" id="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_html_a9dea74889c96ed8eb7c494e93afc6093"><div class="ttname"><a href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a9dea74889c96ed8eb7c494e93afc6093">oomph::TangentiallyDiscontinuousConformal2DPMLElement::Disable_rip_integration</a></div><div class="ttdeci">bool Disable_rip_integration</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00883">pml_elements.h:883</a></div></div>
<div class="ttc" id="classoomph_1_1AxisAlignedPMLElement_html_a554c5768cdf2543b76a507dacd7fe54b"><div class="ttname"><a href="classoomph_1_1AxisAlignedPMLElement.html#a554c5768cdf2543b76a507dacd7fe54b">oomph::AxisAlignedPMLElement::nu</a></div><div class="ttdeci">double nu(const Vector&lt; double &gt; &amp;x, const unsigned &amp;i) const</div><div class="ttdoc">Vector which points from the inner boundary to x. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00261">pml_elements.h:261</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromCartesianPMLElement_html_a9cf84a8abb2f74bf71b6dbf4cc3958f1"><div class="ttname"><a href="classoomph_1_1AnnularFromCartesianPMLElement.html#a9cf84a8abb2f74bf71b6dbf4cc3958f1">oomph::AnnularFromCartesianPMLElement::delta</a></div><div class="ttdeci">double delta()</div><div class="ttdoc">Thickness of PML. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00412">pml_elements.h:412</a></div></div>
<div class="ttc" id="classoomph_1_1TangentiallyVaryingConformal2DPMLElement_html_acf3f8264868e48e5b67ed35dc2ab077a"><div class="ttname"><a href="classoomph_1_1TangentiallyVaryingConformal2DPMLElement.html#acf3f8264868e48e5b67ed35dc2ab077a">oomph::TangentiallyVaryingConformal2DPMLElement::TangentiallyVaryingConformal2DPMLElement</a></div><div class="ttdeci">TangentiallyVaryingConformal2DPMLElement(const unsigned nu_s_index, const double nu_at_s_min, const double nu_at_s_max)</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00670">pml_elements.h:670</a></div></div>
<div class="ttc" id="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_html_a3a613124c2aa4fded1f74658dcc523c9"><div class="ttname"><a href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a3a613124c2aa4fded1f74658dcc523c9">oomph::TangentiallyDiscontinuousConformal2DPMLElement::Find_rips_mode</a></div><div class="ttdeci">static bool Find_rips_mode</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00769">pml_elements.h:769</a></div></div>
<div class="ttc" id="pml__mapping__functions_8h_html"><div class="ttname"><a href="pml__mapping__functions_8h.html">pml_mapping_functions.h</a></div></div>
<div class="ttc" id="classoomph_1_1Conformal2DPMLElement_html_a8ac82beb6f246e627340df19ecd8c078"><div class="ttname"><a href="classoomph_1_1Conformal2DPMLElement.html#a8ac82beb6f246e627340df19ecd8c078">oomph::Conformal2DPMLElement::enable_pml</a></div><div class="ttdeci">virtual void enable_pml(UniaxialPMLMapping *pml_mapping_pt)</div><div class="ttdoc">Enable pml. Set the pointer to a PML mapping function. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00608">pml_elements.h:608</a></div></div>
<div class="ttc" id="classoomph_1_1AxisAlignedPMLElement_html_aff04e9e225d24b9ce877204b7ae22921"><div class="ttname"><a href="classoomph_1_1AxisAlignedPMLElement.html#aff04e9e225d24b9ce877204b7ae22921">oomph::AxisAlignedPMLElement::Pml_outer_boundary</a></div><div class="ttdeci">Vector&lt; double &gt; Pml_outer_boundary</div><div class="ttdoc">Coordinate of outer pml boundary (Storage is provided for any coordinate direction; only the entries ...</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00305">pml_elements.h:305</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromCartesianPMLElement_html_a28f1b489affa8a37c0c0973cf9324157"><div class="ttname"><a href="classoomph_1_1AnnularFromCartesianPMLElement.html#a28f1b489affa8a37c0c0973cf9324157">oomph::AnnularFromCartesianPMLElement::nu</a></div><div class="ttdeci">double nu(const double &amp;r)</div><div class="ttdoc">Coordinate which goes through the PML. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00406">pml_elements.h:406</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromCartesianPMLElement_html_ad5ac4bafd6684b1cff949e74493aff83"><div class="ttname"><a href="classoomph_1_1AnnularFromCartesianPMLElement.html#ad5ac4bafd6684b1cff949e74493aff83">oomph::AnnularFromCartesianPMLElement::enable_pml</a></div><div class="ttdeci">virtual void enable_pml(const double &amp;inner_pml_radius, const double &amp;outer_pml_radius, const Vector&lt; double &gt; &amp;origin, UniaxialPMLMapping *pml_mapping_pt)</div><div class="ttdoc">Enable pml. Specify the inner and outer radius of PML and the origin. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00381">pml_elements.h:381</a></div></div>
<div class="ttc" id="classoomph_1_1AxisAlignedPMLElement_html_a808e638b642342a84da6749cdcdf78e4"><div class="ttname"><a href="classoomph_1_1AxisAlignedPMLElement.html#a808e638b642342a84da6749cdcdf78e4">oomph::AxisAlignedPMLElement::pml_transformation_jacobian</a></div><div class="ttdeci">virtual void pml_transformation_jacobian(const unsigned &amp;ipt, const Vector&lt; double &gt; &amp;s, const Vector&lt; double &gt; &amp;x, DenseComplexMatrix &amp;jacobian_matrix, Vector&lt; std::complex&lt; double &gt; &gt; &amp;transformed_x)</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00199">pml_elements.h:199</a></div></div>
<div class="ttc" id="classoomph_1_1TangentiallyVaryingConformal2DPMLElement_html_a20be46fe19da89f6f2c799509ab38491"><div class="ttname"><a href="classoomph_1_1TangentiallyVaryingConformal2DPMLElement.html#a20be46fe19da89f6f2c799509ab38491">oomph::TangentiallyVaryingConformal2DPMLElement::Tangentially_varying_pml_mapping_pt</a></div><div class="ttdeci">TangentiallyVaryingConformalPMLMapping * Tangentially_varying_pml_mapping_pt</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00723">pml_elements.h:723</a></div></div>
<div class="ttc" id="classoomph_1_1PMLElementBase_html_aa5b90942c96259fd87804d5967f0b2ee"><div class="ttname"><a href="classoomph_1_1PMLElementBase.html#aa5b90942c96259fd87804d5967f0b2ee">oomph::PMLElementBase::wavenumber</a></div><div class="ttdeci">virtual double wavenumber() const</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00113">pml_elements.h:113</a></div></div>
<div class="ttc" id="classoomph_1_1AxisAlignedPMLElement_html_ace457b4782c083fd8b0925ae6b19a3e3"><div class="ttname"><a href="classoomph_1_1AxisAlignedPMLElement.html#ace457b4782c083fd8b0925ae6b19a3e3">oomph::AxisAlignedPMLElement::disable_pml</a></div><div class="ttdeci">virtual void disable_pml()</div><div class="ttdoc">Disable pml. Ensures the PML-ification in all directions has been deactivated. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00214">pml_elements.h:214</a></div></div>
<div class="ttc" id="classoomph_1_1TangentiallyDiscontinuousConformalPMLMapping_html"><div class="ttname"><a href="classoomph_1_1TangentiallyDiscontinuousConformalPMLMapping.html">oomph::TangentiallyDiscontinuousConformalPMLMapping</a></div><div class="ttdef"><b>Definition:</b> <a href="pml__mapping__functions_8h_source.html#l00217">pml_mapping_functions.h:217</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromLocalCoordinatePMLElement_html"><div class="ttname"><a href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html">oomph::AnnularFromLocalCoordinatePMLElement</a></div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00457">pml_elements.h:457</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromCartesianPMLElement_html_aa31e399eca5049053bce373144a52de0"><div class="ttname"><a href="classoomph_1_1AnnularFromCartesianPMLElement.html#aa31e399eca5049053bce373144a52de0">oomph::AnnularFromCartesianPMLElement::Origin</a></div><div class="ttdeci">Vector&lt; double &gt; Origin</div><div class="ttdoc">Coordinate of outer pml boundary (Storage is provided for any coordinate direction; only the entries ...</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00450">pml_elements.h:450</a></div></div>
<div class="ttc" id="classoomph_1_1TangentiallyVaryingConformalPMLMapping_html"><div class="ttname"><a href="classoomph_1_1TangentiallyVaryingConformalPMLMapping.html">oomph::TangentiallyVaryingConformalPMLMapping</a></div><div class="ttdef"><b>Definition:</b> <a href="pml__mapping__functions_8h_source.html#l00187">pml_mapping_functions.h:187</a></div></div>
<div class="ttc" id="classoomph_1_1Conformal2DPMLElement_html_a8c2bbfc42eb94014640a9945b698e107"><div class="ttname"><a href="classoomph_1_1Conformal2DPMLElement.html#a8c2bbfc42eb94014640a9945b698e107">oomph::Conformal2DPMLElement::Nu_s_index</a></div><div class="ttdeci">unsigned Nu_s_index</div><div class="ttdoc">Index of local coordinate which nu (through the PML coordinate) is parametrised by. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00650">pml_elements.h:650</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromLocalCoordinatePMLElement_html_a360bd3ab9afbcfd1007a626b780d51d8"><div class="ttname"><a href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a360bd3ab9afbcfd1007a626b780d51d8">oomph::AnnularFromLocalCoordinatePMLElement::Pml_outer_radius</a></div><div class="ttdeci">double Pml_outer_radius</div><div class="ttdoc">Value of radius at outer PML boundary. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00562">pml_elements.h:562</a></div></div>
<div class="ttc" id="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_html_a41eb2a90f1cb709fcdfb9a9ab3e3a101"><div class="ttname"><a href="classoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement.html#a41eb2a90f1cb709fcdfb9a9ab3e3a101">oomph::TangentiallyDiscontinuousConformal2DPMLElement::Force_rip_integration</a></div><div class="ttdeci">bool Force_rip_integration</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00880">pml_elements.h:880</a></div></div>
<div class="ttc" id="classoomph_1_1DenseMatrix_html"><div class="ttname"><a href="classoomph_1_1DenseMatrix.html">oomph::DenseMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip_html_a2808306cb7a88c96122af09c76d22f51"><div class="ttname"><a href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#a2808306cb7a88c96122af09c76d22f51">oomph::TangentiallyDiscontinuousConformal2DPMLElement::TwoDimRip::ripped_element_pt</a></div><div class="ttdeci">FiniteElementPt ripped_element_pt</div><div class="ttdoc">Position of onset of rip in local and global coordinates. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00774">pml_elements.h:774</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromCartesianPMLElement_html_aa54f360cf010ad8f30c3dbf27f699ae3"><div class="ttname"><a href="classoomph_1_1AnnularFromCartesianPMLElement.html#aa54f360cf010ad8f30c3dbf27f699ae3">oomph::AnnularFromCartesianPMLElement::AnnularFromCartesianPMLElement</a></div><div class="ttdeci">AnnularFromCartesianPMLElement()</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00373">pml_elements.h:373</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromLocalCoordinatePMLElement_html_ae9f56654db4d7979163db0529d9a1408"><div class="ttname"><a href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#ae9f56654db4d7979163db0529d9a1408">oomph::AnnularFromLocalCoordinatePMLElement::theta</a></div><div class="ttdeci">double theta(const Vector&lt; double &gt; &amp;s, const Vector&lt; double &gt; &amp;x)</div><div class="ttdoc">Angle relative to origin. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00515">pml_elements.h:515</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromLocalCoordinatePMLElement_html_a51049d96dbdb41fc740bdabd5657b99b"><div class="ttname"><a href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a51049d96dbdb41fc740bdabd5657b99b">oomph::AnnularFromLocalCoordinatePMLElement::Pml_mapping_pt</a></div><div class="ttdeci">UniaxialPMLMapping * Pml_mapping_pt</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00565">pml_elements.h:565</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularPMLElementBase_html"><div class="ttname"><a href="classoomph_1_1AnnularPMLElementBase.html">oomph::AnnularPMLElementBase</a></div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00310">pml_elements.h:310</a></div></div>
<div class="ttc" id="classoomph_1_1Conformal2DPMLElement_html_a8e9046efb4999dbb5840917a9568aad4"><div class="ttname"><a href="classoomph_1_1Conformal2DPMLElement.html#a8e9046efb4999dbb5840917a9568aad4">oomph::Conformal2DPMLElement::Pml_mapping_pt</a></div><div class="ttdeci">UniaxialPMLMapping * Pml_mapping_pt</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00658">pml_elements.h:658</a></div></div>
<div class="ttc" id="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip_html_afe6c1339363823496527b537316c877d"><div class="ttname"><a href="structoomph_1_1TangentiallyDiscontinuousConformal2DPMLElement_1_1TwoDimRip.html#afe6c1339363823496527b537316c877d">oomph::TangentiallyDiscontinuousConformal2DPMLElement::TwoDimRip::alpha</a></div><div class="ttdeci">std::complex&lt; double &gt; alpha</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00782">pml_elements.h:782</a></div></div>
<div class="ttc" id="classoomph_1_1AxisAlignedPMLElement_html_a76a879c7122fc2e5b723fbc7ce6b602b"><div class="ttname"><a href="classoomph_1_1AxisAlignedPMLElement.html#a76a879c7122fc2e5b723fbc7ce6b602b">oomph::AxisAlignedPMLElement::enable_pml</a></div><div class="ttdeci">virtual void enable_pml(const int &amp;direction, const double &amp;pml_inner_boundary, const double &amp;pml_outer_boundary)</div><div class="ttdoc">Enable pml. Specify the coordinate direction along which pml boundary is constant, as well as the coordinate along the dimension for the interface between the physical and artificial domains and the coordinate for the outer boundary. All of these are used to adjust the perfectly matched layer mechanism. Needs to be called separately for each pml-ified direction (if needed – e.g. in corner elements) </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00235">pml_elements.h:235</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromCartesianPMLElement_html_ab456fc3ba012d0fe871df2f580298a52"><div class="ttname"><a href="classoomph_1_1AnnularFromCartesianPMLElement.html#ab456fc3ba012d0fe871df2f580298a52">oomph::AnnularFromCartesianPMLElement::Pml_inner_radius</a></div><div class="ttdeci">double Pml_inner_radius</div><div class="ttdoc">Coordinate direction along which pml boundary is constant; alternatively: coordinate direction in whi...</div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00440">pml_elements.h:440</a></div></div>
<div class="ttc" id="classoomph_1_1PMLElementBase_html_ad29eae1793cca20aafa774086da1fc47"><div class="ttname"><a href="classoomph_1_1PMLElementBase.html#ad29eae1793cca20aafa774086da1fc47">oomph::PMLElementBase::PMLElementBase</a></div><div class="ttdeci">PMLElementBase()</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00071">pml_elements.h:71</a></div></div>
<div class="ttc" id="classoomph_1_1GeneralisedElement_html_a4bff11b8ff97aefabb2df41e61e1779f"><div class="ttname"><a href="classoomph_1_1GeneralisedElement.html#a4bff11b8ff97aefabb2df41e61e1779f">oomph::GeneralisedElement::Dummy_matrix</a></div><div class="ttdeci">static DenseMatrix&lt; double &gt; Dummy_matrix</div><div class="ttdoc">Empty dense matrix used as a dummy argument to combined residual and jacobian functions in the case w...</div><div class="ttdef"><b>Definition:</b> <a href="elements_8h_source.html#l00228">elements.h:228</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromCartesianPMLElement_html"><div class="ttname"><a href="classoomph_1_1AnnularFromCartesianPMLElement.html">oomph::AnnularFromCartesianPMLElement</a></div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00368">pml_elements.h:368</a></div></div>
<div class="ttc" id="classoomph_1_1AxisAlignedPMLElement_html"><div class="ttname"><a href="classoomph_1_1AxisAlignedPMLElement.html">oomph::AxisAlignedPMLElement</a></div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00160">pml_elements.h:160</a></div></div>
<div class="ttc" id="classoomph_1_1DenseComplexMatrix_html"><div class="ttname"><a href="classoomph_1_1DenseComplexMatrix.html">oomph::DenseComplexMatrix</a></div><div class="ttdoc">Class of matrices containing double complex, and stored as a DenseMatrix&lt;complex&lt;double&gt; &gt;...</div><div class="ttdef"><b>Definition:</b> <a href="complex__matrices_8h_source.html#l00213">complex_matrices.h:213</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromLocalCoordinatePMLElement_html_ae191ccf4540974d4923b80353955dbf1"><div class="ttname"><a href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#ae191ccf4540974d4923b80353955dbf1">oomph::AnnularFromLocalCoordinatePMLElement::Theta_at_s_max</a></div><div class="ttdeci">double Theta_at_s_max</div><div class="ttdoc">Value of theta at the maximum value of local coordinate. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00556">pml_elements.h:556</a></div></div>
<div class="ttc" id="classoomph_1_1AnnularFromLocalCoordinatePMLElement_html_a232008f72c0ee625d59b1e588c850dfe"><div class="ttname"><a href="classoomph_1_1AnnularFromLocalCoordinatePMLElement.html#a232008f72c0ee625d59b1e588c850dfe">oomph::AnnularFromLocalCoordinatePMLElement::enable_pml</a></div><div class="ttdeci">virtual void enable_pml(const double &amp;inner_pml_radius, const double &amp;outer_pml_radius, const Vector&lt; double &gt; &amp;origin)</div><div class="ttdoc">Enable pml. Specify the inner and outer radius of PML and the origin. </div><div class="ttdef"><b>Definition:</b> <a href="pml__elements_8h_source.html#l00494">pml_elements.h:494</a></div></div>
</div><!-- fragment --></div><!-- contents -->

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Thu Jun 18 2020 09:54:46
        </div>
      </div>
    </footer>
</body>
</html>
