\hypertarget{classoomph_1_1ComplexGMRES}{}\section{oomph\+:\+:Complex\+G\+M\+R\+ES$<$ M\+A\+T\+R\+IX $>$ Class Template Reference}
\label{classoomph_1_1ComplexGMRES}\index{oomph\+::\+Complex\+G\+M\+R\+E\+S$<$ M\+A\+T\+R\+I\+X $>$@{oomph\+::\+Complex\+G\+M\+R\+E\+S$<$ M\+A\+T\+R\+I\+X $>$}}


The \hyperlink{classoomph_1_1GMRES}{G\+M\+R\+ES} method rewritten for complex matrices.  




{\ttfamily \#include $<$complex\+\_\+smoother.\+h$>$}

Inheritance diagram for oomph\+:\+:Complex\+G\+M\+R\+ES$<$ M\+A\+T\+R\+IX $>$\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=5.000000cm]{classoomph_1_1ComplexGMRES}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classoomph_1_1ComplexGMRES_a8d0bfc83e16222c1eee97d8118505bae}{Complex\+G\+M\+R\+ES} ()
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1ComplexGMRES_ade91020000a1b6bf316ff9753ac6498b}{$\sim$\+Complex\+G\+M\+R\+ES} ()
\begin{DoxyCompactList}\small\item\em Empty destructor. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1ComplexGMRES_a834e97a93d141ece73e4f3aac2e8cd00}{Complex\+G\+M\+R\+ES} (const \hyperlink{classoomph_1_1ComplexGMRES}{Complex\+G\+M\+R\+ES} \&)
\begin{DoxyCompactList}\small\item\em Broken copy constructor. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1ComplexGMRES_a1b42167d4635b2ca294ed7aa843e9de5}{operator=} (const \hyperlink{classoomph_1_1ComplexGMRES}{Complex\+G\+M\+R\+ES} \&)
\begin{DoxyCompactList}\small\item\em Broken assignment operator. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1ComplexGMRES_a07db774f0aca4e71579c7c071e25a451}{disable\+\_\+resolve} ()
\begin{DoxyCompactList}\small\item\em Overload disable resolve so that it cleans up memory too. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1ComplexGMRES_a76987ec784cd80e6605c63ef8d0ec6b7}{solve} (\hyperlink{classoomph_1_1Problem}{Problem} $\ast$const \&problem\+\_\+pt, \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&result)
\begin{DoxyCompactList}\small\item\em Solver\+: Takes pointer to problem and returns the results vector which contains the solution of the linear system defined by the problem\textquotesingle{}s fully assembled Jacobian and residual vector. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1ComplexGMRES_a9dd1695e8d907d57151df79a6e3e3968}{solve} (\hyperlink{classoomph_1_1DoubleMatrixBase}{Double\+Matrix\+Base} $\ast$const \&matrix\+\_\+pt, const \hyperlink{classoomph_1_1Vector}{Vector}$<$ double $>$ \&rhs, \hyperlink{classoomph_1_1Vector}{Vector}$<$ double $>$ \&result)
\begin{DoxyCompactList}\small\item\em Linear-\/algebra-\/type solver\+: Takes pointer to a matrix and rhs vector and returns the solution of the linear system Call the broken base-\/class version. If you want this, please implement it. \end{DoxyCompactList}\item 
unsigned \hyperlink{classoomph_1_1ComplexGMRES_a10760c61c62771773e2adc57055717aa}{iterations} () const
\begin{DoxyCompactList}\small\item\em Number of iterations taken. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1ComplexGMRES_a391b81dac92362f07b2cf80f3ba0821a}{complex\+\_\+smoother\+\_\+setup} (\hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1CRDoubleMatrix}{C\+R\+Double\+Matrix} $\ast$$>$ helmholtz\+\_\+matrix\+\_\+pt)
\begin{DoxyCompactList}\small\item\em Setup\+: Pass pointer to the matrix and store in cast form. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1ComplexGMRES_a874520bc44cd8127497d972373938df9}{complex\+\_\+smoother\+\_\+solve} (const \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ \&rhs, \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ \&solution)
\begin{DoxyCompactList}\small\item\em The smoother\+\_\+solve function performs fixed number of iterations on the system A$\ast$result=rhs. The number of (smoothing) iterations is the same as the max. number of iterations in the underlying \hyperlink{classoomph_1_1IterativeLinearSolver}{Iterative\+Linear\+Solver} class. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{classoomph_1_1ComplexGMRES_a946b88bc1392180c56909b739bfa7b3c}{clean\+\_\+up\+\_\+memory} ()
\begin{DoxyCompactList}\small\item\em Cleanup data that\textquotesingle{}s stored for resolve (if any has been stored) \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1ComplexGMRES_a848721022a08fde4b2182a143f287ded}{complex\+\_\+solve\+\_\+helper} (const \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ \&rhs, \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ \&solution)
\begin{DoxyCompactList}\small\item\em This is where the actual work is done. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1ComplexGMRES_a0c6df8b6c50a0ccd344a62654b1411d0}{update} (const unsigned \&k, const \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1Vector}{Vector}$<$ std\+::complex$<$ double $>$ $>$ $>$ \&hessenberg, const \hyperlink{classoomph_1_1Vector}{Vector}$<$ std\+::complex$<$ double $>$ $>$ \&\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}, const \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ $>$ \&v, \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ \&x)
\begin{DoxyCompactList}\small\item\em Helper function to update the result vector. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1ComplexGMRES_a07183636586d7d30fcde380ef88e5fe6}{generate\+\_\+plane\+\_\+rotation} (std\+::complex$<$ double $>$ \&dx, std\+::complex$<$ double $>$ \&dy, std\+::complex$<$ double $>$ \&cs, std\+::complex$<$ double $>$ \&sn)
\begin{DoxyCompactList}\small\item\em Helper function\+: Generate a plane rotation. This is done by finding the value of $ \cos(\theta) $ (i.\+e. cs) and the value of $ \sin(\theta) $ (i.\+e. sn) such that\+: \[ \begin{bmatrix} \overline{\cos\theta} & \overline{\sin\theta} \cr -\sin\theta & \cos\theta \end{bmatrix} \begin{bmatrix} dx \\ dy \end{bmatrix} = \begin{bmatrix} r \\ 0 \end{bmatrix}, \] where $ r=\sqrt{pow(|dx|,2)+pow(|dy|,2)} $. The values of a and b are given by\+: The values of dx and dy are given by\+: \[ \cos\theta&=\dfrac{dx}{\sqrt{|dx|^2+|dy|^2}}, \] and \[ \sin\theta&=\dfrac{dy}{\sqrt{|dx|^2+|dy|^2}}. \] Taken from\+: Saad Y.\char`\"{}\+Iterative methods for sparse linear systems\char`\"{}, p.\+193. We also check to see that sn is always a real (nonnegative) number. See pp.\+193-\/194 for an explanation. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1ComplexGMRES_a8aa80ff477c4b131f8c1a4c74f872df1}{apply\+\_\+plane\+\_\+rotation} (std\+::complex$<$ double $>$ \&dx, std\+::complex$<$ double $>$ \&dy, std\+::complex$<$ double $>$ \&cs, std\+::complex$<$ double $>$ \&sn)
\begin{DoxyCompactList}\small\item\em Helper function\+: Apply plane rotation. This is done using the update\+: \[ \begin{bmatrix} dx \\ dy \end{bmatrix} \leftarrow \begin{bmatrix} \overline{\cos\theta} & \overline{\sin\theta} \\ -\sin\theta & \cos\theta \end{bmatrix} \begin{bmatrix} dx \\ dy \end{bmatrix}. \] Taken from\+: Saad Y.\char`\"{}\+Iterative methods for sparse linear systems\char`\"{}, p.\+193. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
unsigned \hyperlink{classoomph_1_1ComplexGMRES_a208aaa9528d6b08afa5324f77ac70581}{Iterations}
\begin{DoxyCompactList}\small\item\em Number of iterations taken. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1CRDoubleMatrix}{C\+R\+Double\+Matrix} $\ast$ $>$ \hyperlink{classoomph_1_1ComplexGMRES_adfd862b611a335b5d6872a9eb37aa193}{Matrices\+\_\+storage\+\_\+pt}
\begin{DoxyCompactList}\small\item\em \hyperlink{classoomph_1_1Vector}{Vector} of pointers to the real and imaginary part of the system matrix. \end{DoxyCompactList}\item 
bool \hyperlink{classoomph_1_1ComplexGMRES_a2694315efaf2aa353ad4d67f316b1597}{Resolving}
\begin{DoxyCompactList}\small\item\em Boolean flag to indicate if the solve is done in re-\/solve mode, bypassing setup of matrix and preconditioner. \end{DoxyCompactList}\item 
bool \hyperlink{classoomph_1_1ComplexGMRES_aa38fa18230fc30f271d59481ccee3b55}{Matrix\+\_\+can\+\_\+be\+\_\+deleted}
\begin{DoxyCompactList}\small\item\em Boolean flag to indicate if the real and imaginary system matrices can be deleted. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}
\subsubsection*{template$<$typename M\+A\+T\+R\+IX$>$\newline
class oomph\+::\+Complex\+G\+M\+R\+E\+S$<$ M\+A\+T\+R\+I\+X $>$}

The \hyperlink{classoomph_1_1GMRES}{G\+M\+R\+ES} method rewritten for complex matrices. 

Definition at line 844 of file complex\+\_\+smoother.\+h.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classoomph_1_1ComplexGMRES_a8d0bfc83e16222c1eee97d8118505bae}\label{classoomph_1_1ComplexGMRES_a8d0bfc83e16222c1eee97d8118505bae}} 
\index{oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}!Complex\+G\+M\+R\+ES@{Complex\+G\+M\+R\+ES}}
\index{Complex\+G\+M\+R\+ES@{Complex\+G\+M\+R\+ES}!oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}}
\subsubsection{\texorpdfstring{Complex\+G\+M\+R\+E\+S()}{ComplexGMRES()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1ComplexGMRES}{oomph\+::\+Complex\+G\+M\+R\+ES}$<$ M\+A\+T\+R\+IX $>$\+::\hyperlink{classoomph_1_1ComplexGMRES}{Complex\+G\+M\+R\+ES} (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Constructor. 



Definition at line 850 of file complex\+\_\+smoother.\+h.

\mbox{\Hypertarget{classoomph_1_1ComplexGMRES_ade91020000a1b6bf316ff9753ac6498b}\label{classoomph_1_1ComplexGMRES_ade91020000a1b6bf316ff9753ac6498b}} 
\index{oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}!````~Complex\+G\+M\+R\+ES@{$\sim$\+Complex\+G\+M\+R\+ES}}
\index{````~Complex\+G\+M\+R\+ES@{$\sim$\+Complex\+G\+M\+R\+ES}!oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}}
\subsubsection{\texorpdfstring{$\sim$\+Complex\+G\+M\+R\+E\+S()}{~ComplexGMRES()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1ComplexGMRES}{oomph\+::\+Complex\+G\+M\+R\+ES}$<$ M\+A\+T\+R\+IX $>$\+::$\sim$\hyperlink{classoomph_1_1ComplexGMRES}{Complex\+G\+M\+R\+ES} (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Empty destructor. 



Definition at line 858 of file complex\+\_\+smoother.\+h.



References oomph\+::\+Linear\+Solver\+::clean\+\_\+up\+\_\+memory().

\mbox{\Hypertarget{classoomph_1_1ComplexGMRES_a834e97a93d141ece73e4f3aac2e8cd00}\label{classoomph_1_1ComplexGMRES_a834e97a93d141ece73e4f3aac2e8cd00}} 
\index{oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}!Complex\+G\+M\+R\+ES@{Complex\+G\+M\+R\+ES}}
\index{Complex\+G\+M\+R\+ES@{Complex\+G\+M\+R\+ES}!oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}}
\subsubsection{\texorpdfstring{Complex\+G\+M\+R\+E\+S()}{ComplexGMRES()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1ComplexGMRES}{oomph\+::\+Complex\+G\+M\+R\+ES}$<$ M\+A\+T\+R\+IX $>$\+::\hyperlink{classoomph_1_1ComplexGMRES}{Complex\+G\+M\+R\+ES} (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1ComplexGMRES}{Complex\+G\+M\+R\+ES}$<$ M\+A\+T\+R\+IX $>$ \&}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Broken copy constructor. 



Definition at line 865 of file complex\+\_\+smoother.\+h.



References oomph\+::\+Broken\+Copy\+::broken\+\_\+copy().



\subsection{Member Function Documentation}
\mbox{\Hypertarget{classoomph_1_1ComplexGMRES_a8aa80ff477c4b131f8c1a4c74f872df1}\label{classoomph_1_1ComplexGMRES_a8aa80ff477c4b131f8c1a4c74f872df1}} 
\index{oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}!apply\+\_\+plane\+\_\+rotation@{apply\+\_\+plane\+\_\+rotation}}
\index{apply\+\_\+plane\+\_\+rotation@{apply\+\_\+plane\+\_\+rotation}!oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}}
\subsubsection{\texorpdfstring{apply\+\_\+plane\+\_\+rotation()}{apply\_plane\_rotation()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1ComplexGMRES}{oomph\+::\+Complex\+G\+M\+R\+ES}$<$ M\+A\+T\+R\+IX $>$\+::apply\+\_\+plane\+\_\+rotation (\begin{DoxyParamCaption}\item[{std\+::complex$<$ double $>$ \&}]{dx,  }\item[{std\+::complex$<$ double $>$ \&}]{dy,  }\item[{std\+::complex$<$ double $>$ \&}]{cs,  }\item[{std\+::complex$<$ double $>$ \&}]{sn }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Helper function\+: Apply plane rotation. This is done using the update\+: \[ \begin{bmatrix} dx \\ dy \end{bmatrix} \leftarrow \begin{bmatrix} \overline{\cos\theta} & \overline{\sin\theta} \\ -\sin\theta & \cos\theta \end{bmatrix} \begin{bmatrix} dx \\ dy \end{bmatrix}. \] Taken from\+: Saad Y.\char`\"{}\+Iterative methods for sparse linear systems\char`\"{}, p.\+193. 



Definition at line 1215 of file complex\+\_\+smoother.\+h.

\mbox{\Hypertarget{classoomph_1_1ComplexGMRES_a946b88bc1392180c56909b739bfa7b3c}\label{classoomph_1_1ComplexGMRES_a946b88bc1392180c56909b739bfa7b3c}} 
\index{oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}!clean\+\_\+up\+\_\+memory@{clean\+\_\+up\+\_\+memory}}
\index{clean\+\_\+up\+\_\+memory@{clean\+\_\+up\+\_\+memory}!oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}}
\subsubsection{\texorpdfstring{clean\+\_\+up\+\_\+memory()}{clean\_up\_memory()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1ComplexGMRES}{oomph\+::\+Complex\+G\+M\+R\+ES}$<$ M\+A\+T\+R\+IX $>$\+::clean\+\_\+up\+\_\+memory (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}, {\ttfamily [virtual]}}



Cleanup data that\textquotesingle{}s stored for resolve (if any has been stored) 



Reimplemented from \hyperlink{classoomph_1_1LinearSolver_a9d66f3262e80ca06a365f98216afd85f}{oomph\+::\+Linear\+Solver}.



Definition at line 998 of file complex\+\_\+smoother.\+h.

\mbox{\Hypertarget{classoomph_1_1ComplexGMRES_a391b81dac92362f07b2cf80f3ba0821a}\label{classoomph_1_1ComplexGMRES_a391b81dac92362f07b2cf80f3ba0821a}} 
\index{oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}!complex\+\_\+smoother\+\_\+setup@{complex\+\_\+smoother\+\_\+setup}}
\index{complex\+\_\+smoother\+\_\+setup@{complex\+\_\+smoother\+\_\+setup}!oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}}
\subsubsection{\texorpdfstring{complex\+\_\+smoother\+\_\+setup()}{complex\_smoother\_setup()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1ComplexGMRES}{oomph\+::\+Complex\+G\+M\+R\+ES}$<$ M\+A\+T\+R\+IX $>$\+::complex\+\_\+smoother\+\_\+setup (\begin{DoxyParamCaption}\item[{\hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1CRDoubleMatrix}{C\+R\+Double\+Matrix} $\ast$$>$}]{helmholtz\+\_\+matrix\+\_\+pt }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Setup\+: Pass pointer to the matrix and store in cast form. 



Implements \hyperlink{classoomph_1_1HelmholtzSmoother_a7fffc8d9a93fa5ca0a3e21c972ea3c05}{oomph\+::\+Helmholtz\+Smoother}.



Definition at line 923 of file complex\+\_\+smoother.\+h.



References oomph\+::\+Distributable\+Linear\+Algebra\+Object\+::nrow().

\mbox{\Hypertarget{classoomph_1_1ComplexGMRES_a874520bc44cd8127497d972373938df9}\label{classoomph_1_1ComplexGMRES_a874520bc44cd8127497d972373938df9}} 
\index{oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}!complex\+\_\+smoother\+\_\+solve@{complex\+\_\+smoother\+\_\+solve}}
\index{complex\+\_\+smoother\+\_\+solve@{complex\+\_\+smoother\+\_\+solve}!oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}}
\subsubsection{\texorpdfstring{complex\+\_\+smoother\+\_\+solve()}{complex\_smoother\_solve()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1ComplexGMRES}{oomph\+::\+Complex\+G\+M\+R\+ES}$<$ M\+A\+T\+R\+IX $>$\+::complex\+\_\+smoother\+\_\+solve (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ \&}]{rhs,  }\item[{\hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ \&}]{solution }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



The smoother\+\_\+solve function performs fixed number of iterations on the system A$\ast$result=rhs. The number of (smoothing) iterations is the same as the max. number of iterations in the underlying \hyperlink{classoomph_1_1IterativeLinearSolver}{Iterative\+Linear\+Solver} class. 



Implements \hyperlink{classoomph_1_1HelmholtzSmoother_a8ec748270df3e1199f19ef267d5b8e85}{oomph\+::\+Helmholtz\+Smoother}.



Definition at line 985 of file complex\+\_\+smoother.\+h.



References oomph\+::\+Helmholtz\+Smoother\+::\+Use\+\_\+as\+\_\+smoother.

\mbox{\Hypertarget{classoomph_1_1ComplexGMRES_a848721022a08fde4b2182a143f287ded}\label{classoomph_1_1ComplexGMRES_a848721022a08fde4b2182a143f287ded}} 
\index{oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}!complex\+\_\+solve\+\_\+helper@{complex\+\_\+solve\+\_\+helper}}
\index{complex\+\_\+solve\+\_\+helper@{complex\+\_\+solve\+\_\+helper}!oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}}
\subsubsection{\texorpdfstring{complex\+\_\+solve\+\_\+helper()}{complex\_solve\_helper()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX $>$ \\
void \hyperlink{classoomph_1_1ComplexGMRES}{oomph\+::\+Complex\+G\+M\+R\+ES}$<$ M\+A\+T\+R\+IX $>$\+::complex\+\_\+solve\+\_\+helper (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ \&}]{rhs,  }\item[{\hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ \&}]{solution }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



This is where the actual work is done. 



Definition at line 1250 of file complex\+\_\+smoother.\+h.



References oomph\+::\+Helmholtz\+Smoother\+::complex\+\_\+matrix\+\_\+multiplication(), oomph\+::\+Linear\+Algebra\+Distribution\+::distributed(), oomph\+::\+Distributable\+Linear\+Algebra\+Object\+::distribution\+\_\+pt(), oomph\+::\+Iterative\+Linear\+Solver\+::\+Doc\+\_\+convergence\+\_\+history, oomph\+::\+Linear\+Solver\+::\+Doc\+\_\+time, i, oomph\+::\+Vector$<$ \+\_\+\+Tp $>$\+::initialise(), oomph\+::\+Iterative\+Linear\+Solver\+::\+Max\+\_\+iter, oomph\+::\+Distributable\+Linear\+Algebra\+Object\+::nrow(), oomph\+::oomph\+\_\+info, oomph\+::\+Iterative\+Linear\+Solver\+::\+Output\+\_\+file\+\_\+stream, s, oomph\+::\+Iterative\+Linear\+Solver\+::\+Solution\+\_\+time, oomph\+::\+Timing\+Helpers\+::timer(), and oomph\+::\+Iterative\+Linear\+Solver\+::\+Tolerance.

\mbox{\Hypertarget{classoomph_1_1ComplexGMRES_a07db774f0aca4e71579c7c071e25a451}\label{classoomph_1_1ComplexGMRES_a07db774f0aca4e71579c7c071e25a451}} 
\index{oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}!disable\+\_\+resolve@{disable\+\_\+resolve}}
\index{disable\+\_\+resolve@{disable\+\_\+resolve}!oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}}
\subsubsection{\texorpdfstring{disable\+\_\+resolve()}{disable\_resolve()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1ComplexGMRES}{oomph\+::\+Complex\+G\+M\+R\+ES}$<$ M\+A\+T\+R\+IX $>$\+::disable\+\_\+resolve (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Overload disable resolve so that it cleans up memory too. 



Reimplemented from \hyperlink{classoomph_1_1LinearSolver_ad61c63af94c5961830bd9807225a48d6}{oomph\+::\+Linear\+Solver}.



Definition at line 877 of file complex\+\_\+smoother.\+h.



References oomph\+::\+Linear\+Solver\+::clean\+\_\+up\+\_\+memory(), and oomph\+::\+Linear\+Solver\+::disable\+\_\+resolve().

\mbox{\Hypertarget{classoomph_1_1ComplexGMRES_a07183636586d7d30fcde380ef88e5fe6}\label{classoomph_1_1ComplexGMRES_a07183636586d7d30fcde380ef88e5fe6}} 
\index{oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}!generate\+\_\+plane\+\_\+rotation@{generate\+\_\+plane\+\_\+rotation}}
\index{generate\+\_\+plane\+\_\+rotation@{generate\+\_\+plane\+\_\+rotation}!oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}}
\subsubsection{\texorpdfstring{generate\+\_\+plane\+\_\+rotation()}{generate\_plane\_rotation()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1ComplexGMRES}{oomph\+::\+Complex\+G\+M\+R\+ES}$<$ M\+A\+T\+R\+IX $>$\+::generate\+\_\+plane\+\_\+rotation (\begin{DoxyParamCaption}\item[{std\+::complex$<$ double $>$ \&}]{dx,  }\item[{std\+::complex$<$ double $>$ \&}]{dy,  }\item[{std\+::complex$<$ double $>$ \&}]{cs,  }\item[{std\+::complex$<$ double $>$ \&}]{sn }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Helper function\+: Generate a plane rotation. This is done by finding the value of $ \cos(\theta) $ (i.\+e. cs) and the value of $ \sin(\theta) $ (i.\+e. sn) such that\+: \[ \begin{bmatrix} \overline{\cos\theta} & \overline{\sin\theta} \cr -\sin\theta & \cos\theta \end{bmatrix} \begin{bmatrix} dx \\ dy \end{bmatrix} = \begin{bmatrix} r \\ 0 \end{bmatrix}, \] where $ r=\sqrt{pow(|dx|,2)+pow(|dy|,2)} $. The values of a and b are given by\+: The values of dx and dy are given by\+: \[ \cos\theta&=\dfrac{dx}{\sqrt{|dx|^2+|dy|^2}}, \] and \[ \sin\theta&=\dfrac{dy}{\sqrt{|dx|^2+|dy|^2}}. \] Taken from\+: Saad Y.\char`\"{}\+Iterative methods for sparse linear systems\char`\"{}, p.\+193. We also check to see that sn is always a real (nonnegative) number. See pp.\+193-\/194 for an explanation. 



Definition at line 1123 of file complex\+\_\+smoother.\+h.



References oomph\+::\+Iterative\+Linear\+Solver\+::tolerance().

\mbox{\Hypertarget{classoomph_1_1ComplexGMRES_a10760c61c62771773e2adc57055717aa}\label{classoomph_1_1ComplexGMRES_a10760c61c62771773e2adc57055717aa}} 
\index{oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}!iterations@{iterations}}
\index{iterations@{iterations}!oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}}
\subsubsection{\texorpdfstring{iterations()}{iterations()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
unsigned \hyperlink{classoomph_1_1ComplexGMRES}{oomph\+::\+Complex\+G\+M\+R\+ES}$<$ M\+A\+T\+R\+IX $>$\+::iterations (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Number of iterations taken. 



Implements \hyperlink{classoomph_1_1IterativeLinearSolver_a5fe7f7b5e4847fdbd4f95d3875ec7a46}{oomph\+::\+Iterative\+Linear\+Solver}.



Definition at line 916 of file complex\+\_\+smoother.\+h.

\mbox{\Hypertarget{classoomph_1_1ComplexGMRES_a1b42167d4635b2ca294ed7aa843e9de5}\label{classoomph_1_1ComplexGMRES_a1b42167d4635b2ca294ed7aa843e9de5}} 
\index{oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}!operator=@{operator=}}
\index{operator=@{operator=}!oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}}
\subsubsection{\texorpdfstring{operator=()}{operator=()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1ComplexGMRES}{oomph\+::\+Complex\+G\+M\+R\+ES}$<$ M\+A\+T\+R\+IX $>$\+::operator= (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1ComplexGMRES}{Complex\+G\+M\+R\+ES}$<$ M\+A\+T\+R\+IX $>$ \&}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Broken assignment operator. 



Definition at line 871 of file complex\+\_\+smoother.\+h.



References oomph\+::\+Broken\+Copy\+::broken\+\_\+assign().

\mbox{\Hypertarget{classoomph_1_1ComplexGMRES_a76987ec784cd80e6605c63ef8d0ec6b7}\label{classoomph_1_1ComplexGMRES_a76987ec784cd80e6605c63ef8d0ec6b7}} 
\index{oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}!solve@{solve}}
\index{solve@{solve}!oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}}
\subsubsection{\texorpdfstring{solve()}{solve()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1ComplexGMRES}{oomph\+::\+Complex\+G\+M\+R\+ES}$<$ M\+A\+T\+R\+IX $>$\+::solve (\begin{DoxyParamCaption}\item[{\hyperlink{classoomph_1_1Problem}{Problem} $\ast$const \&}]{problem\+\_\+pt,  }\item[{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{result }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Solver\+: Takes pointer to problem and returns the results vector which contains the solution of the linear system defined by the problem\textquotesingle{}s fully assembled Jacobian and residual vector. 



Implements \hyperlink{classoomph_1_1LinearSolver_a15ce22542b74ed1826ea485edacbeb6e}{oomph\+::\+Linear\+Solver}.



Definition at line 889 of file complex\+\_\+smoother.\+h.



References oomph\+::\+Global\+\_\+string\+\_\+for\+\_\+annotation\+::string().

\mbox{\Hypertarget{classoomph_1_1ComplexGMRES_a9dd1695e8d907d57151df79a6e3e3968}\label{classoomph_1_1ComplexGMRES_a9dd1695e8d907d57151df79a6e3e3968}} 
\index{oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}!solve@{solve}}
\index{solve@{solve}!oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}}
\subsubsection{\texorpdfstring{solve()}{solve()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1ComplexGMRES}{oomph\+::\+Complex\+G\+M\+R\+ES}$<$ M\+A\+T\+R\+IX $>$\+::solve (\begin{DoxyParamCaption}\item[{\hyperlink{classoomph_1_1DoubleMatrixBase}{Double\+Matrix\+Base} $\ast$const \&}]{matrix\+\_\+pt,  }\item[{const \hyperlink{classoomph_1_1Vector}{Vector}$<$ double $>$ \&}]{rhs,  }\item[{\hyperlink{classoomph_1_1Vector}{Vector}$<$ double $>$ \&}]{result }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Linear-\/algebra-\/type solver\+: Takes pointer to a matrix and rhs vector and returns the solution of the linear system Call the broken base-\/class version. If you want this, please implement it. 



Reimplemented from \hyperlink{classoomph_1_1LinearSolver_a1f7a2ee2cd18d3dafc20a61ca2f52dbb}{oomph\+::\+Linear\+Solver}.



Definition at line 908 of file complex\+\_\+smoother.\+h.



References oomph\+::\+Linear\+Solver\+::solve().

\mbox{\Hypertarget{classoomph_1_1ComplexGMRES_a0c6df8b6c50a0ccd344a62654b1411d0}\label{classoomph_1_1ComplexGMRES_a0c6df8b6c50a0ccd344a62654b1411d0}} 
\index{oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}!update@{update}}
\index{update@{update}!oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}}
\subsubsection{\texorpdfstring{update()}{update()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1ComplexGMRES}{oomph\+::\+Complex\+G\+M\+R\+ES}$<$ M\+A\+T\+R\+IX $>$\+::update (\begin{DoxyParamCaption}\item[{const unsigned \&}]{k,  }\item[{const \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1Vector}{Vector}$<$ std\+::complex$<$ double $>$ $>$ $>$ \&}]{hessenberg,  }\item[{const \hyperlink{classoomph_1_1Vector}{Vector}$<$ std\+::complex$<$ double $>$ $>$ \&}]{s,  }\item[{const \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ $>$ \&}]{v,  }\item[{\hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ \&}]{x }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Helper function to update the result vector. 



Definition at line 1028 of file complex\+\_\+smoother.\+h.



References i, and s.



\subsection{Member Data Documentation}
\mbox{\Hypertarget{classoomph_1_1ComplexGMRES_a208aaa9528d6b08afa5324f77ac70581}\label{classoomph_1_1ComplexGMRES_a208aaa9528d6b08afa5324f77ac70581}} 
\index{oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}!Iterations@{Iterations}}
\index{Iterations@{Iterations}!oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}}
\subsubsection{\texorpdfstring{Iterations}{Iterations}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
unsigned \hyperlink{classoomph_1_1ComplexGMRES}{oomph\+::\+Complex\+G\+M\+R\+ES}$<$ M\+A\+T\+R\+IX $>$\+::Iterations\hspace{0.3cm}{\ttfamily [private]}}



Number of iterations taken. 



Definition at line 1231 of file complex\+\_\+smoother.\+h.

\mbox{\Hypertarget{classoomph_1_1ComplexGMRES_adfd862b611a335b5d6872a9eb37aa193}\label{classoomph_1_1ComplexGMRES_adfd862b611a335b5d6872a9eb37aa193}} 
\index{oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}!Matrices\+\_\+storage\+\_\+pt@{Matrices\+\_\+storage\+\_\+pt}}
\index{Matrices\+\_\+storage\+\_\+pt@{Matrices\+\_\+storage\+\_\+pt}!oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}}
\subsubsection{\texorpdfstring{Matrices\+\_\+storage\+\_\+pt}{Matrices\_storage\_pt}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$\hyperlink{classoomph_1_1CRDoubleMatrix}{C\+R\+Double\+Matrix}$\ast$$>$ \hyperlink{classoomph_1_1ComplexGMRES}{oomph\+::\+Complex\+G\+M\+R\+ES}$<$ M\+A\+T\+R\+IX $>$\+::Matrices\+\_\+storage\+\_\+pt\hspace{0.3cm}{\ttfamily [private]}}



\hyperlink{classoomph_1_1Vector}{Vector} of pointers to the real and imaginary part of the system matrix. 



Definition at line 1234 of file complex\+\_\+smoother.\+h.

\mbox{\Hypertarget{classoomph_1_1ComplexGMRES_aa38fa18230fc30f271d59481ccee3b55}\label{classoomph_1_1ComplexGMRES_aa38fa18230fc30f271d59481ccee3b55}} 
\index{oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}!Matrix\+\_\+can\+\_\+be\+\_\+deleted@{Matrix\+\_\+can\+\_\+be\+\_\+deleted}}
\index{Matrix\+\_\+can\+\_\+be\+\_\+deleted@{Matrix\+\_\+can\+\_\+be\+\_\+deleted}!oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}}
\subsubsection{\texorpdfstring{Matrix\+\_\+can\+\_\+be\+\_\+deleted}{Matrix\_can\_be\_deleted}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
bool \hyperlink{classoomph_1_1ComplexGMRES}{oomph\+::\+Complex\+G\+M\+R\+ES}$<$ M\+A\+T\+R\+IX $>$\+::Matrix\+\_\+can\+\_\+be\+\_\+deleted\hspace{0.3cm}{\ttfamily [private]}}



Boolean flag to indicate if the real and imaginary system matrices can be deleted. 



Definition at line 1242 of file complex\+\_\+smoother.\+h.

\mbox{\Hypertarget{classoomph_1_1ComplexGMRES_a2694315efaf2aa353ad4d67f316b1597}\label{classoomph_1_1ComplexGMRES_a2694315efaf2aa353ad4d67f316b1597}} 
\index{oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}!Resolving@{Resolving}}
\index{Resolving@{Resolving}!oomph\+::\+Complex\+G\+M\+R\+ES@{oomph\+::\+Complex\+G\+M\+R\+ES}}
\subsubsection{\texorpdfstring{Resolving}{Resolving}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
bool \hyperlink{classoomph_1_1ComplexGMRES}{oomph\+::\+Complex\+G\+M\+R\+ES}$<$ M\+A\+T\+R\+IX $>$\+::Resolving\hspace{0.3cm}{\ttfamily [private]}}



Boolean flag to indicate if the solve is done in re-\/solve mode, bypassing setup of matrix and preconditioner. 



Definition at line 1238 of file complex\+\_\+smoother.\+h.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
\hyperlink{complex__smoother_8h}{complex\+\_\+smoother.\+h}\end{DoxyCompactItemize}
