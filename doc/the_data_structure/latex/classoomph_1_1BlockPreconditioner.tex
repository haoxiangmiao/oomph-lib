\hypertarget{classoomph_1_1BlockPreconditioner}{}\section{oomph\+:\+:Block\+Preconditioner$<$ M\+A\+T\+R\+IX $>$ Class Template Reference}
\label{classoomph_1_1BlockPreconditioner}\index{oomph\+::\+Block\+Preconditioner$<$ M\+A\+T\+R\+I\+X $>$@{oomph\+::\+Block\+Preconditioner$<$ M\+A\+T\+R\+I\+X $>$}}


{\ttfamily \#include $<$block\+\_\+preconditioner.\+h$>$}

Inheritance diagram for oomph\+:\+:Block\+Preconditioner$<$ M\+A\+T\+R\+IX $>$\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=1.160221cm]{classoomph_1_1BlockPreconditioner}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classoomph_1_1BlockPreconditioner_a74c4b4bef4371b72816631445689a2e6}{Block\+Preconditioner} ()
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
virtual \hyperlink{classoomph_1_1BlockPreconditioner_a78c33fc6f29101f027e22d64d158d567}{$\sim$\+Block\+Preconditioner} ()
\begin{DoxyCompactList}\small\item\em Destructor. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1BlockPreconditioner_a9652c8d4fb3cdbd8216f13c356324170}{Block\+Preconditioner} (const \hyperlink{classoomph_1_1BlockPreconditioner}{Block\+Preconditioner} \&)
\begin{DoxyCompactList}\small\item\em Broken copy constructor. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a910f9395fa4f5f9bc4d13a9d104c432d}{operator=} (const \hyperlink{classoomph_1_1BlockPreconditioner}{Block\+Preconditioner} \&)
\begin{DoxyCompactList}\small\item\em Broken assignment operator. \end{DoxyCompactList}\item 
M\+A\+T\+R\+IX $\ast$ \hyperlink{classoomph_1_1BlockPreconditioner_a9aac48fd53e579e6db8eeed58933a14b}{matrix\+\_\+pt} () const
\begin{DoxyCompactList}\small\item\em Access function to matrix\+\_\+pt. If this is the master then cast the matrix pointer to M\+A\+T\+R\+I\+X$\ast$, error check and return. Otherwise ask the master for its matrix pointer. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a0d977a81515458e59b94438a215e93e1}{turn\+\_\+on\+\_\+recursive\+\_\+debug\+\_\+flag} ()
\begin{DoxyCompactList}\small\item\em Toggles on the recursive debug flag. The change goes up the block preconditioning hierarchy. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a8ed741a5fbf514fc29f0a332a211255f}{turn\+\_\+off\+\_\+recursive\+\_\+debug\+\_\+flag} ()
\begin{DoxyCompactList}\small\item\em Toggles off the recursive debug flag. The change goes up the block preconditioning hierarchy. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a271bf5ea70579e43797187498d98f9a9}{turn\+\_\+on\+\_\+debug\+\_\+flag} ()
\begin{DoxyCompactList}\small\item\em Toggles on the debug flag. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a46c57c6a2f4b54e27d2aaccc4ec90665}{turn\+\_\+off\+\_\+debug\+\_\+flag} ()
\begin{DoxyCompactList}\small\item\em Toggles off the debug flag. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_ab8e2478caa8370dd12462f17e1cc8082}{turn\+\_\+into\+\_\+subsidiary\+\_\+block\+\_\+preconditioner} (\hyperlink{classoomph_1_1BlockPreconditioner}{Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$ $\ast$master\+\_\+block\+\_\+prec\+\_\+pt, const \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \&doftype\+\_\+in\+\_\+master\+\_\+preconditioner\+\_\+coarse)
\begin{DoxyCompactList}\small\item\em Function to turn this preconditioner into a subsidiary preconditioner that operates within a bigger "master block preconditioner (e.\+g. a Navier-\/\+Stokes 2x2 block preconditioner dealing with the fluid sub-\/blocks within a 3x3 F\+SI preconditioner. Once this is done the master block preconditioner deals with the block setup etc. The vector doftype\+\_\+in\+\_\+master\+\_\+preconditioner\+\_\+coarse must specify the dof number in the master preconditioner that corresponds to a dof number in this preconditioner. {\bfseries 1}. The length of the vector is used to determine the number of blocks in this preconditioner therefore it must be correctly sized. {\bfseries 2}. block\+\_\+setup(...) should be called in the master preconditioner before this method is called. {\bfseries 3}. block\+\_\+setup(...) should be called in the corresponding subsidiary preconditioner after this method is called. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_ae9282acaaf19fa2cdb703d49f1a8de25}{turn\+\_\+into\+\_\+subsidiary\+\_\+block\+\_\+preconditioner} (\hyperlink{classoomph_1_1BlockPreconditioner}{Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$ $\ast$master\+\_\+block\+\_\+prec\+\_\+pt, const \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \&doftype\+\_\+in\+\_\+master\+\_\+preconditioner\+\_\+coarse, const \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ $>$ \&doftype\+\_\+coarsen\+\_\+map\+\_\+coarse)
\begin{DoxyCompactList}\small\item\em Function to turn this preconditioner into a subsidiary preconditioner that operates within a bigger "master block preconditioner (e.\+g. a Navier-\/\+Stokes 2x2 block preconditioner dealing with the fluid sub-\/blocks within a 3x3 F\+SI preconditioner. Once this is done the master block preconditioner deals with the block setup etc. The vector doftype\+\_\+in\+\_\+master\+\_\+preconditioner\+\_\+coarse must specify the dof number in the master preconditioner that corresponds to a dof number in this preconditioner. {\bfseries 1}. The length of the vector is used to determine the number of blocks in this preconditioner therefore it must be correctly sized. {\bfseries 2}. block\+\_\+setup(...) should be called in the master preconditioner before this method is called. {\bfseries 3}. block\+\_\+setup(...) should be called in the corresponding subsidiary preconditioner after this method is called. \end{DoxyCompactList}\item 
virtual void \hyperlink{classoomph_1_1BlockPreconditioner_af704c4816469cef4fed9d35a9ad651ec}{block\+\_\+setup} ()
\begin{DoxyCompactList}\small\item\em Determine the size of the matrix blocks and setup the lookup schemes relating the global degrees of freedom with their \char`\"{}blocks\char`\"{} and their indices (row/column numbers) in those blocks. The distributions of the preconditioner and the internal blocks are automatically specified (and assumed to be uniform) at this stage. This method should be used if the identity dof-\/to-\/block mapping is okay, i.\+e. dof number 0 corresponds to block number 0 dof number 1 corresponds to block number 1 dof number 2 corresponds to block number 2 etc... \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a6b70b51b533002ff33a09013aa084e54}{block\+\_\+setup} (const \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \&dof\+\_\+to\+\_\+block\+\_\+map)
\begin{DoxyCompactList}\small\item\em Determine the size of the matrix blocks and setup the lookup schemes relating the global degrees of freedom with their \char`\"{}blocks\char`\"{} and their indices (row/column numbers) in those blocks. The distributions of the preconditioner and the blocks are automatically specified (and assumed to be uniform) at this stage. This method should be used if anything other than the identity dof-\/to-\/block mapping is required. The argument vector dof\+\_\+to\+\_\+block\+\_\+map should be of length ndof. The indices represents the dof types whilst the value represents the block types. In general we want\+: \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a72b4dbe167da59d9ba12c7eff97d77e6}{get\+\_\+block} (const unsigned \&\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}, const unsigned \&j, M\+A\+T\+R\+IX \&output\+\_\+matrix, const bool \&ignore\+\_\+replacement\+\_\+block=false) const
\begin{DoxyCompactList}\small\item\em Put block (i,j) into output\+\_\+matrix. This block accounts for any coarsening of dof types and any replaced dof-\/level blocks above this preconditioner. \end{DoxyCompactList}\item 
M\+A\+T\+R\+IX \hyperlink{classoomph_1_1BlockPreconditioner_a4c37f469646c689b5f1e79d0953bd588}{get\+\_\+block} (const unsigned \&\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}, const unsigned \&j, const bool \&ignore\+\_\+replacement\+\_\+block=false) const
\begin{DoxyCompactList}\small\item\em Return block (i,j). If the optional argument ignore\+\_\+replacement\+\_\+block is true, then any blocks in Replacement\+\_\+dof\+\_\+block\+\_\+pt will be ignored throughout the preconditioning hierarchy. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a748e2ad8836bc8edf5b9a42373a7ad61}{set\+\_\+master\+\_\+matrix\+\_\+pt} (M\+A\+T\+R\+IX $\ast$in\+\_\+matrix\+\_\+pt)
\begin{DoxyCompactList}\small\item\em Set the matrix\+\_\+pt in the upper-\/most master preconditioner. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a9dae351352d344321ea82999d7003e17}{get\+\_\+block\+\_\+other\+\_\+matrix} (const unsigned \&\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}, const unsigned \&j, M\+A\+T\+R\+IX $\ast$in\+\_\+matrix\+\_\+pt, M\+A\+T\+R\+IX \&output\+\_\+matrix)
\begin{DoxyCompactList}\small\item\em Get a block from a different matrix using the blocking scheme that has already been set up. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_af836bb2d105d80fb4bc584c2d99c06ed}{get\+\_\+blocks} (\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ bool $>$ \&required\+\_\+blocks, \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ M\+A\+T\+R\+IX $\ast$$>$ \&block\+\_\+matrix\+\_\+pt) const
\begin{DoxyCompactList}\small\item\em Get all the block matrices required by the block preconditioner. Takes a pointer to a matrix of bools that indicate if a specified sub-\/block is required for the preconditioning operation. Computes the required block matrices, and stores pointers to them in the matrix block\+\_\+matrix\+\_\+pt. If an entry in block\+\_\+matrix\+\_\+pt is equal to N\+U\+LL on return, that sub-\/block has not been requested and is therefore not available. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a314fc14d95f2833be66067cd5b45e093}{get\+\_\+dof\+\_\+level\+\_\+block} (const unsigned \&\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}, const unsigned \&j, M\+A\+T\+R\+IX \&output\+\_\+block, const bool \&ignore\+\_\+replacement\+\_\+block=false) const
\begin{DoxyCompactList}\small\item\em Gets dof-\/level block (i,j). If Replacement\+\_\+dof\+\_\+block\+\_\+pt(i,j) is not null, then the replacement block is returned via a deep copy. \end{DoxyCompactList}\item 
M\+A\+T\+R\+IX \hyperlink{classoomph_1_1BlockPreconditioner_a51636746e5921ee2845daf60b1c322dc}{get\+\_\+concatenated\+\_\+block} (const \hyperlink{classoomph_1_1VectorMatrix}{Vector\+Matrix}$<$ \hyperlink{classoomph_1_1BlockSelector}{Block\+Selector} $>$ \&selected\+\_\+block)
\begin{DoxyCompactList}\small\item\em Returns a concatenation of the block matrices specified by the argument selected\+\_\+block. The \hyperlink{classoomph_1_1VectorMatrix}{Vector\+Matrix} selected\+\_\+block must be correctly sized as it is used to determine the number of sub block matrices to concatenate. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_af9321cdab3f506ab95fe51cd9b93deab}{get\+\_\+concatenated\+\_\+block\+\_\+vector} (const \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \&block\+\_\+vec\+\_\+number, const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&v, \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&b)
\begin{DoxyCompactList}\small\item\em Takes the naturally ordered vector and extracts the blocks indicated by the block number (the values) in the \hyperlink{classoomph_1_1Vector}{Vector} block\+\_\+vec\+\_\+number all at once, then concatenates them without communication. Here, the values in block\+\_\+vec\+\_\+number is the block number in the current preconditioner. This is a non-\/const function because distributions may be created and stored in Auxiliary\+\_\+block\+\_\+distribution\+\_\+pt for future use. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a6d5106c0b9dca23aa1cc7f7fd8e696cb}{return\+\_\+concatenated\+\_\+block\+\_\+vector} (const \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \&block\+\_\+vec\+\_\+number, const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&b, \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&v) const
\begin{DoxyCompactList}\small\item\em Takes concatenated block ordered vector, b, and copies its entries to the appropriate entries in the naturally ordered vector, v. Here the values in block\+\_\+vec\+\_\+number indicates which blocks the vector b is a concatenation of. The block number are those in the current preconditioner. If the preconditioner is a subsidiary block preconditioner the other entries in v that are not associated with it are left alone. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_ad356946d5de4f0817cdf8793fa3cdc74}{get\+\_\+block\+\_\+vectors} (const \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \&block\+\_\+vec\+\_\+number, const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&v, \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ \&\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}) const
\begin{DoxyCompactList}\small\item\em Takes the naturally ordered vector and rearranges it into a vector of sub vectors corresponding to the blocks, so s\mbox{[}b\mbox{]}\mbox{[}i\mbox{]} contains the i-\/th entry in the vector associated with block b. Note\+: If the preconditioner is a subsidiary preconditioner then only the sub-\/vectors associated with the blocks of the subsidiary preconditioner will be included. Hence the length of v is \hyperlink{classoomph_1_1BlockPreconditioner_a3e5b553f65e6c25354a5c908d507e8ee}{master\+\_\+nrow()} whereas the total length of the s vectors is the sum of the lengths of the individual block vectors defined in block\+\_\+vec\+\_\+number. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a0517a3678def8b89ae69840345a8f838}{get\+\_\+block\+\_\+vectors} (const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&v, \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ \&\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}) const
\begin{DoxyCompactList}\small\item\em Takes the naturally ordered vector and rearranges it into a vector of sub vectors corresponding to the blocks, so s\mbox{[}b\mbox{]}\mbox{[}i\mbox{]} contains the i-\/th entry in the vector associated with block b. Note\+: If the preconditioner is a subsidiary preconditioner then only the sub-\/vectors associated with the blocks of the subsidiary preconditioner will be included. Hence the length of v is \hyperlink{classoomph_1_1BlockPreconditioner_a3e5b553f65e6c25354a5c908d507e8ee}{master\+\_\+nrow()} whereas the total length of the s vectors is Nrow. This is simply a wrapper around the other get\+\_\+block\+\_\+vectors(...) function where the block\+\_\+vec\+\_\+number \hyperlink{classoomph_1_1Vector}{Vector} is the identity, i.\+e. block\+\_\+vec\+\_\+number is \mbox{[}0, 1, ..., nblock\+\_\+types -\/ 1\mbox{]}. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a71d48d8a70151ef0febd4537a2214c53}{return\+\_\+block\+\_\+vectors} (const \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \&block\+\_\+vec\+\_\+number, const \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ \&\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}, \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&v) const
\begin{DoxyCompactList}\small\item\em Takes the vector of block vectors, s, and copies its entries into the naturally ordered vector, v. If this is a subsidiary block preconditioner only those entries in v that are associated with its blocks are affected. The block\+\_\+vec\+\_\+number indicates which block the vectors in s came from. The block number corresponds to the block numbers in this preconditioner. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a628f3ab6c3c41ccb449da642fb7e1feb}{return\+\_\+block\+\_\+vectors} (const \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ \&\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}, \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&v) const
\begin{DoxyCompactList}\small\item\em Takes the vector of block vectors, s, and copies its entries into the naturally ordered vector, v. If this is a subsidiary block preconditioner only those entries in v that are associated with its blocks are affected. The block\+\_\+vec\+\_\+number indicates which block the vectors in s came from. The block number corresponds to the block numbers in this preconditioner. This is simply a wrapper around the other return\+\_\+block\+\_\+vectors(...) function where the block\+\_\+vec\+\_\+number \hyperlink{classoomph_1_1Vector}{Vector} is the identity, i.\+e. block\+\_\+vec\+\_\+number is \mbox{[}0, 1, ..., nblock\+\_\+types -\/ 1\mbox{]}. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a7efc9f2f0209764902e4e45fcb2556d1}{get\+\_\+block\+\_\+vector} (const unsigned \&n, const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&v, \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&b) const
\begin{DoxyCompactList}\small\item\em Takes the naturally ordered vector, v and returns the n-\/th block vector, b. Here n is the block number in the current preconditioner. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a1dd4d3cd6b64fa64e1ff6730b0deecc7}{return\+\_\+block\+\_\+vector} (const unsigned \&n, const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&b, \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&v) const
\begin{DoxyCompactList}\small\item\em Takes the n-\/th block ordered vector, b, and copies its entries to the appropriate entries in the naturally ordered vector, v. Here n is the block number in the current block preconditioner. If the preconditioner is a subsidiary block preconditioner the other entries in v that are not associated with it are left alone. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_afd37323d2b5ba31e2d14f3ce8e6e474d}{get\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector} (const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&v, \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&w)
\begin{DoxyCompactList}\small\item\em Given the naturally ordered vector, v, return the vector rearranged in block order in w. This function calls get\+\_\+concatenated\+\_\+block\+\_\+vector(...) with the identity block mapping. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a98e920e003f085b02dbb30510fb23a0f}{return\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector} (const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&w, \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&v) const
\begin{DoxyCompactList}\small\item\em Takes the block ordered vector, w, and reorders it in natural order. Reordered vector is returned in v. Note\+: If the preconditioner is a subsidiary preconditioner then only the components of the vector associated with the blocks of the subsidiary preconditioner will be included. Hence the length of v is \hyperlink{classoomph_1_1BlockPreconditioner_a3e5b553f65e6c25354a5c908d507e8ee}{master\+\_\+nrow()} whereas that of the vector w is of length this-\/$>$\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_a7569556f14fd68b28508920e89bd5eee}{nrow()}. \end{DoxyCompactList}\item 
unsigned \hyperlink{classoomph_1_1BlockPreconditioner_a80808d42be8db74fd58af80b019bf317}{nblock\+\_\+types} () const
\begin{DoxyCompactList}\small\item\em Return the number of block types. \end{DoxyCompactList}\item 
unsigned \hyperlink{classoomph_1_1BlockPreconditioner_ab6cca480686ea8e44244ac60a0db23ba}{ndof\+\_\+types} () const
\begin{DoxyCompactList}\small\item\em Return the total number of D\+OF types. \end{DoxyCompactList}\item 
const \hyperlink{classoomph_1_1Mesh}{Mesh} $\ast$ \hyperlink{classoomph_1_1BlockPreconditioner_a3c0e92cb77c3e3179007fe9fd99b6428}{mesh\+\_\+pt} (const unsigned \&\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}) const
\begin{DoxyCompactList}\small\item\em Access to i-\/th mesh (of the various meshes that contain block preconditionable elements of the same number of dof type). \end{DoxyCompactList}\item 
unsigned \hyperlink{classoomph_1_1BlockPreconditioner_a193776a271f7c23d20d2102de0ff1cb9}{nmesh} () const
\begin{DoxyCompactList}\small\item\em Return the number of meshes in Mesh\+\_\+pt. \end{DoxyCompactList}\item 
int \hyperlink{classoomph_1_1BlockPreconditioner_a8a64cfc57ffd16b92ac78499de515138}{block\+\_\+number} (const unsigned \&i\+\_\+dof) const
\begin{DoxyCompactList}\small\item\em Return the block number corresponding to a global index i\+\_\+dof. \end{DoxyCompactList}\item 
int \hyperlink{classoomph_1_1BlockPreconditioner_a75742d54177935fb22e59d045209b11e}{index\+\_\+in\+\_\+block} (const unsigned \&i\+\_\+dof) const
\begin{DoxyCompactList}\small\item\em Given a global dof number, returns the index in the block it belongs to. This is the overall index, not local block (in parallel). \end{DoxyCompactList}\item 
const \hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution} $\ast$ \hyperlink{classoomph_1_1BlockPreconditioner_a77ac0b71404620e7be8b15ac2d588495}{block\+\_\+distribution\+\_\+pt} (const unsigned \&b) const
\begin{DoxyCompactList}\small\item\em Access function to the block distributions (const version). \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution} $\ast$ \hyperlink{classoomph_1_1BlockPreconditioner_ace28659098240524c431a41cf419d4ba}{block\+\_\+distribution\+\_\+pt} (const unsigned b)
\begin{DoxyCompactList}\small\item\em Access function to the block distributions (non-\/const version). \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution} $\ast$ \hyperlink{classoomph_1_1BlockPreconditioner_a1ee4a9fcf226e8c4438fb25747cb6e93}{dof\+\_\+block\+\_\+distribution\+\_\+pt} (const unsigned \&b)
\begin{DoxyCompactList}\small\item\em Access function to the dof-\/level block distributions. \end{DoxyCompactList}\item 
const \hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution} $\ast$ \hyperlink{classoomph_1_1BlockPreconditioner_a005d978655022d1a04da7397cf5d0e83}{master\+\_\+distribution\+\_\+pt} () const
\begin{DoxyCompactList}\small\item\em Access function to the distribution of the master preconditioner. If this preconditioner does not have a master preconditioner then the distribution of this preconditioner is returned. \end{DoxyCompactList}\item 
unsigned \hyperlink{classoomph_1_1BlockPreconditioner_a45509677ccef78be13b5e4485312ddc1}{ndof\+\_\+types\+\_\+in\+\_\+mesh} (const unsigned \&\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}) const
\begin{DoxyCompactList}\small\item\em Return the number of D\+OF types in mesh i. W\+A\+R\+N\+I\+NG\+: This should only be used by the upper-\/most master block preconditioner. An error is thrown is this function is called from a subsidiary preconditioner. They (and since every block preconditioner can in principle be used as s subsidiary preconditioner\+: all block preconditioners) should store local copies of \char`\"{}their meshes\char`\"{} (if they\textquotesingle{}re needed for anything) \end{DoxyCompactList}\item 
bool \hyperlink{classoomph_1_1BlockPreconditioner_a9ac4335ec07fc13f7bf1093fd0489c52}{is\+\_\+subsidiary\+\_\+block\+\_\+preconditioner} () const
\begin{DoxyCompactList}\small\item\em Return true if this preconditioner is a subsidiary preconditioner. \end{DoxyCompactList}\item 
bool \hyperlink{classoomph_1_1BlockPreconditioner_a804e1975f170d2ad941b3b7d2dd50407}{is\+\_\+master\+\_\+block\+\_\+preconditioner} () const
\begin{DoxyCompactList}\small\item\em Return true if this preconditioner is the master block preconditioner. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_ab36e905f7da268328709d62951d64ace}{set\+\_\+block\+\_\+output\+\_\+to\+\_\+files} (const std\+::string \&basefilename)
\begin{DoxyCompactList}\small\item\em Set the base part of the filename to output blocks to. If it is set then all blocks will be output at the end of block\+\_\+setup. If it is left empty nothing will be output. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a45b37f1934144d882831bf354f35d035}{disable\+\_\+block\+\_\+output\+\_\+to\+\_\+files} ()
\begin{DoxyCompactList}\small\item\em Turn off output of blocks (by clearing the basefilename string). \end{DoxyCompactList}\item 
bool \hyperlink{classoomph_1_1BlockPreconditioner_a0bd0ab19a7501b79c16c1283766f0abb}{block\+\_\+output\+\_\+on} () const
\begin{DoxyCompactList}\small\item\em Test if output of blocks is on or not. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_adec848504d36ebcd8e27ec60f52f75a6}{output\+\_\+blocks\+\_\+to\+\_\+files} (const std\+::string \&basefilename, const unsigned \&precision=8) const
\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_aa760ae71a5aae488547ccf721d412b1e}{post\+\_\+block\+\_\+matrix\+\_\+assembly\+\_\+partial\+\_\+clear} ()
\begin{DoxyCompactList}\small\item\em A helper method to reduce the memory requirements of block preconditioners. Once the methods get\+\_\+block(...), get\+\_\+blocks(...) and build\+\_\+preconditioner\+\_\+matrix(...) have been called in this and all subsidiary block preconditioners this method can be called to clean up. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1BlockPreconditioner}{Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$ $\ast$ \hyperlink{classoomph_1_1BlockPreconditioner_ab84701c65bdfd8d2c14611176e5e6209}{master\+\_\+block\+\_\+preconditioner\+\_\+pt} () const
\begin{DoxyCompactList}\small\item\em Access function to the master block preconditioner pt. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a7845d9301918e3f5cbecd729ec1e309b}{clear\+\_\+block\+\_\+preconditioner\+\_\+base} ()
\begin{DoxyCompactList}\small\item\em Clears all \hyperlink{classoomph_1_1BlockPreconditioner}{Block\+Preconditioner} data. Called by the destructor and the block\+\_\+setup(...) methods. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a289db176ccafcc3719367fa98340f94d}{document} ()
\begin{DoxyCompactList}\small\item\em debugging method to document the setup. Should only be called after block\+\_\+setup(...). \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a3a39411824a744d4569fe835dec13047}{doftype\+\_\+coarsen\+\_\+map\+\_\+fine} () const
\begin{DoxyCompactList}\small\item\em Access function for the Doftype\+\_\+coarsen\+\_\+map\+\_\+fine variable. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a433adda4f658cc7880121bf9ca4293c4}{get\+\_\+fine\+\_\+grain\+\_\+dof\+\_\+types\+\_\+in} (const unsigned \&\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}) const
\begin{DoxyCompactList}\small\item\em Returns the most fine grain dof types in a (possibly coarsened) dof type. \end{DoxyCompactList}\item 
unsigned \hyperlink{classoomph_1_1BlockPreconditioner_a50b76a374797805f64e2af34d581cdc2}{nfine\+\_\+grain\+\_\+dof\+\_\+types\+\_\+in} (const unsigned \&\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}) const
\begin{DoxyCompactList}\small\item\em Access function for the number of most fine grain dof types in a (possibly coarsened) dof type. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1MapMatrix}{Map\+Matrix}$<$ unsigned, \hyperlink{classoomph_1_1CRDoubleMatrix}{C\+R\+Double\+Matrix} $\ast$ $>$ \hyperlink{classoomph_1_1BlockPreconditioner_ac8ef0e69b712d9ab7902d277a14ed8f5}{replacement\+\_\+dof\+\_\+block\+\_\+pt} () const
\begin{DoxyCompactList}\small\item\em Access function to the replaced dof-\/level blocks. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_adbe1ae854ee9831649249d50162bb6a9}{setup\+\_\+matrix\+\_\+vector\+\_\+product} (\hyperlink{classoomph_1_1MatrixVectorProduct}{Matrix\+Vector\+Product} $\ast$matvec\+\_\+prod\+\_\+pt, \hyperlink{classoomph_1_1CRDoubleMatrix}{C\+R\+Double\+Matrix} $\ast$block\+\_\+pt, const \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \&block\+\_\+col\+\_\+indices)
\begin{DoxyCompactList}\small\item\em Setup a matrix vector product. matvec\+\_\+prod\+\_\+pt is a pointer to the \hyperlink{classoomph_1_1MatrixVectorProduct}{Matrix\+Vector\+Product}, block\+\_\+pt is a pointer to the block matrix, block\+\_\+col\+\_\+indices is a vector indicating which block indices does the R\+HS vector we want to multiply the matrix by. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a65059c036724814a0e490716fa6eaf0a}{setup\+\_\+matrix\+\_\+vector\+\_\+product} (\hyperlink{classoomph_1_1MatrixVectorProduct}{Matrix\+Vector\+Product} $\ast$matvec\+\_\+prod\+\_\+pt, \hyperlink{classoomph_1_1CRDoubleMatrix}{C\+R\+Double\+Matrix} $\ast$block\+\_\+pt, const unsigned \&block\+\_\+col\+\_\+index)
\begin{DoxyCompactList}\small\item\em Setup matrix vector product. This is simply a wrapper around the other setup\+\_\+matrix\+\_\+vector\+\_\+product function. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_afba1bef13cebdce65a0a49ff3381269a}{internal\+\_\+get\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector} (const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&v, \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&w) const
\begin{DoxyCompactList}\small\item\em Given the naturally ordered vector, v, return the vector rearranged in block order in w. This is a legacy function from the old block preconditioning framework. Kept alive in case it may be needed again. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a679a82067056628cc4bbc8bb68d088f2}{internal\+\_\+return\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector} (const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&w, \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&v) const
\begin{DoxyCompactList}\small\item\em Takes the block ordered vector, w, and reorders it in the natural order. Reordered vector is returned in v. Note\+: If the preconditioner is a subsidiary preconditioner then only the components of the vector associated with the blocks of the subsidiary preconditioner will be included. Hence the length of v is \hyperlink{classoomph_1_1BlockPreconditioner_a3e5b553f65e6c25354a5c908d507e8ee}{master\+\_\+nrow()} whereas that of the vector w is of length this-\/$>$\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_a7569556f14fd68b28508920e89bd5eee}{nrow()}. \end{DoxyCompactList}\item 
unsigned \hyperlink{classoomph_1_1BlockPreconditioner_a7c2b9ed482db072b0cabe5a51eb76efa}{internal\+\_\+nblock\+\_\+types} () const
\begin{DoxyCompactList}\small\item\em Return the number internal blocks. This should be the same as the number of internal dof types. Internally, the block preconditioning framework always work with the most fine grain blocks. I.\+e. it always deal with the most fine grain dof-\/level blocks. This allows for coarsening of dof types. When we extract a block, we look at the Block\+\_\+to\+\_\+dof\+\_\+map\+\_\+fine vector to find out which most fine grain dof types belongs to this block. \end{DoxyCompactList}\item 
unsigned \hyperlink{classoomph_1_1BlockPreconditioner_a4f3efe468cd6e133d6840ede8c3687b5}{internal\+\_\+ndof\+\_\+types} () const
\begin{DoxyCompactList}\small\item\em Return the number of internal dof types. This is the number of most fine grain dof types. The preconditioner writer should not have to concern him/her-\/self with the internal dof/block types. Thus this fuction is moved to private. We have kept this function alive since it it still used deep within the inner workings of the block preconditioning framework. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a04e260cc4160a952db2d410109fb2684}{internal\+\_\+return\+\_\+block\+\_\+vector} (const unsigned \&n, const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&b, \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&v) const
\begin{DoxyCompactList}\small\item\em Takes the n-\/th block ordered vector, b, and copies its entries to the appropriate entries in the naturally ordered vector, v. Here n is the block number in the current block preconditioner. If the preconditioner is a subsidiary block preconditioner the other entries in v that are not associated with it are left alone. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_ae3cf61f61e1aa50e2315e999827e7d59}{internal\+\_\+get\+\_\+block\+\_\+vector} (const unsigned \&n, const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&v, \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&b) const
\begin{DoxyCompactList}\small\item\em A helper function, takes the naturally ordered vector, v, and extracts the n-\/th block vector, b. Here n is the block number in the current preconditioner. N\+O\+TE\+: The ordering of the vector b is the same as the ordering of the block matrix from internal\+\_\+get\+\_\+block(...). \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_ace6e9dbdfe9a1c3571452e2cd6ec9780}{internal\+\_\+get\+\_\+block\+\_\+vectors} (const \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \&block\+\_\+vec\+\_\+number, const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&v, \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ \&\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}) const
\begin{DoxyCompactList}\small\item\em Takes the naturally ordered vector and rearranges it into a vector of sub vectors corresponding to the blocks, so s\mbox{[}b\mbox{]}\mbox{[}i\mbox{]} contains the i-\/th entry in the vector associated with block b. The block\+\_\+vec\+\_\+number indicates which blocks we want. These blocks and vectors are those corresponding to the internal blocks. Note\+: If the preconditioner is a subsidiary preconditioner then only the sub-\/vectors associated with the blocks of the subsidiary preconditioner will be included. Hence the length of v is \hyperlink{classoomph_1_1BlockPreconditioner_a3e5b553f65e6c25354a5c908d507e8ee}{master\+\_\+nrow()} whereas the total length of the s vectors is the sum of the Nrow of the sub vectors. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a0cde8af922cd8054dbf352527dd682b1}{internal\+\_\+get\+\_\+block\+\_\+vectors} (const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&v, \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ \&\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}) const
\begin{DoxyCompactList}\small\item\em A helper function, takes the naturally ordered vector and rearranges it into a vector of sub vectors corresponding to the blocks, so s\mbox{[}b\mbox{]}\mbox{[}i\mbox{]} contains the i-\/th entry in the vector associated with block b. The block\+\_\+vec\+\_\+number indicates which blocks we want. These blocks and vectors are those corresponding to the internal blocks. Note\+: If the preconditioner is a subsidiary preconditioner then only the sub-\/vectors associated with the blocks of the subsidiary preconditioner will be included. Hence the length of v is \hyperlink{classoomph_1_1BlockPreconditioner_a3e5b553f65e6c25354a5c908d507e8ee}{master\+\_\+nrow()} whereas the total length of the s vectors is the sum of the Nrow of the sub vectors. This is simply a wrapper around the other internal\+\_\+get\+\_\+block\+\_\+vectors(...) function with the identity block\+\_\+vec\+\_\+number vector. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a2ca7f125e50493073d116ba8da271af5}{internal\+\_\+return\+\_\+block\+\_\+vectors} (const \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \&block\+\_\+vec\+\_\+number, const \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ \&\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}, \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&v) const
\begin{DoxyCompactList}\small\item\em A helper function, takes the vector of block vectors, s, and copies its entries into the naturally ordered vector, v. If this is a subsidiary block preconditioner only those entries in v that are associated with its blocks are affected. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a9e2ce77e3efbcdd465f7ad7252936dfd}{internal\+\_\+return\+\_\+block\+\_\+vectors} (const \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ \&\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}, \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&v) const
\begin{DoxyCompactList}\small\item\em A helper function, takes the vector of block vectors, s, and copies its entries into the naturally ordered vector, v. If this is a subsidiary block preconditioner only those entries in v that are associated with its blocks are affected. This is simple a wrapper around the other internal\+\_\+return\+\_\+block\+\_\+vectors(...) function with the identity block\+\_\+vec\+\_\+number vector. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_abe001ffe270c96e761ec5205364976a7}{internal\+\_\+get\+\_\+block} (const unsigned \&\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}, const unsigned \&j, M\+A\+T\+R\+IX \&output\+\_\+block) const
\begin{DoxyCompactList}\small\item\em Gets block (i,j) from the matrix pointed to by Matrix\+\_\+pt and returns it in output\+\_\+block. This is associated with the internal blocks. Please use the other get\+\_\+block(...) function. \end{DoxyCompactList}\item 
int \hyperlink{classoomph_1_1BlockPreconditioner_af3eadb5d8d36200c4738537eac1647a6}{internal\+\_\+block\+\_\+number} (const unsigned \&i\+\_\+dof) const
\begin{DoxyCompactList}\small\item\em Return the block number corresponding to a global index i\+\_\+dof. This returns the block number corresponding to the internal blocks. What this means is that this returns the most fine grain dof-\/block number which this global index i\+\_\+dof corresponds to. Since the writer of the preconditioner does not need to care about the internal block types, this function should not be used and thus moved to private. This function should not be removed since it is still used deep within the inner workings of the block preconditioning framework. \end{DoxyCompactList}\item 
int \hyperlink{classoomph_1_1BlockPreconditioner_affcfd24c1ba15bf9cac712ffd46dc283}{internal\+\_\+index\+\_\+in\+\_\+block} (const unsigned \&i\+\_\+dof) const
\begin{DoxyCompactList}\small\item\em Return the index in the block corresponding to a global block number i\+\_\+dof. The index returned corresponds to the internal blocks, which is the most fine grain dof blocks. \end{DoxyCompactList}\item 
const \hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution} $\ast$ \hyperlink{classoomph_1_1BlockPreconditioner_a19f8ca9f40ab804262cf95c1d5eb598c}{internal\+\_\+block\+\_\+distribution\+\_\+pt} (const unsigned \&b) const
\begin{DoxyCompactList}\small\item\em Access function to the internal block distributions. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a9b3c4072be2bf4f0dfdd18f56a5d51bf}{insert\+\_\+auxiliary\+\_\+block\+\_\+distribution} (const \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \&block\+\_\+vec\+\_\+number, \hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution} $\ast$dist\+\_\+pt)
\begin{DoxyCompactList}\small\item\em insert a \hyperlink{classoomph_1_1Vector}{Vector$<$unsigned$>$} and Linear\+Algebra\+Distribution$\ast$ pair into Auxiliary\+\_\+block\+\_\+distribution\+\_\+pt. The Auxiliary\+\_\+block\+\_\+distribution\+\_\+pt should only contain pointers to distributions concatenated at this block level. We try to ensure this by checking if the block\+\_\+vec\+\_\+number vector is within the range \hyperlink{classoomph_1_1BlockPreconditioner_a80808d42be8db74fd58af80b019bf317}{nblock\+\_\+types()}. Of course, this does not guarantee correctness, but this is the least we can do. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a4d8ff67e34e85a71c0f9bb68c0b10496}{block\+\_\+matrix\+\_\+test} (const unsigned \&\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}, const unsigned \&j, const M\+A\+T\+R\+IX $\ast$block\+\_\+matrix\+\_\+pt) const
\begin{DoxyCompactList}\small\item\em Private helper function to check that every element in the block matrix (i,j) matches the corresponding element in the original matrix. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename my\+Type $>$ }\\int \hyperlink{classoomph_1_1BlockPreconditioner_acac55e8dea1a0f63fcf32b7b058b0979}{get\+\_\+index\+\_\+of\+\_\+value} (const \hyperlink{classoomph_1_1Vector}{Vector}$<$ my\+Type $>$ \&vec, const my\+Type val, const bool sorted=false) const
\begin{DoxyCompactList}\small\item\em Get the index of first occurrence of value in a vector. If the element does not exist, -\/1 is returned. The optional parameter indicates of the \hyperlink{classoomph_1_1Vector}{Vector} is sorted or not. Complexity\+: if the \hyperlink{classoomph_1_1Vector}{Vector} is sorted, then on average, logarithmic in the distance between first and last\+: Performs approximately log2(\+N)+2 element comparisons. Otherwise, up to linear in the distance between first and last\+: Compares elements until a match is found. \end{DoxyCompactList}\item 
{\footnotesize template$<$$>$ }\\void \hyperlink{classoomph_1_1BlockPreconditioner_a4c824a95d71ce68ee7e1acf6d45178e3}{internal\+\_\+get\+\_\+block} (const unsigned \&block\+\_\+i, const unsigned \&block\+\_\+j, \hyperlink{classoomph_1_1CRDoubleMatrix}{C\+R\+Double\+Matrix} \&output\+\_\+block) const
\begin{DoxyCompactList}\small\item\em Gets block (i,j) from the matrix pointed to by Matrix\+\_\+pt and returns it in output\+\_\+block. This is associated with the internal blocks. Please use the other get\+\_\+block(...) function. \end{DoxyCompactList}\item 
{\footnotesize template$<$$>$ }\\void \hyperlink{classoomph_1_1BlockPreconditioner_a27943f064e188f326f378ea02522c267}{get\+\_\+dof\+\_\+level\+\_\+block} (const unsigned \&block\+\_\+i, const unsigned \&block\+\_\+j, \hyperlink{classoomph_1_1CRDoubleMatrix}{C\+R\+Double\+Matrix} \&output\+\_\+block, const bool \&ignore\+\_\+replacement\+\_\+block) const
\begin{DoxyCompactList}\small\item\em Gets dof-\/level block (i,j). If Replacement\+\_\+dof\+\_\+block\+\_\+pt(i,j) is not null, then the replacement block is returned via a deep copy. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_ae055f998f6145656352aacac22e545ad}{set\+\_\+nmesh} (const unsigned \&n)
\begin{DoxyCompactList}\small\item\em Specify the number of meshes required by this block preconditioner. Note\+: elements in different meshes correspond to different types of D\+OF. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_af97821621b570d409e6662939e5f818d}{set\+\_\+mesh} (const unsigned \&\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}, const \hyperlink{classoomph_1_1Mesh}{Mesh} $\ast$const \hyperlink{classoomph_1_1BlockPreconditioner_a3c0e92cb77c3e3179007fe9fd99b6428}{mesh\+\_\+pt}, const bool \&allow\+\_\+multiple\+\_\+element\+\_\+type\+\_\+in\+\_\+mesh=false)
\begin{DoxyCompactList}\small\item\em Set the i-\/th mesh for this block preconditioner. Note\+: The method set\+\_\+nmesh(...) must be called before this method to specify the number of meshes. By default, it is assumed that each mesh only contains elements of the same type. This condition may be relaxed by setting the boolean allow\+\_\+multiple\+\_\+element\+\_\+type\+\_\+in\+\_\+mesh to true, however, each mesh must only contain elements with the same number of dof types. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1BlockPreconditioner_a8a0ae880f098d5b1e9df78fc74c31dbf}{set\+\_\+replacement\+\_\+dof\+\_\+block} (const unsigned \&block\+\_\+i, const unsigned \&block\+\_\+j, \hyperlink{classoomph_1_1CRDoubleMatrix}{C\+R\+Double\+Matrix} $\ast$\hyperlink{classoomph_1_1BlockPreconditioner_ac8ef0e69b712d9ab7902d277a14ed8f5}{replacement\+\_\+dof\+\_\+block\+\_\+pt})
\begin{DoxyCompactList}\small\item\em Set replacement dof-\/level blocks. Only dof-\/level blocks can be set. This is important due to how the dof type coarsening feature operates. \end{DoxyCompactList}\item 
bool \hyperlink{classoomph_1_1BlockPreconditioner_a6fb68db9e79048615984b005f8aa43b3}{any\+\_\+mesh\+\_\+distributed} () const
\begin{DoxyCompactList}\small\item\em Check if any of the meshes are distributed. This is equivalent to problem.\+distributed() and is used as a replacement. \end{DoxyCompactList}\item 
int \hyperlink{classoomph_1_1BlockPreconditioner_abb4dff3469cc6718103fddfdf3f3a7bb}{internal\+\_\+dof\+\_\+number} (const unsigned \&i\+\_\+dof) const
\begin{DoxyCompactList}\small\item\em Return the number of the block associated with global unknown i\+\_\+dof. If this preconditioner is a subsidiary block preconditioner then the block number in the subsidiary block preconditioner is returned. If a particular global D\+OF is not associated with this preconditioner then -\/1 is returned. \end{DoxyCompactList}\item 
unsigned \hyperlink{classoomph_1_1BlockPreconditioner_a1e0a33327b5042dfba04baf46c045373}{internal\+\_\+index\+\_\+in\+\_\+dof} (const unsigned \&i\+\_\+dof) const
\begin{DoxyCompactList}\small\item\em Return the row/column number of global unknown i\+\_\+dof within it\textquotesingle{}s block. \end{DoxyCompactList}\item 
unsigned \hyperlink{classoomph_1_1BlockPreconditioner_ac460225afc092cc5ed9d77acc6316536}{internal\+\_\+block\+\_\+dimension} (const unsigned \&b) const
\begin{DoxyCompactList}\small\item\em Return the number of degrees of freedom in block b. Note that if this preconditioner acts as a subsidiary preconditioner then b refers to the block number in the subsidiary preconditioner not the master block preconditioner. \end{DoxyCompactList}\item 
unsigned \hyperlink{classoomph_1_1BlockPreconditioner_abe03c970690224b46a29e55e16992dd7}{internal\+\_\+dof\+\_\+block\+\_\+dimension} (const unsigned \&\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}) const
\begin{DoxyCompactList}\small\item\em Return the size of the dof \char`\"{}block\char`\"{} i, i.\+e. how many degrees of freedom are associated with it. Note that if this preconditioner acts as a subsidiary preconditioner, then i refers to the block number in the subsidiary preconditioner not the master block preconditioner. \end{DoxyCompactList}\item 
unsigned \hyperlink{classoomph_1_1BlockPreconditioner_a3e5b553f65e6c25354a5c908d507e8ee}{master\+\_\+nrow} () const
\begin{DoxyCompactList}\small\item\em Return the number of dofs (number of rows or columns) in the overall problem. The prefix \char`\"{}master\+\_\+\char`\"{} is sort of redundant when used as a stand-\/alone block preconditioner but is required to avoid ambiguities. The latter is stored (and maintained) separately for each specific block preconditioner regardless of its role. \end{DoxyCompactList}\item 
unsigned \hyperlink{classoomph_1_1BlockPreconditioner_a7297e4d24c2c7ae7af6a9ad009669928}{internal\+\_\+master\+\_\+dof\+\_\+number} (const unsigned \&b) const
\begin{DoxyCompactList}\small\item\em Takes the block number within this preconditioner and returns the corresponding block number in the master preconditioner. If this preconditioner does not have a master block preconditioner then the block number passed is returned. \end{DoxyCompactList}\item 
const \hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution} $\ast$ \hyperlink{classoomph_1_1BlockPreconditioner_a3a16de88bd5369e729d761a6498fdd3f}{internal\+\_\+preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt} () const
\begin{DoxyCompactList}\small\item\em access function to the internal preconditioner matrix distribution pt. preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt always returns the concatenation of the internal block distributions. Since the writer of the preconditioner does not need to concern themselves with the internal dof/block, please use \hyperlink{classoomph_1_1BlockPreconditioner_a74eeff188f842dd8abdff1b7d9801d44}{preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt()}. \end{DoxyCompactList}\item 
const \hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution} $\ast$ \hyperlink{classoomph_1_1BlockPreconditioner_a74eeff188f842dd8abdff1b7d9801d44}{preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt} () const
\begin{DoxyCompactList}\small\item\em Access function to the preconditioner matrix distribution pointer. This is the concatenation of the block distributions with the identity ordering. I.\+e. if this preconditioner has three block types, with the three associated block distributions dist\+\_\+b0, dist\+\_\+b1 and dist\+\_\+b2, then this distribution is\+: Linear\+Algebra\+Distribution\+Helpers\+::concatenate(dist\+\_\+b0, dist\+\_\+b1, dist\+\_\+b2). \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classoomph_1_1MapMatrix}{Map\+Matrix}$<$ unsigned, \hyperlink{classoomph_1_1CRDoubleMatrix}{C\+R\+Double\+Matrix} $\ast$ $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a6816cfc4c9d74a39aca7401f751bb235}{Replacement\+\_\+dof\+\_\+block\+\_\+pt}
\begin{DoxyCompactList}\small\item\em The replacement dof-\/level blocks. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution} $\ast$ $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a59e83eca59e3cdc41a93668539e138f1}{Block\+\_\+distribution\+\_\+pt}
\begin{DoxyCompactList}\small\item\em The distribution for the blocks. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ $>$ \hyperlink{classoomph_1_1BlockPreconditioner_ae047d81b8179dfd09b70cf35f40f62ca}{Block\+\_\+to\+\_\+dof\+\_\+map\+\_\+coarse}
\begin{DoxyCompactList}\small\item\em Mapping for block types to dof types. These are the dof types the writer of the preconditioner expects. For the upper-\/most master block preconditioner, this would be the sum of the dof types in the meshes. For subsidiary block preconditioners, this is determined by the parent preconditioner when passing in the doftype\+\_\+coarsen\+\_\+map\+\_\+coarse vector in turn\+\_\+into\+\_\+subsidiary\+\_\+block\+\_\+preconditioner(...). \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a278946969944848b12bdc2ceaed91a07}{Block\+\_\+to\+\_\+dof\+\_\+map\+\_\+fine}
\begin{DoxyCompactList}\small\item\em Mapping for the block types to the most fine grain dof types. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a015ba85d839a80512c6c4065e39a3d4a}{Doftype\+\_\+coarsen\+\_\+map\+\_\+coarse}
\begin{DoxyCompactList}\small\item\em Mapping for dof types within T\+H\+IS precondition. This is usually passed down from the parent preconditioner. This list is used to tell which does types should be considered as a single dof type within this preconditioner. I.\+e. we \char`\"{}coarsen\char`\"{} the dof types. The values are local to this preconditioner, for example, even if the Doftype\+\_\+in\+\_\+master\+\_\+preconditioner\+\_\+coarse = \mbox{[}2,3,4\mbox{]}, the vector Doftype\+\_\+coarsen\+\_\+map\+\_\+coarse = \mbox{[}\mbox{[}0\mbox{]},\mbox{[}1,2\mbox{]}\mbox{]}, saying your local dof types 0 should be considered as dof type 0 and dof types 1 and 2 are considered as dof type 1. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ $>$ \hyperlink{classoomph_1_1BlockPreconditioner_aa4e2e47f537f9b6b4deae5792c493d65}{Doftype\+\_\+coarsen\+\_\+map\+\_\+fine}
\begin{DoxyCompactList}\small\item\em Mapping the dof types within this preconditioner. The values in here refers to the most grain dof types. This list is automatically generated either in block\+\_\+setup(...) (for the top-\/most preconditioner) or the turn\+\_\+into\+\_\+subsidiary\+\_\+block\+\_\+preconditioner(...) function. Please refer to the comment above Doftype\+\_\+coarsen\+\_\+map\+\_\+coarse for more details. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution} $\ast$ $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a38de6514d7065086335e0e6f60dc77a9}{Internal\+\_\+block\+\_\+distribution\+\_\+pt}
\begin{DoxyCompactList}\small\item\em Storage for the default distribution for each internal block. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution} $\ast$ $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a21867eb330dd1177c530a590ad1fa571}{Dof\+\_\+block\+\_\+distribution\+\_\+pt}
\begin{DoxyCompactList}\small\item\em Storage for the default distribution for each dof block at this level. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a2f3a3ac8c192a83facd5b560f017413e}{Allow\+\_\+multiple\+\_\+element\+\_\+type\+\_\+in\+\_\+mesh}
\begin{DoxyCompactList}\small\item\em \hyperlink{classoomph_1_1Vector}{Vector} of unsigned to indicate which meshes contain multiple element types. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ const \hyperlink{classoomph_1_1Mesh}{Mesh} $\ast$ $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a89adb506e8f9103c80b4b36cc309f536}{Mesh\+\_\+pt}
\begin{DoxyCompactList}\small\item\em \hyperlink{classoomph_1_1Vector}{Vector} of pointers to the meshes containing the elements used in the block preconditioner. Const pointers to prevent modification of the mesh by the preconditioner (this could be relaxed if needed). If this is a subsidiary preconditioner, then the information is looked up in the master preconditioner. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a43e9d73ff61daa00aea4e4deff0d6aff}{Ndof\+\_\+types\+\_\+in\+\_\+mesh}
\begin{DoxyCompactList}\small\item\em Storage for number of types of degree of freedom of the elements in each mesh. \end{DoxyCompactList}\item 
unsigned \hyperlink{classoomph_1_1BlockPreconditioner_a06c7426a2c8c096c8f4dc583444e0e0e}{Internal\+\_\+nblock\+\_\+types}
\begin{DoxyCompactList}\small\item\em Number of different block types in this preconditioner. Note that this information is maintained if used as a subsidiary or stand-\/alone block preconditioner, in the latter case it stores the number of blocks within the subsidiary preconditioner. \end{DoxyCompactList}\item 
unsigned \hyperlink{classoomph_1_1BlockPreconditioner_a3985436e4645c202eadd47a4f4f466e2}{Internal\+\_\+ndof\+\_\+types}
\begin{DoxyCompactList}\small\item\em Number of different D\+OF types in this preconditioner. Note that this information is maintained if used as a subsidiary or stand-\/alone block preconditioner, in the latter case it stores the number of dofs within the subsidiary preconditioner. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
bool \hyperlink{classoomph_1_1BlockPreconditioner_ae6ce543de76eedb34a2562eecceb222b}{Recursive\+\_\+debug\+\_\+flag}
\begin{DoxyCompactList}\small\item\em Debugging variable. Set true or false via the access functions turn\+\_\+on\+\_\+recursive\+\_\+debug\+\_\+flag(...) turn\+\_\+off\+\_\+recursive\+\_\+debug\+\_\+flag(...) These will turn on/off the debug flag up the hierarchy. \end{DoxyCompactList}\item 
bool \hyperlink{classoomph_1_1BlockPreconditioner_ab4647ea06ca7cf44c8de695ba35f3e97}{Debug\+\_\+flag}
\begin{DoxyCompactList}\small\item\em Debugging variable. Set true or false via the access functions turn\+\_\+on\+\_\+debug\+\_\+flag(...) turn\+\_\+off\+\_\+debug\+\_\+flag(...) \end{DoxyCompactList}\item 
std\+::map$<$ \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$, \hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution} $\ast$ $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a555ed672f4bcc8fcf72806154fd3ce0b}{Auxiliary\+\_\+block\+\_\+distribution\+\_\+pt}
\begin{DoxyCompactList}\small\item\em Stores any block-\/level distributions / concatenation of block-\/level distributions required. The first in the pair (\hyperlink{classoomph_1_1Vector}{Vector$<$unsigned$>$}) represents the block numbers of the distributions concatenated to get the second in the pair (Linear\+Algebra\+Distribution$\ast$). \end{DoxyCompactList}\item 
unsigned \hyperlink{classoomph_1_1BlockPreconditioner_a4aa232afd2a76adac97fb7d484a18c5e}{Nrow}
\begin{DoxyCompactList}\small\item\em Number of D\+O\+Fs (\# of rows or columns in the matrix) in this preconditioner. Note that this information is maintained if used as a subsidiary or stand-\/alone block preconditioner, in the latter case it stores the number of rows within the subsidiary preconditioner. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1BlockPreconditioner}{Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$ $\ast$ \hyperlink{classoomph_1_1BlockPreconditioner_a7759d79eefa52fb688caac08a4ff4894}{Master\+\_\+block\+\_\+preconditioner\+\_\+pt}
\begin{DoxyCompactList}\small\item\em If the block preconditioner is acting a subsidiary block preconditioner then a pointer to the master preconditioner is stored here. If the preconditioner does not have a master block preconditioner then this pointer remains null. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \hyperlink{classoomph_1_1BlockPreconditioner_ae8c06ce4f4baf8480a2f25b152031dad}{Doftype\+\_\+in\+\_\+master\+\_\+preconditioner\+\_\+fine}
\begin{DoxyCompactList}\small\item\em The map between the dof types in this preconditioner and the master preconditioner. If there is no master preconditioner it remains empty. This list contains the mapping for the underlying dof types. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a2d341eaf3312c7afcd663c7f4eba6fc2}{Doftype\+\_\+in\+\_\+master\+\_\+preconditioner\+\_\+coarse}
\begin{DoxyCompactList}\small\item\em The map between the dof types in this preconditioner and the master preconditioner. If there is no master preconditioner, it remains empty. This is the version for which the master preconditioner expects. The dof types in here may or may not be coarsened in the preconditioner above this one. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a0ad82070ce2f6cdfa9ea6c7226ea28af}{Index\+\_\+in\+\_\+dof\+\_\+block\+\_\+dense}
\begin{DoxyCompactList}\small\item\em {\bfseries This was uncommented} Presumably a non-\/distributed analogue of Index\+\_\+in\+\_\+dof\+\_\+block\+\_\+sparse. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a37b22a0a25030a4b08f2eaec261ae22b}{Dof\+\_\+number\+\_\+dense}
\begin{DoxyCompactList}\small\item\em \hyperlink{classoomph_1_1Vector}{Vector} to store the mapping from the global D\+OF number to its block. Empty if this preconditioner has a master preconditioner, in this case the information is obtained from the master preconditioner. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \hyperlink{classoomph_1_1BlockPreconditioner_ae7a8d4a769319bffc94432a3c4adf30b}{Global\+\_\+index\+\_\+sparse}
\begin{DoxyCompactList}\small\item\em For global indices outside of the range this-\/$>$\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_ab00a3919b8634c698749f14a4d92947d}{first\+\_\+row()} to this-\/$>$\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_ab00a3919b8634c698749f14a4d92947d}{first\+\_\+row()}+this-\/$>$\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_a9bd7e1d242c69a28da85a804a7717fce}{nrow\+\_\+local()}, the Index\+\_\+in\+\_\+dof\+\_\+block and Dof\+\_\+number are stored sparsely in the vectors\+: \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a06bef26c782dacdc6b5caa6419df73c9}{Index\+\_\+in\+\_\+dof\+\_\+block\+\_\+sparse}
\begin{DoxyCompactList}\small\item\em \hyperlink{classoomph_1_1Vector}{Vector} to store the mapping from the global D\+OF number to the index (row/column number) within its block (empty if this preconditioner has a master preconditioner as this information is obtained from the master preconditioner). Sparse version\+: for global indices outside of the range this-\/$>$\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_ab00a3919b8634c698749f14a4d92947d}{first\+\_\+row()} to this-\/$>$\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_ab00a3919b8634c698749f14a4d92947d}{first\+\_\+row()}+this-\/$>$\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_a9bd7e1d242c69a28da85a804a7717fce}{nrow\+\_\+local()}. The global index of an element in this vector is defined in Global\+\_\+index\+\_\+sparse. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a5a6adc0423ef4d31562d149324c4a679}{Dof\+\_\+number\+\_\+sparse}
\begin{DoxyCompactList}\small\item\em \hyperlink{classoomph_1_1Vector}{Vector} to store the mapping from the global D\+OF number to its block (empty if this preconditioner has a master preconditioner as this information is obtained from the master preconditioner). Sparse version\+: for global indices outside of the range this-\/$>$\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_ab00a3919b8634c698749f14a4d92947d}{first\+\_\+row()} to this-\/$>$\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_ab00a3919b8634c698749f14a4d92947d}{first\+\_\+row()}+this-\/$>$\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_a9bd7e1d242c69a28da85a804a7717fce}{nrow\+\_\+local()}. The global index of an element in this vector is defined in Global\+\_\+index\+\_\+sparse. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a55900a517c9e354b9fc49624483b7273}{Dof\+\_\+dimension}
\begin{DoxyCompactList}\small\item\em \hyperlink{classoomph_1_1Vector}{Vector} containing the size of each block, i.\+e. the number of global D\+O\+Fs associated with it. (Empty if this preconditioner has a master preconditioner as this information is obtain from the master preconditioner.) \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a79ea9c428aa8533c371ef3f0048a3a92}{Global\+\_\+index}
\begin{DoxyCompactList}\small\item\em Vectors of vectors for the mapping from block number and block row to global row number. Empty if this preconditioner has a master preconditioner as this information is obtain from the master preconditioner. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a61561c20a262195f1bdacda515a2394b}{Block\+\_\+number\+\_\+to\+\_\+dof\+\_\+number\+\_\+lookup}
\begin{DoxyCompactList}\small\item\em \hyperlink{classoomph_1_1Vector}{Vector} of vectors to store the mapping from block number to the D\+OF number (each element could be a vector because we allow multiple D\+O\+Fs types in a single block). \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \hyperlink{classoomph_1_1BlockPreconditioner_ae2f496bfa8307485101a3b8ac57e8c71}{Dof\+\_\+number\+\_\+to\+\_\+block\+\_\+number\+\_\+lookup}
\begin{DoxyCompactList}\small\item\em \hyperlink{classoomph_1_1Vector}{Vector} to the mapping from D\+OF number to block number. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a874cbe5520d546ee24004e229a48037e}{Ndof\+\_\+in\+\_\+block}
\begin{DoxyCompactList}\small\item\em Number of types of degree of freedom associated with each block. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ int $\ast$ $>$ \hyperlink{classoomph_1_1BlockPreconditioner_ac24e5ec4afe8904b3de7975ff0b2649d}{Rows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+block}
\begin{DoxyCompactList}\small\item\em The global rows to be sent of block b to processor p (matrix indexed \mbox{[}b\mbox{]}\mbox{[}p\mbox{]}). \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ unsigned $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a2080668f30dd3095ce8f2f791536f20e}{Nrows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+block}
\begin{DoxyCompactList}\small\item\em The number of global rows to be sent of block b to processor p (matrix indexed \mbox{[}b\mbox{]}\mbox{[}p\mbox{]}). \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ int $\ast$ $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a37d5573e5a7c9fba43f4364458e9075c}{Rows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+block}
\begin{DoxyCompactList}\small\item\em The block rows to be received from processor p for block b (matrix indexed \mbox{[}b\mbox{]}\mbox{[}p\mbox{]}). \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ unsigned $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a9ab1a931e617f04a50e8f24e75069628}{Nrows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+block}
\begin{DoxyCompactList}\small\item\em The number of block rows to be received from processor p for block b (matrix indexed \mbox{[}b\mbox{]}\mbox{[}p\mbox{]}). \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ int $\ast$ $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a47d5bfe73b47ab79504e878d372dd65f}{Rows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+ordered}
\begin{DoxyCompactList}\small\item\em The global rows to be sent to processor p for get\+\_\+block\+\_\+ordered\+\_\+... type methods. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \hyperlink{classoomph_1_1BlockPreconditioner_ae1a0fcd29c4939f668d2225b5d33caf5}{Nrows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+ordered}
\begin{DoxyCompactList}\small\item\em The number global rows to be sent to processor p for get\+\_\+block\+\_\+ordered\+\_\+... type methods. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ int $\ast$ $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a68830fbf53861f7b2e3e6a1b4843f6b2}{Rows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+ordered}
\begin{DoxyCompactList}\small\item\em The preconditioner rows to be received from processor p for get\+\_\+block\+\_\+ordered\+\_\+... type methods. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \hyperlink{classoomph_1_1BlockPreconditioner_a0265c19418608d4a525c159abe1b5c60}{Nrows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+ordered}
\begin{DoxyCompactList}\small\item\em The number of preconditioner rows to be received from processor p for get\+\_\+block\+\_\+ordered\+\_\+... type methods. \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution} $\ast$ \hyperlink{classoomph_1_1BlockPreconditioner_a58079eb938b4d3602d0819cf68b318c0}{Internal\+\_\+preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt}
\begin{DoxyCompactList}\small\item\em The distribution of the (internal) preconditioner matrix. This is formed by concatenating the distribution of the internal blocks. This is obsolete code, maintained for backwards compatibility. Below is the old comment\+: \end{DoxyCompactList}\item 
\hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution} $\ast$ \hyperlink{classoomph_1_1BlockPreconditioner_ad647cfa61939e3c118dcc2595a7f9240}{Preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt}
\begin{DoxyCompactList}\small\item\em The distribution of the preconditioner matrix. This is the concatenation of the block distribution. \end{DoxyCompactList}\item 
std\+::string \hyperlink{classoomph_1_1BlockPreconditioner_a915ff2775ccef6ac3dadf072566da9e7}{Output\+\_\+base\+\_\+filename}
\begin{DoxyCompactList}\small\item\em String giving the base of the files to write block data into. If empty then do not output blocks. Default is empty. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Static Private Attributes}
\begin{DoxyCompactItemize}
\item 
static bool \hyperlink{classoomph_1_1BlockPreconditioner_a6e6a40988711a64c622c2fd9104c56cf}{Run\+\_\+block\+\_\+matrix\+\_\+test} =false
\begin{DoxyCompactList}\small\item\em Static boolean to allow block\+\_\+matrix\+\_\+test(...) to be run. Defaults to false. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
\subsubsection*{template$<$typename M\+A\+T\+R\+IX$>$\newline
class oomph\+::\+Block\+Preconditioner$<$ M\+A\+T\+R\+I\+X $>$}

Block \hyperlink{classoomph_1_1Preconditioner}{Preconditioner} base class. The block structure of the overall problem is determined from the {\ttfamily \hyperlink{classoomph_1_1Mesh}{Mesh}\textquotesingle{}s} constituent elements. Each constituent element must be block-\/preconditionable -\/ i.\+e must implement the {\ttfamily Generalised\+Elements} functions {\ttfamily \hyperlink{classoomph_1_1BlockPreconditioner_ab6cca480686ea8e44244ac60a0db23ba}{ndof\+\_\+types()}} and get\+\_\+dof\+\_\+numbers\+\_\+for\+\_\+unknowns(...). A {\ttfamily \hyperlink{classoomph_1_1Problem}{Problem}} can have several {\ttfamily Meshes}, but each {\ttfamily \hyperlink{classoomph_1_1Mesh}{Mesh}} must contain elements with the same D\+OF types. The association between global degrees of freedom and their unique local dof numbers is therefore based on information provided by the elements. We refer to the local dof numbers provided by the elements as the elemental dof numbers.

By default each type of D\+OF is assumed to be unique type of block, but D\+OF types can be grouped together in a single block when block\+\_\+setup(...) is called.

This class can function in one of two ways. Either it acts as a stand-\/alone block preconditioner which computes and stores the association between global degrees of freedom and their unique global block numbers itself. Alternatively, the block preconditioner can act as a subsidiary block preconditioner within a (larger) master block preconditioner (pointed to by Master\+\_\+block\+\_\+preconditioner\+\_\+pt). The master block preconditioner must have an equal or greater number of block types. Examples are the F\+SI preconditioner which is the 3x3 \char`\"{}master block preconditioner\char`\"{} for the Navier-\/\+Stokes preconditioners which deals with the 2x2 fluid-\/blocks within the overall structure. In this case, {\bfseries only} the master block preconditioner computes and stores the master lookup schemes. All block preconditioners compute and store their own optimised lookup schemes.

In cases where a {\ttfamily \hyperlink{classoomph_1_1Problem}{Problem}} contains elements of different element types (e.\+g. fluid and solid elements in a fluid-\/structure interaction problem), access to the elements of the same type must be provided via pointers to (possibly auxiliary) {\ttfamily Meshes} that only contain elements of a single type. The block preconditioner will then create global block numbers by concatenating the block types. Consider, e.\+g. a fluid-\/structure interaction problem in which the first {\ttfamily \hyperlink{classoomph_1_1Mesh}{Mesh}} contains (fluid) elements whose degrees of freedom have been subdivided into types \char`\"{}0\char`\"{} (the velocity, say) and \char`\"{}1\char`\"{} (the pressure say), while the second {\ttfamily \hyperlink{classoomph_1_1Mesh}{Mesh}} contains (solid) elements whose degrees of freedom are the nodal displacements, classified as its type \char`\"{}0\char`\"{}. The combined block preconditioner then has three \char`\"{}block types\char`\"{}\+: \char`\"{}0\char`\"{}\+: Fluid velocity, \char`\"{}1\char`\"{}\+: Fluid pressure, \char`\"{}2\char`\"{}\+: Solid nodal positions. N\+O\+TE\+: currently this preconditioner uses the same communicator as the underlying problem. We may need to change this in the future. 

Definition at line 428 of file block\+\_\+preconditioner.\+h.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a74c4b4bef4371b72816631445689a2e6}\label{classoomph_1_1BlockPreconditioner_a74c4b4bef4371b72816631445689a2e6}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Block\+Preconditioner@{Block\+Preconditioner}}
\index{Block\+Preconditioner@{Block\+Preconditioner}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Block\+Preconditioner()}{BlockPreconditioner()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::\hyperlink{classoomph_1_1BlockPreconditioner}{Block\+Preconditioner} (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Constructor. 



Definition at line 433 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a78c33fc6f29101f027e22d64d158d567}\label{classoomph_1_1BlockPreconditioner_a78c33fc6f29101f027e22d64d158d567}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!````~Block\+Preconditioner@{$\sim$\+Block\+Preconditioner}}
\index{````~Block\+Preconditioner@{$\sim$\+Block\+Preconditioner}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{$\sim$\+Block\+Preconditioner()}{~BlockPreconditioner()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
virtual \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::$\sim$\hyperlink{classoomph_1_1BlockPreconditioner}{Block\+Preconditioner} (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Destructor. 



Definition at line 515 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a9652c8d4fb3cdbd8216f13c356324170}\label{classoomph_1_1BlockPreconditioner_a9652c8d4fb3cdbd8216f13c356324170}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Block\+Preconditioner@{Block\+Preconditioner}}
\index{Block\+Preconditioner@{Block\+Preconditioner}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Block\+Preconditioner()}{BlockPreconditioner()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::\hyperlink{classoomph_1_1BlockPreconditioner}{Block\+Preconditioner} (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1BlockPreconditioner}{Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$ \&}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Broken copy constructor. 



Definition at line 521 of file block\+\_\+preconditioner.\+h.



\subsection{Member Function Documentation}
\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a6fb68db9e79048615984b005f8aa43b3}\label{classoomph_1_1BlockPreconditioner_a6fb68db9e79048615984b005f8aa43b3}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!any\+\_\+mesh\+\_\+distributed@{any\+\_\+mesh\+\_\+distributed}}
\index{any\+\_\+mesh\+\_\+distributed@{any\+\_\+mesh\+\_\+distributed}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{any\+\_\+mesh\+\_\+distributed()}{any\_mesh\_distributed()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
bool \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::any\+\_\+mesh\+\_\+distributed (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}



Check if any of the meshes are distributed. This is equivalent to problem.\+distributed() and is used as a replacement. 



Definition at line 3070 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a77ac0b71404620e7be8b15ac2d588495}\label{classoomph_1_1BlockPreconditioner_a77ac0b71404620e7be8b15ac2d588495}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!block\+\_\+distribution\+\_\+pt@{block\+\_\+distribution\+\_\+pt}}
\index{block\+\_\+distribution\+\_\+pt@{block\+\_\+distribution\+\_\+pt}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{block\+\_\+distribution\+\_\+pt()}{block\_distribution\_pt()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
const \hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution}$\ast$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::block\+\_\+distribution\+\_\+pt (\begin{DoxyParamCaption}\item[{const unsigned \&}]{b }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Access function to the block distributions (const version). 



Definition at line 1928 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_ace28659098240524c431a41cf419d4ba}\label{classoomph_1_1BlockPreconditioner_ace28659098240524c431a41cf419d4ba}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!block\+\_\+distribution\+\_\+pt@{block\+\_\+distribution\+\_\+pt}}
\index{block\+\_\+distribution\+\_\+pt@{block\+\_\+distribution\+\_\+pt}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{block\+\_\+distribution\+\_\+pt()}{block\_distribution\_pt()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution}$\ast$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::block\+\_\+distribution\+\_\+pt (\begin{DoxyParamCaption}\item[{const unsigned}]{b }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Access function to the block distributions (non-\/const version). 



Definition at line 1959 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a4d8ff67e34e85a71c0f9bb68c0b10496}\label{classoomph_1_1BlockPreconditioner_a4d8ff67e34e85a71c0f9bb68c0b10496}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!block\+\_\+matrix\+\_\+test@{block\+\_\+matrix\+\_\+test}}
\index{block\+\_\+matrix\+\_\+test@{block\+\_\+matrix\+\_\+test}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{block\+\_\+matrix\+\_\+test()}{block\_matrix\_test()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::block\+\_\+matrix\+\_\+test (\begin{DoxyParamCaption}\item[{const unsigned \&}]{i,  }\item[{const unsigned \&}]{j,  }\item[{const M\+A\+T\+R\+IX $\ast$}]{block\+\_\+matrix\+\_\+pt }\end{DoxyParamCaption}) const}



Private helper function to check that every element in the block matrix (i,j) matches the corresponding element in the original matrix. 

test function to check that every element in the block matrix (block\+\_\+i,block\+\_\+j) matches the corresponding element in the original matrix 

Definition at line 5753 of file block\+\_\+preconditioner.\+cc.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a8a64cfc57ffd16b92ac78499de515138}\label{classoomph_1_1BlockPreconditioner_a8a64cfc57ffd16b92ac78499de515138}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!block\+\_\+number@{block\+\_\+number}}
\index{block\+\_\+number@{block\+\_\+number}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{block\+\_\+number()}{block\_number()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
int \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::block\+\_\+number (\begin{DoxyParamCaption}\item[{const unsigned \&}]{i\+\_\+dof }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Return the block number corresponding to a global index i\+\_\+dof. 



Definition at line 1847 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a0bd0ab19a7501b79c16c1283766f0abb}\label{classoomph_1_1BlockPreconditioner_a0bd0ab19a7501b79c16c1283766f0abb}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!block\+\_\+output\+\_\+on@{block\+\_\+output\+\_\+on}}
\index{block\+\_\+output\+\_\+on@{block\+\_\+output\+\_\+on}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{block\+\_\+output\+\_\+on()}{block\_output\_on()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
bool \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::block\+\_\+output\+\_\+on (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Test if output of blocks is on or not. 



Definition at line 2119 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_af704c4816469cef4fed9d35a9ad651ec}\label{classoomph_1_1BlockPreconditioner_af704c4816469cef4fed9d35a9ad651ec}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!block\+\_\+setup@{block\+\_\+setup}}
\index{block\+\_\+setup@{block\+\_\+setup}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{block\+\_\+setup()}{block\_setup()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX $>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::block\+\_\+setup (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Determine the size of the matrix blocks and setup the lookup schemes relating the global degrees of freedom with their \char`\"{}blocks\char`\"{} and their indices (row/column numbers) in those blocks. The distributions of the preconditioner and the internal blocks are automatically specified (and assumed to be uniform) at this stage. This method should be used if the identity dof-\/to-\/block mapping is okay, i.\+e. dof number 0 corresponds to block number 0 dof number 1 corresponds to block number 1 dof number 2 corresponds to block number 2 etc... 

Determine the size of the matrix blocks and setup the lookup schemes relating the global degrees of freedom with their \char`\"{}blocks\char`\"{} and their indices (row/column numbers) in those blocks. The distributions of the preconditioner and the blocks are automatically specified (and assumed to be uniform) at this stage. This method should be used if each D\+OF type corresponds to a unique block type. 

Definition at line 2437 of file block\+\_\+preconditioner.\+cc.



Referenced by oomph\+::\+General\+Purpose\+Block\+Preconditioner$<$ M\+A\+T\+R\+I\+X $>$\+::gp\+\_\+preconditioner\+\_\+block\+\_\+setup().

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a6b70b51b533002ff33a09013aa084e54}\label{classoomph_1_1BlockPreconditioner_a6b70b51b533002ff33a09013aa084e54}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!block\+\_\+setup@{block\+\_\+setup}}
\index{block\+\_\+setup@{block\+\_\+setup}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{block\+\_\+setup()}{block\_setup()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX $>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::block\+\_\+setup (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \&}]{dof\+\_\+to\+\_\+block\+\_\+map\+\_\+in }\end{DoxyParamCaption})}



Determine the size of the matrix blocks and setup the lookup schemes relating the global degrees of freedom with their \char`\"{}blocks\char`\"{} and their indices (row/column numbers) in those blocks. The distributions of the preconditioner and the blocks are automatically specified (and assumed to be uniform) at this stage. This method should be used if anything other than the identity dof-\/to-\/block mapping is required. The argument vector dof\+\_\+to\+\_\+block\+\_\+map should be of length ndof. The indices represents the dof types whilst the value represents the block types. In general we want\+: 

dof\+\_\+to\+\_\+block\+\_\+map\mbox{[}dof\+\_\+number\mbox{]} = block\+\_\+number.

Determine the size of the matrix blocks and setup the lookup schemes relating the global degrees of freedom with their \char`\"{}blocks\char`\"{} and their indices (row/column numbers) in those blocks. The distributions of the preconditioner and the blocks are automatically specified (and assumed to be uniform) at this stage. This method should be used if any block contains more than one type of D\+OF. The argument vector dof\+\_\+to\+\_\+block\+\_\+map should be of length ndof. Each element should contain an integer indicating the block number corresponding to that type of D\+OF. 

Definition at line 56 of file block\+\_\+preconditioner.\+cc.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a7845d9301918e3f5cbecd729ec1e309b}\label{classoomph_1_1BlockPreconditioner_a7845d9301918e3f5cbecd729ec1e309b}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!clear\+\_\+block\+\_\+preconditioner\+\_\+base@{clear\+\_\+block\+\_\+preconditioner\+\_\+base}}
\index{clear\+\_\+block\+\_\+preconditioner\+\_\+base@{clear\+\_\+block\+\_\+preconditioner\+\_\+base}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{clear\+\_\+block\+\_\+preconditioner\+\_\+base()}{clear\_block\_preconditioner\_base()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::clear\+\_\+block\+\_\+preconditioner\+\_\+base (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Clears all \hyperlink{classoomph_1_1BlockPreconditioner}{Block\+Preconditioner} data. Called by the destructor and the block\+\_\+setup(...) methods. 



Definition at line 2189 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a45b37f1934144d882831bf354f35d035}\label{classoomph_1_1BlockPreconditioner_a45b37f1934144d882831bf354f35d035}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!disable\+\_\+block\+\_\+output\+\_\+to\+\_\+files@{disable\+\_\+block\+\_\+output\+\_\+to\+\_\+files}}
\index{disable\+\_\+block\+\_\+output\+\_\+to\+\_\+files@{disable\+\_\+block\+\_\+output\+\_\+to\+\_\+files}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{disable\+\_\+block\+\_\+output\+\_\+to\+\_\+files()}{disable\_block\_output\_to\_files()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::disable\+\_\+block\+\_\+output\+\_\+to\+\_\+files (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Turn off output of blocks (by clearing the basefilename string). 



Definition at line 2113 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a289db176ccafcc3719367fa98340f94d}\label{classoomph_1_1BlockPreconditioner_a289db176ccafcc3719367fa98340f94d}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!document@{document}}
\index{document@{document}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{document()}{document()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::document (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



debugging method to document the setup. Should only be called after block\+\_\+setup(...). 



Definition at line 2301 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a1ee4a9fcf226e8c4438fb25747cb6e93}\label{classoomph_1_1BlockPreconditioner_a1ee4a9fcf226e8c4438fb25747cb6e93}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!dof\+\_\+block\+\_\+distribution\+\_\+pt@{dof\+\_\+block\+\_\+distribution\+\_\+pt}}
\index{dof\+\_\+block\+\_\+distribution\+\_\+pt@{dof\+\_\+block\+\_\+distribution\+\_\+pt}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{dof\+\_\+block\+\_\+distribution\+\_\+pt()}{dof\_block\_distribution\_pt()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution}$\ast$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::dof\+\_\+block\+\_\+distribution\+\_\+pt (\begin{DoxyParamCaption}\item[{const unsigned \&}]{b }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Access function to the dof-\/level block distributions. 



Definition at line 1990 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a3a39411824a744d4569fe835dec13047}\label{classoomph_1_1BlockPreconditioner_a3a39411824a744d4569fe835dec13047}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!doftype\+\_\+coarsen\+\_\+map\+\_\+fine@{doftype\+\_\+coarsen\+\_\+map\+\_\+fine}}
\index{doftype\+\_\+coarsen\+\_\+map\+\_\+fine@{doftype\+\_\+coarsen\+\_\+map\+\_\+fine}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{doftype\+\_\+coarsen\+\_\+map\+\_\+fine()}{doftype\_coarsen\_map\_fine()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$\hyperlink{classoomph_1_1Vector}{Vector}$<$unsigned$>$ $>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::doftype\+\_\+coarsen\+\_\+map\+\_\+fine (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Access function for the Doftype\+\_\+coarsen\+\_\+map\+\_\+fine variable. 



Definition at line 2364 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a72b4dbe167da59d9ba12c7eff97d77e6}\label{classoomph_1_1BlockPreconditioner_a72b4dbe167da59d9ba12c7eff97d77e6}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!get\+\_\+block@{get\+\_\+block}}
\index{get\+\_\+block@{get\+\_\+block}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{get\+\_\+block()}{get\_block()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::get\+\_\+block (\begin{DoxyParamCaption}\item[{const unsigned \&}]{i,  }\item[{const unsigned \&}]{j,  }\item[{M\+A\+T\+R\+IX \&}]{output\+\_\+matrix,  }\item[{const bool \&}]{ignore\+\_\+replacement\+\_\+block = {\ttfamily false} }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Put block (i,j) into output\+\_\+matrix. This block accounts for any coarsening of dof types and any replaced dof-\/level blocks above this preconditioner. 



Definition at line 692 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a4c37f469646c689b5f1e79d0953bd588}\label{classoomph_1_1BlockPreconditioner_a4c37f469646c689b5f1e79d0953bd588}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!get\+\_\+block@{get\+\_\+block}}
\index{get\+\_\+block@{get\+\_\+block}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{get\+\_\+block()}{get\_block()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
M\+A\+T\+R\+IX \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::get\+\_\+block (\begin{DoxyParamCaption}\item[{const unsigned \&}]{i,  }\item[{const unsigned \&}]{j,  }\item[{const bool \&}]{ignore\+\_\+replacement\+\_\+block = {\ttfamily false} }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Return block (i,j). If the optional argument ignore\+\_\+replacement\+\_\+block is true, then any blocks in Replacement\+\_\+dof\+\_\+block\+\_\+pt will be ignored throughout the preconditioning hierarchy. 



Definition at line 1004 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_afd37323d2b5ba31e2d14f3ce8e6e474d}\label{classoomph_1_1BlockPreconditioner_afd37323d2b5ba31e2d14f3ce8e6e474d}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!get\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector@{get\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector}}
\index{get\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector@{get\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{get\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector()}{get\_block\_ordered\_preconditioner\_vector()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX $>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::get\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{v,  }\item[{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{w }\end{DoxyParamCaption})}



Given the naturally ordered vector, v, return the vector rearranged in block order in w. This function calls get\+\_\+concatenated\+\_\+block\+\_\+vector(...) with the identity block mapping. 

This function has been re-\/written to work with the new dof type coarsening feature. The old function is kept alive in internal\+\_\+get\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector(...) and is moved to the private section of the code. The differences between the two are\+:

1) This function extracts all the block vectors (in one go) via the function internal\+\_\+get\+\_\+block\+\_\+vectors(...), and concatenates them.

2) The old function makes use of the variables ending in \char`\"{}get\+\_\+ordered\char`\"{}, thus is slightly more efficient since it does not have to concatenate any block vectors.

3) The old function no longer respect the new indirections if dof types have been coarsened.

4) This function extracts the most fine grain dof-\/level vectors and concatenates them. These dof-\/level vectors respect the re-\/ordering caused by the coarsening of dof types. The overhead associated with concatenating Double\+Vectors without communication is very small.

This function should be used. 

Definition at line 4736 of file block\+\_\+preconditioner.\+cc.



Referenced by oomph\+::\+Block\+Preconditioner$<$ C\+R\+Double\+Matrix $>$\+::internal\+\_\+get\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector().

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a9dae351352d344321ea82999d7003e17}\label{classoomph_1_1BlockPreconditioner_a9dae351352d344321ea82999d7003e17}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!get\+\_\+block\+\_\+other\+\_\+matrix@{get\+\_\+block\+\_\+other\+\_\+matrix}}
\index{get\+\_\+block\+\_\+other\+\_\+matrix@{get\+\_\+block\+\_\+other\+\_\+matrix}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{get\+\_\+block\+\_\+other\+\_\+matrix()}{get\_block\_other\_matrix()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::get\+\_\+block\+\_\+other\+\_\+matrix (\begin{DoxyParamCaption}\item[{const unsigned \&}]{i,  }\item[{const unsigned \&}]{j,  }\item[{M\+A\+T\+R\+IX $\ast$}]{in\+\_\+matrix\+\_\+pt,  }\item[{M\+A\+T\+R\+IX \&}]{output\+\_\+matrix }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Get a block from a different matrix using the blocking scheme that has already been set up. 



Definition at line 1028 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a7efc9f2f0209764902e4e45fcb2556d1}\label{classoomph_1_1BlockPreconditioner_a7efc9f2f0209764902e4e45fcb2556d1}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!get\+\_\+block\+\_\+vector@{get\+\_\+block\+\_\+vector}}
\index{get\+\_\+block\+\_\+vector@{get\+\_\+block\+\_\+vector}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{get\+\_\+block\+\_\+vector()}{get\_block\_vector()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX $>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::get\+\_\+block\+\_\+vector (\begin{DoxyParamCaption}\item[{const unsigned \&}]{n,  }\item[{const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{v,  }\item[{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{b }\end{DoxyParamCaption}) const}



Takes the naturally ordered vector, v and returns the n-\/th block vector, b. Here n is the block number in the current preconditioner. 



Definition at line 4136 of file block\+\_\+preconditioner.\+cc.



Referenced by oomph\+::\+Block\+Preconditioner$<$ C\+R\+Double\+Matrix $>$\+::internal\+\_\+get\+\_\+block\+\_\+vector().

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_ad356946d5de4f0817cdf8793fa3cdc74}\label{classoomph_1_1BlockPreconditioner_ad356946d5de4f0817cdf8793fa3cdc74}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!get\+\_\+block\+\_\+vectors@{get\+\_\+block\+\_\+vectors}}
\index{get\+\_\+block\+\_\+vectors@{get\+\_\+block\+\_\+vectors}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{get\+\_\+block\+\_\+vectors()}{get\_block\_vectors()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX $>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::get\+\_\+block\+\_\+vectors (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \&}]{block\+\_\+vec\+\_\+number,  }\item[{const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{v,  }\item[{\hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ \&}]{s }\end{DoxyParamCaption}) const}



Takes the naturally ordered vector and rearranges it into a vector of sub vectors corresponding to the blocks, so s\mbox{[}b\mbox{]}\mbox{[}i\mbox{]} contains the i-\/th entry in the vector associated with block b. Note\+: If the preconditioner is a subsidiary preconditioner then only the sub-\/vectors associated with the blocks of the subsidiary preconditioner will be included. Hence the length of v is \hyperlink{classoomph_1_1BlockPreconditioner_a3e5b553f65e6c25354a5c908d507e8ee}{master\+\_\+nrow()} whereas the total length of the s vectors is the sum of the lengths of the individual block vectors defined in block\+\_\+vec\+\_\+number. 



Definition at line 2917 of file block\+\_\+preconditioner.\+cc.



Referenced by oomph\+::\+Block\+Preconditioner$<$ C\+R\+Double\+Matrix $>$\+::get\+\_\+block\+\_\+vectors(), and oomph\+::\+Block\+Preconditioner$<$ C\+R\+Double\+Matrix $>$\+::return\+\_\+concatenated\+\_\+block\+\_\+vector().

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a0517a3678def8b89ae69840345a8f838}\label{classoomph_1_1BlockPreconditioner_a0517a3678def8b89ae69840345a8f838}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!get\+\_\+block\+\_\+vectors@{get\+\_\+block\+\_\+vectors}}
\index{get\+\_\+block\+\_\+vectors@{get\+\_\+block\+\_\+vectors}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{get\+\_\+block\+\_\+vectors()}{get\_block\_vectors()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX $>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::get\+\_\+block\+\_\+vectors (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{v,  }\item[{\hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ \&}]{s }\end{DoxyParamCaption}) const}



Takes the naturally ordered vector and rearranges it into a vector of sub vectors corresponding to the blocks, so s\mbox{[}b\mbox{]}\mbox{[}i\mbox{]} contains the i-\/th entry in the vector associated with block b. Note\+: If the preconditioner is a subsidiary preconditioner then only the sub-\/vectors associated with the blocks of the subsidiary preconditioner will be included. Hence the length of v is \hyperlink{classoomph_1_1BlockPreconditioner_a3e5b553f65e6c25354a5c908d507e8ee}{master\+\_\+nrow()} whereas the total length of the s vectors is Nrow. This is simply a wrapper around the other get\+\_\+block\+\_\+vectors(...) function where the block\+\_\+vec\+\_\+number \hyperlink{classoomph_1_1Vector}{Vector} is the identity, i.\+e. block\+\_\+vec\+\_\+number is \mbox{[}0, 1, ..., nblock\+\_\+types -\/ 1\mbox{]}. 



Definition at line 3085 of file block\+\_\+preconditioner.\+cc.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_af836bb2d105d80fb4bc584c2d99c06ed}\label{classoomph_1_1BlockPreconditioner_af836bb2d105d80fb4bc584c2d99c06ed}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!get\+\_\+blocks@{get\+\_\+blocks}}
\index{get\+\_\+blocks@{get\+\_\+blocks}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{get\+\_\+blocks()}{get\_blocks()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::get\+\_\+blocks (\begin{DoxyParamCaption}\item[{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ bool $>$ \&}]{required\+\_\+blocks,  }\item[{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ M\+A\+T\+R\+IX $\ast$$>$ \&}]{block\+\_\+matrix\+\_\+pt }\end{DoxyParamCaption}) const}



Get all the block matrices required by the block preconditioner. Takes a pointer to a matrix of bools that indicate if a specified sub-\/block is required for the preconditioning operation. Computes the required block matrices, and stores pointers to them in the matrix block\+\_\+matrix\+\_\+pt. If an entry in block\+\_\+matrix\+\_\+pt is equal to N\+U\+LL on return, that sub-\/block has not been requested and is therefore not available. 

W\+A\+R\+N\+I\+NG\+: the matrix pointers are created using new so you must delete them all manually!

W\+A\+R\+N\+I\+NG 2\+: the matrix pointers in block\+\_\+matrix\+\_\+pt M\+U\+ST be null because Richard in all his wisdom decided to call delete on any non-\/null pointers. Presumably to avoid fixing his memory leaks properly...

Get the block matrices required for the block preconditioner. Takes a pointer to a matrix of bools that indicate if a specified sub-\/block is required for the preconditioning operation. Computes the required block matrices, and stores pointers to them in the matrix block\+\_\+matrix\+\_\+pt. If an entry in block\+\_\+matrix\+\_\+pt is equal to N\+U\+LL that sub-\/block has not been requested and is therefore not available. 

Definition at line 2495 of file block\+\_\+preconditioner.\+cc.



Referenced by oomph\+::\+Block\+Preconditioner$<$ C\+R\+Double\+Matrix $>$\+::block\+\_\+setup().

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a51636746e5921ee2845daf60b1c322dc}\label{classoomph_1_1BlockPreconditioner_a51636746e5921ee2845daf60b1c322dc}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!get\+\_\+concatenated\+\_\+block@{get\+\_\+concatenated\+\_\+block}}
\index{get\+\_\+concatenated\+\_\+block@{get\+\_\+concatenated\+\_\+block}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{get\+\_\+concatenated\+\_\+block()}{get\_concatenated\_block()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
M\+A\+T\+R\+IX \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::get\+\_\+concatenated\+\_\+block (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1VectorMatrix}{Vector\+Matrix}$<$ \hyperlink{classoomph_1_1BlockSelector}{Block\+Selector} $>$ \&}]{selected\+\_\+block }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Returns a concatenation of the block matrices specified by the argument selected\+\_\+block. The \hyperlink{classoomph_1_1VectorMatrix}{Vector\+Matrix} selected\+\_\+block must be correctly sized as it is used to determine the number of sub block matrices to concatenate. 

For each entry in the \hyperlink{classoomph_1_1VectorMatrix}{Vector\+Matrix}, the following variables must correctly set\+: \hyperlink{classoomph_1_1BlockSelector_ae48060783b1f4744b14a4477190e205e}{Block\+Selector\+::\+Row\+\_\+index} -\/ Refers to the row index of the block. \hyperlink{classoomph_1_1BlockSelector_adac07173a35f4f7f28e67b4b62306777}{Block\+Selector\+::\+Column\+\_\+index} -\/ Refers to the column index of the block. \hyperlink{classoomph_1_1BlockSelector_ad5b7ec23096f89f3d0cceed70ca07fdb}{Block\+Selector\+::\+Wanted} -\/ Do we want the block? \hyperlink{classoomph_1_1BlockSelector_ad18ae2223ddfb1a1b61937930357bfc8}{Block\+Selector\+::\+Replacement\+\_\+block\+\_\+pt} -\/ If not null, this block will be used instead of get\+\_\+block(\+Row\+\_\+index,\+Column\+\_\+index).

For example, assume that we have a matrix of the following blocking\+: 0 1 2 3 4 $\vert$ a $\vert$ b $\vert$ c $\vert$ d $\vert$ e $\vert$ --$\vert$---$\vert$---$\vert$---$\vert$---$\vert$---$\vert$ \tabulinesep=1mm
\begin{longtabu} spread 0pt [c]{*{6}{|X[-1]}|}
\hline
\rowcolor{\tableheadbgcolor}\textbf{ 0 a }&\textbf{ }&\textbf{ }&\textbf{ }&\textbf{ }&\textbf{ }\\\cline{1-6}
\endfirsthead
\hline
\endfoot
\hline
\rowcolor{\tableheadbgcolor}\textbf{ 0 a }&\textbf{ }&\textbf{ }&\textbf{ }&\textbf{ }&\textbf{ }\\\cline{1-6}
\endhead
1 b &&&&&\\\cline{1-6}
--&---&---&---&---&--- \\\cline{1-6}
2 c &&&&&\\\cline{1-6}
--&---&---&---&---&--- \\\cline{1-6}
3 d &&&&&\\\cline{1-6}
--&---&---&---&---&--- \\\cline{1-6}
4 e &&&&&\\\cline{1-6}
--&---&---&---&---&--- \\\cline{1-6}
\end{longtabu}
If we want a block matrix corresponding to the concatenation of the blocks \mbox{[}(a,d), (a,e) , (b,e)$\ast$ \mbox{]} where top left and top right blocks comes from the function get\+\_\+block(...), the bottom left entry is empty, and the bottom right is a modified block.

Then we create a \hyperlink{classoomph_1_1VectorMatrix}{Vector\+Matrix} of size 2 by 2 Vector\+Matrix$<$\+Block\+Selector$>$ selected\+\_\+block(2,2);

In the \mbox{[}0\mbox{]}\mbox{[}0\mbox{]} entry\+: row index is 0, column index is 3, do we want this block? -\/ yes (true). selected\+\_\+block\mbox{[}0\mbox{]}\mbox{[}0\mbox{]}.select\+\_\+block(0,3,true);

In the \mbox{[}0\mbox{]}\mbox{[}1\mbox{]} entry\+: row index is 0, column index is 4, do we want this block? -\/ yes (true). selected\+\_\+block\mbox{[}0\mbox{]}\mbox{[}0\mbox{]}.select\+\_\+block(0,4,true);

In the \mbox{[}1\mbox{]}\mbox{[}0\mbox{]} entry\+: row index is 1, column index is 3, do we want this block? -\/ no (false). selected\+\_\+block\mbox{[}0\mbox{]}\mbox{[}0\mbox{]}.select\+\_\+block(1,3,false);

In the \mbox{[}1\mbox{]}\mbox{[}1\mbox{]} entry\+: row index is 1, column index is 4, do we want this block? -\/ yes (true). selected\+\_\+block\mbox{[}0\mbox{]}\mbox{[}0\mbox{]}.select\+\_\+block(1,4,true,block\+\_\+pt);

where block\+\_\+pt is a pointer to the modified block.

Then we can call\+:

\hyperlink{classoomph_1_1CRDoubleMatrix}{C\+R\+Double\+Matrix} my\+\_\+block = get\+\_\+concatenated\+\_\+block(selected\+\_\+block);

N\+O\+TE\+: It is important to set the row and column indices even if you do not want the block. This is because, if we allow the row and column indices to be \char`\"{}not set\char`\"{}, then we can have a whole empty block row without any indices. But concatenation of blocks without communication requires both the row and column distributions, so we know how to permute the rows and columns. So in short, we require that the column and row indices to always be set for every entry in the Vector\+Matrix$<$\+Block\+Selector$>$ object for convenience and consistency checks. 

Definition at line 1146 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_af9321cdab3f506ab95fe51cd9b93deab}\label{classoomph_1_1BlockPreconditioner_af9321cdab3f506ab95fe51cd9b93deab}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!get\+\_\+concatenated\+\_\+block\+\_\+vector@{get\+\_\+concatenated\+\_\+block\+\_\+vector}}
\index{get\+\_\+concatenated\+\_\+block\+\_\+vector@{get\+\_\+concatenated\+\_\+block\+\_\+vector}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{get\+\_\+concatenated\+\_\+block\+\_\+vector()}{get\_concatenated\_block\_vector()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX $>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::get\+\_\+concatenated\+\_\+block\+\_\+vector (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \&}]{block\+\_\+vec\+\_\+number,  }\item[{const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{v,  }\item[{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{w }\end{DoxyParamCaption})}



Takes the naturally ordered vector and extracts the blocks indicated by the block number (the values) in the \hyperlink{classoomph_1_1Vector}{Vector} block\+\_\+vec\+\_\+number all at once, then concatenates them without communication. Here, the values in block\+\_\+vec\+\_\+number is the block number in the current preconditioner. This is a non-\/const function because distributions may be created and stored in Auxiliary\+\_\+block\+\_\+distribution\+\_\+pt for future use. 

Takes the naturally ordered vector and extracts the blocks indicated by the block number (the values) in the \hyperlink{classoomph_1_1Vector}{Vector} block\+\_\+vec\+\_\+number all at once, then concatenates them without communication. Here, the values in block\+\_\+vec\+\_\+number is the block number in the current preconditioner. This is a non-\/const function because distributions may be created and stored in Auxiliary\+\_\+block\+\_\+distribution\+\_\+pt for future use. 

Definition at line 2569 of file block\+\_\+preconditioner.\+cc.



Referenced by oomph\+::\+Block\+Preconditioner$<$ C\+R\+Double\+Matrix $>$\+::get\+\_\+blocks().

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a314fc14d95f2833be66067cd5b45e093}\label{classoomph_1_1BlockPreconditioner_a314fc14d95f2833be66067cd5b45e093}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!get\+\_\+dof\+\_\+level\+\_\+block@{get\+\_\+dof\+\_\+level\+\_\+block}}
\index{get\+\_\+dof\+\_\+level\+\_\+block@{get\+\_\+dof\+\_\+level\+\_\+block}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{get\+\_\+dof\+\_\+level\+\_\+block()}{get\_dof\_level\_block()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::get\+\_\+dof\+\_\+level\+\_\+block (\begin{DoxyParamCaption}\item[{const unsigned \&}]{i,  }\item[{const unsigned \&}]{j,  }\item[{M\+A\+T\+R\+IX \&}]{output\+\_\+block,  }\item[{const bool \&}]{ignore\+\_\+replacement\+\_\+block = {\ttfamily false} }\end{DoxyParamCaption}) const}



Gets dof-\/level block (i,j). If Replacement\+\_\+dof\+\_\+block\+\_\+pt(i,j) is not null, then the replacement block is returned via a deep copy. 

Otherwise if this is the uppermost block preconditioner then it calls internal\+\_\+get\+\_\+block(i,j), else if it is a subsidiary block preconditioner, it will call it\textquotesingle{}s master block preconditioners\textquotesingle{} get\+\_\+dof\+\_\+level\+\_\+block function. \mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a27943f064e188f326f378ea02522c267}\label{classoomph_1_1BlockPreconditioner_a27943f064e188f326f378ea02522c267}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!get\+\_\+dof\+\_\+level\+\_\+block@{get\+\_\+dof\+\_\+level\+\_\+block}}
\index{get\+\_\+dof\+\_\+level\+\_\+block@{get\+\_\+dof\+\_\+level\+\_\+block}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{get\+\_\+dof\+\_\+level\+\_\+block()}{get\_dof\_level\_block()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ \hyperlink{classoomph_1_1CRDoubleMatrix}{C\+R\+Double\+Matrix} $>$\+::get\+\_\+dof\+\_\+level\+\_\+block (\begin{DoxyParamCaption}\item[{const unsigned \&}]{block\+\_\+i,  }\item[{const unsigned \&}]{block\+\_\+j,  }\item[{\hyperlink{classoomph_1_1CRDoubleMatrix}{C\+R\+Double\+Matrix} \&}]{output\+\_\+block,  }\item[{const bool \&}]{ignore\+\_\+replacement\+\_\+block }\end{DoxyParamCaption}) const}



Gets dof-\/level block (i,j). If Replacement\+\_\+dof\+\_\+block\+\_\+pt(i,j) is not null, then the replacement block is returned via a deep copy. 

Otherwise if this is the uppermost block preconditioner then it calls internal\+\_\+get\+\_\+block(i,j), else if it is a subsidiary block preconditioner, it will call it\textquotesingle{}s master block preconditioners\textquotesingle{} get\+\_\+dof\+\_\+level\+\_\+block function. 

Definition at line 5593 of file block\+\_\+preconditioner.\+cc.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a433adda4f658cc7880121bf9ca4293c4}\label{classoomph_1_1BlockPreconditioner_a433adda4f658cc7880121bf9ca4293c4}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!get\+\_\+fine\+\_\+grain\+\_\+dof\+\_\+types\+\_\+in@{get\+\_\+fine\+\_\+grain\+\_\+dof\+\_\+types\+\_\+in}}
\index{get\+\_\+fine\+\_\+grain\+\_\+dof\+\_\+types\+\_\+in@{get\+\_\+fine\+\_\+grain\+\_\+dof\+\_\+types\+\_\+in}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{get\+\_\+fine\+\_\+grain\+\_\+dof\+\_\+types\+\_\+in()}{get\_fine\_grain\_dof\_types\_in()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$unsigned$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::get\+\_\+fine\+\_\+grain\+\_\+dof\+\_\+types\+\_\+in (\begin{DoxyParamCaption}\item[{const unsigned \&}]{i }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Returns the most fine grain dof types in a (possibly coarsened) dof type. 



Definition at line 2371 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_acac55e8dea1a0f63fcf32b7b058b0979}\label{classoomph_1_1BlockPreconditioner_acac55e8dea1a0f63fcf32b7b058b0979}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!get\+\_\+index\+\_\+of\+\_\+value@{get\+\_\+index\+\_\+of\+\_\+value}}
\index{get\+\_\+index\+\_\+of\+\_\+value@{get\+\_\+index\+\_\+of\+\_\+value}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{get\+\_\+index\+\_\+of\+\_\+value()}{get\_index\_of\_value()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
template$<$typename my\+Type $>$ \\
int \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::get\+\_\+index\+\_\+of\+\_\+value (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1Vector}{Vector}$<$ my\+Type $>$ \&}]{vec,  }\item[{const my\+Type}]{val,  }\item[{const bool}]{sorted = {\ttfamily false} }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Get the index of first occurrence of value in a vector. If the element does not exist, -\/1 is returned. The optional parameter indicates of the \hyperlink{classoomph_1_1Vector}{Vector} is sorted or not. Complexity\+: if the \hyperlink{classoomph_1_1Vector}{Vector} is sorted, then on average, logarithmic in the distance between first and last\+: Performs approximately log2(\+N)+2 element comparisons. Otherwise, up to linear in the distance between first and last\+: Compares elements until a match is found. 



Definition at line 2862 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a75742d54177935fb22e59d045209b11e}\label{classoomph_1_1BlockPreconditioner_a75742d54177935fb22e59d045209b11e}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!index\+\_\+in\+\_\+block@{index\+\_\+in\+\_\+block}}
\index{index\+\_\+in\+\_\+block@{index\+\_\+in\+\_\+block}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{index\+\_\+in\+\_\+block()}{index\_in\_block()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
int \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::index\+\_\+in\+\_\+block (\begin{DoxyParamCaption}\item[{const unsigned \&}]{i\+\_\+dof }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Given a global dof number, returns the index in the block it belongs to. This is the overall index, not local block (in parallel). 



Definition at line 1875 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a9b3c4072be2bf4f0dfdd18f56a5d51bf}\label{classoomph_1_1BlockPreconditioner_a9b3c4072be2bf4f0dfdd18f56a5d51bf}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!insert\+\_\+auxiliary\+\_\+block\+\_\+distribution@{insert\+\_\+auxiliary\+\_\+block\+\_\+distribution}}
\index{insert\+\_\+auxiliary\+\_\+block\+\_\+distribution@{insert\+\_\+auxiliary\+\_\+block\+\_\+distribution}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{insert\+\_\+auxiliary\+\_\+block\+\_\+distribution()}{insert\_auxiliary\_block\_distribution()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::insert\+\_\+auxiliary\+\_\+block\+\_\+distribution (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \&}]{block\+\_\+vec\+\_\+number,  }\item[{\hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution} $\ast$}]{dist\+\_\+pt }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



insert a \hyperlink{classoomph_1_1Vector}{Vector$<$unsigned$>$} and Linear\+Algebra\+Distribution$\ast$ pair into Auxiliary\+\_\+block\+\_\+distribution\+\_\+pt. The Auxiliary\+\_\+block\+\_\+distribution\+\_\+pt should only contain pointers to distributions concatenated at this block level. We try to ensure this by checking if the block\+\_\+vec\+\_\+number vector is within the range \hyperlink{classoomph_1_1BlockPreconditioner_a80808d42be8db74fd58af80b019bf317}{nblock\+\_\+types()}. Of course, this does not guarantee correctness, but this is the least we can do. 



Definition at line 2800 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_ac460225afc092cc5ed9d77acc6316536}\label{classoomph_1_1BlockPreconditioner_ac460225afc092cc5ed9d77acc6316536}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!internal\+\_\+block\+\_\+dimension@{internal\+\_\+block\+\_\+dimension}}
\index{internal\+\_\+block\+\_\+dimension@{internal\+\_\+block\+\_\+dimension}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{internal\+\_\+block\+\_\+dimension()}{internal\_block\_dimension()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
unsigned \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::internal\+\_\+block\+\_\+dimension (\begin{DoxyParamCaption}\item[{const unsigned \&}]{b }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}



Return the number of degrees of freedom in block b. Note that if this preconditioner acts as a subsidiary preconditioner then b refers to the block number in the subsidiary preconditioner not the master block preconditioner. 



Definition at line 3207 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a19f8ca9f40ab804262cf95c1d5eb598c}\label{classoomph_1_1BlockPreconditioner_a19f8ca9f40ab804262cf95c1d5eb598c}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!internal\+\_\+block\+\_\+distribution\+\_\+pt@{internal\+\_\+block\+\_\+distribution\+\_\+pt}}
\index{internal\+\_\+block\+\_\+distribution\+\_\+pt@{internal\+\_\+block\+\_\+distribution\+\_\+pt}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{internal\+\_\+block\+\_\+distribution\+\_\+pt()}{internal\_block\_distribution\_pt()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
const \hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution}$\ast$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::internal\+\_\+block\+\_\+distribution\+\_\+pt (\begin{DoxyParamCaption}\item[{const unsigned \&}]{b }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Access function to the internal block distributions. 



Definition at line 2765 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_af3eadb5d8d36200c4738537eac1647a6}\label{classoomph_1_1BlockPreconditioner_af3eadb5d8d36200c4738537eac1647a6}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!internal\+\_\+block\+\_\+number@{internal\+\_\+block\+\_\+number}}
\index{internal\+\_\+block\+\_\+number@{internal\+\_\+block\+\_\+number}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{internal\+\_\+block\+\_\+number()}{internal\_block\_number()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
int \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::internal\+\_\+block\+\_\+number (\begin{DoxyParamCaption}\item[{const unsigned \&}]{i\+\_\+dof }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Return the block number corresponding to a global index i\+\_\+dof. This returns the block number corresponding to the internal blocks. What this means is that this returns the most fine grain dof-\/block number which this global index i\+\_\+dof corresponds to. Since the writer of the preconditioner does not need to care about the internal block types, this function should not be used and thus moved to private. This function should not be removed since it is still used deep within the inner workings of the block preconditioning framework. 



Definition at line 2717 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_abe03c970690224b46a29e55e16992dd7}\label{classoomph_1_1BlockPreconditioner_abe03c970690224b46a29e55e16992dd7}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!internal\+\_\+dof\+\_\+block\+\_\+dimension@{internal\+\_\+dof\+\_\+block\+\_\+dimension}}
\index{internal\+\_\+dof\+\_\+block\+\_\+dimension@{internal\+\_\+dof\+\_\+block\+\_\+dimension}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{internal\+\_\+dof\+\_\+block\+\_\+dimension()}{internal\_dof\_block\_dimension()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
unsigned \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::internal\+\_\+dof\+\_\+block\+\_\+dimension (\begin{DoxyParamCaption}\item[{const unsigned \&}]{i }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}



Return the size of the dof \char`\"{}block\char`\"{} i, i.\+e. how many degrees of freedom are associated with it. Note that if this preconditioner acts as a subsidiary preconditioner, then i refers to the block number in the subsidiary preconditioner not the master block preconditioner. 



Definition at line 3230 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_abb4dff3469cc6718103fddfdf3f3a7bb}\label{classoomph_1_1BlockPreconditioner_abb4dff3469cc6718103fddfdf3f3a7bb}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!internal\+\_\+dof\+\_\+number@{internal\+\_\+dof\+\_\+number}}
\index{internal\+\_\+dof\+\_\+number@{internal\+\_\+dof\+\_\+number}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{internal\+\_\+dof\+\_\+number()}{internal\_dof\_number()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
int \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::internal\+\_\+dof\+\_\+number (\begin{DoxyParamCaption}\item[{const unsigned \&}]{i\+\_\+dof }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}



Return the number of the block associated with global unknown i\+\_\+dof. If this preconditioner is a subsidiary block preconditioner then the block number in the subsidiary block preconditioner is returned. If a particular global D\+OF is not associated with this preconditioner then -\/1 is returned. 



Definition at line 3087 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_abe001ffe270c96e761ec5205364976a7}\label{classoomph_1_1BlockPreconditioner_abe001ffe270c96e761ec5205364976a7}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!internal\+\_\+get\+\_\+block@{internal\+\_\+get\+\_\+block}}
\index{internal\+\_\+get\+\_\+block@{internal\+\_\+get\+\_\+block}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{internal\+\_\+get\+\_\+block()}{internal\_get\_block()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::internal\+\_\+get\+\_\+block (\begin{DoxyParamCaption}\item[{const unsigned \&}]{i,  }\item[{const unsigned \&}]{j,  }\item[{M\+A\+T\+R\+IX \&}]{output\+\_\+block }\end{DoxyParamCaption}) const}



Gets block (i,j) from the matrix pointed to by Matrix\+\_\+pt and returns it in output\+\_\+block. This is associated with the internal blocks. Please use the other get\+\_\+block(...) function. 



Referenced by oomph\+::\+Block\+Preconditioner$<$ C\+R\+Double\+Matrix $>$\+::return\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector().

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a4c824a95d71ce68ee7e1acf6d45178e3}\label{classoomph_1_1BlockPreconditioner_a4c824a95d71ce68ee7e1acf6d45178e3}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!internal\+\_\+get\+\_\+block@{internal\+\_\+get\+\_\+block}}
\index{internal\+\_\+get\+\_\+block@{internal\+\_\+get\+\_\+block}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{internal\+\_\+get\+\_\+block()}{internal\_get\_block()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ \hyperlink{classoomph_1_1CRDoubleMatrix}{C\+R\+Double\+Matrix} $>$\+::internal\+\_\+get\+\_\+block (\begin{DoxyParamCaption}\item[{const unsigned \&}]{block\+\_\+i,  }\item[{const unsigned \&}]{block\+\_\+j,  }\item[{\hyperlink{classoomph_1_1CRDoubleMatrix}{C\+R\+Double\+Matrix} \&}]{output\+\_\+block }\end{DoxyParamCaption}) const}



Gets block (i,j) from the matrix pointed to by Matrix\+\_\+pt and returns it in output\+\_\+block. This is associated with the internal blocks. Please use the other get\+\_\+block(...) function. 



Definition at line 5041 of file block\+\_\+preconditioner.\+cc.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_afba1bef13cebdce65a0a49ff3381269a}\label{classoomph_1_1BlockPreconditioner_afba1bef13cebdce65a0a49ff3381269a}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!internal\+\_\+get\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector@{internal\+\_\+get\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector}}
\index{internal\+\_\+get\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector@{internal\+\_\+get\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{internal\+\_\+get\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector()}{internal\_get\_block\_ordered\_preconditioner\_vector()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX $>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::internal\+\_\+get\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{v,  }\item[{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{w }\end{DoxyParamCaption}) const}



Given the naturally ordered vector, v, return the vector rearranged in block order in w. This is a legacy function from the old block preconditioning framework. Kept alive in case it may be needed again. 

This uses the variables ending in \char`\"{}get\+\_\+ordered\char`\"{}. We no longer use this type of method. This function copy values from v and re-\/order them in \char`\"{}block order\char`\"{} and place them in w. Block order means that the values in w are the same as the concatenated block vectors.

I.\+e. -\/ v is naturally ordered. v -\/$>$ s\+\_\+b, v is ordered into blocks vectors (requires communication) concatenate\+\_\+without\+\_\+communication(s\+\_\+\{0,...,nblocks\},w) gives w.

But this function skips out the concatenation part and builds w directly from v.

This is nice but the function is implemented in such a way that it always use all the (internal) blocks and concatenated with the identity ordering. I.\+e. if this preconditioner has 3 block types, then w will always be\+: concatenate\+\_\+without\+\_\+communication(\mbox{[}s\+\_\+0, s\+\_\+1, s\+\_\+2\mbox{]}, w). There is easy way to change this.

Furthermore, it does not take into account the new dof type coarsening feature. So this function will most likely produce the incorrect vector w from what the user intended. It still works, but w will be the concatenation of the most fine grain dof block vectors with the \char`\"{}natural\char`\"{} dof type ordering.

This has been superseded by the function get\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector(...) which does the correct thing. 

Definition at line 4549 of file block\+\_\+preconditioner.\+cc.



Referenced by oomph\+::\+Block\+Preconditioner$<$ C\+R\+Double\+Matrix $>$\+::return\+\_\+block\+\_\+vector().

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_ae3cf61f61e1aa50e2315e999827e7d59}\label{classoomph_1_1BlockPreconditioner_ae3cf61f61e1aa50e2315e999827e7d59}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!internal\+\_\+get\+\_\+block\+\_\+vector@{internal\+\_\+get\+\_\+block\+\_\+vector}}
\index{internal\+\_\+get\+\_\+block\+\_\+vector@{internal\+\_\+get\+\_\+block\+\_\+vector}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{internal\+\_\+get\+\_\+block\+\_\+vector()}{internal\_get\_block\_vector()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX $>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::internal\+\_\+get\+\_\+block\+\_\+vector (\begin{DoxyParamCaption}\item[{const unsigned \&}]{n,  }\item[{const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{v,  }\item[{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{b }\end{DoxyParamCaption}) const}



A helper function, takes the naturally ordered vector, v, and extracts the n-\/th block vector, b. Here n is the block number in the current preconditioner. N\+O\+TE\+: The ordering of the vector b is the same as the ordering of the block matrix from internal\+\_\+get\+\_\+block(...). 



Definition at line 3966 of file block\+\_\+preconditioner.\+cc.



Referenced by oomph\+::\+Block\+Preconditioner$<$ C\+R\+Double\+Matrix $>$\+::internal\+\_\+return\+\_\+block\+\_\+vectors().

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_ace6e9dbdfe9a1c3571452e2cd6ec9780}\label{classoomph_1_1BlockPreconditioner_ace6e9dbdfe9a1c3571452e2cd6ec9780}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!internal\+\_\+get\+\_\+block\+\_\+vectors@{internal\+\_\+get\+\_\+block\+\_\+vectors}}
\index{internal\+\_\+get\+\_\+block\+\_\+vectors@{internal\+\_\+get\+\_\+block\+\_\+vectors}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{internal\+\_\+get\+\_\+block\+\_\+vectors()}{internal\_get\_block\_vectors()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX $>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::internal\+\_\+get\+\_\+block\+\_\+vectors (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \&}]{block\+\_\+vec\+\_\+number,  }\item[{const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{v,  }\item[{\hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ \&}]{s }\end{DoxyParamCaption}) const}



Takes the naturally ordered vector and rearranges it into a vector of sub vectors corresponding to the blocks, so s\mbox{[}b\mbox{]}\mbox{[}i\mbox{]} contains the i-\/th entry in the vector associated with block b. The block\+\_\+vec\+\_\+number indicates which blocks we want. These blocks and vectors are those corresponding to the internal blocks. Note\+: If the preconditioner is a subsidiary preconditioner then only the sub-\/vectors associated with the blocks of the subsidiary preconditioner will be included. Hence the length of v is \hyperlink{classoomph_1_1BlockPreconditioner_a3e5b553f65e6c25354a5c908d507e8ee}{master\+\_\+nrow()} whereas the total length of the s vectors is the sum of the Nrow of the sub vectors. 

Takes the naturally ordered vector and rearranges it into a vector of sub vectors corresponding to the blocks, so s\mbox{[}b\mbox{]}\mbox{[}i\mbox{]} contains the i-\/th entry in the vector associated with block b. The block\+\_\+vec\+\_\+number indicates which blocks we want. These blocks and vectors are those corresponding to the internal blocks. Note\+: If the preconditioner is a subsidiary preconditioner then only the.

sub-\/vectors associated with the blocks of the subsidiary preconditioner will be included. Hence the length of v is \hyperlink{classoomph_1_1BlockPreconditioner_a3e5b553f65e6c25354a5c908d507e8ee}{master\+\_\+nrow()} whereas the total length of the s vectors is the sum of the Nrow of the sub vectors. 

Definition at line 3113 of file block\+\_\+preconditioner.\+cc.



Referenced by oomph\+::\+Block\+Preconditioner$<$ C\+R\+Double\+Matrix $>$\+::get\+\_\+block\+\_\+vectors(), and oomph\+::\+Block\+Preconditioner$<$ C\+R\+Double\+Matrix $>$\+::internal\+\_\+get\+\_\+block\+\_\+vectors().

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a0cde8af922cd8054dbf352527dd682b1}\label{classoomph_1_1BlockPreconditioner_a0cde8af922cd8054dbf352527dd682b1}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!internal\+\_\+get\+\_\+block\+\_\+vectors@{internal\+\_\+get\+\_\+block\+\_\+vectors}}
\index{internal\+\_\+get\+\_\+block\+\_\+vectors@{internal\+\_\+get\+\_\+block\+\_\+vectors}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{internal\+\_\+get\+\_\+block\+\_\+vectors()}{internal\_get\_block\_vectors()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX $>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::internal\+\_\+get\+\_\+block\+\_\+vectors (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{v,  }\item[{\hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ \&}]{s }\end{DoxyParamCaption}) const}



A helper function, takes the naturally ordered vector and rearranges it into a vector of sub vectors corresponding to the blocks, so s\mbox{[}b\mbox{]}\mbox{[}i\mbox{]} contains the i-\/th entry in the vector associated with block b. The block\+\_\+vec\+\_\+number indicates which blocks we want. These blocks and vectors are those corresponding to the internal blocks. Note\+: If the preconditioner is a subsidiary preconditioner then only the sub-\/vectors associated with the blocks of the subsidiary preconditioner will be included. Hence the length of v is \hyperlink{classoomph_1_1BlockPreconditioner_a3e5b553f65e6c25354a5c908d507e8ee}{master\+\_\+nrow()} whereas the total length of the s vectors is the sum of the Nrow of the sub vectors. This is simply a wrapper around the other internal\+\_\+get\+\_\+block\+\_\+vectors(...) function with the identity block\+\_\+vec\+\_\+number vector. 



Definition at line 3385 of file block\+\_\+preconditioner.\+cc.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_affcfd24c1ba15bf9cac712ffd46dc283}\label{classoomph_1_1BlockPreconditioner_affcfd24c1ba15bf9cac712ffd46dc283}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!internal\+\_\+index\+\_\+in\+\_\+block@{internal\+\_\+index\+\_\+in\+\_\+block}}
\index{internal\+\_\+index\+\_\+in\+\_\+block@{internal\+\_\+index\+\_\+in\+\_\+block}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{internal\+\_\+index\+\_\+in\+\_\+block()}{internal\_index\_in\_block()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
int \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::internal\+\_\+index\+\_\+in\+\_\+block (\begin{DoxyParamCaption}\item[{const unsigned \&}]{i\+\_\+dof }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Return the index in the block corresponding to a global block number i\+\_\+dof. The index returned corresponds to the internal blocks, which is the most fine grain dof blocks. 



Definition at line 2733 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a1e0a33327b5042dfba04baf46c045373}\label{classoomph_1_1BlockPreconditioner_a1e0a33327b5042dfba04baf46c045373}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!internal\+\_\+index\+\_\+in\+\_\+dof@{internal\+\_\+index\+\_\+in\+\_\+dof}}
\index{internal\+\_\+index\+\_\+in\+\_\+dof@{internal\+\_\+index\+\_\+in\+\_\+dof}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{internal\+\_\+index\+\_\+in\+\_\+dof()}{internal\_index\_in\_dof()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
unsigned \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::internal\+\_\+index\+\_\+in\+\_\+dof (\begin{DoxyParamCaption}\item[{const unsigned \&}]{i\+\_\+dof }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}



Return the row/column number of global unknown i\+\_\+dof within it\textquotesingle{}s block. 



Definition at line 3154 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a7297e4d24c2c7ae7af6a9ad009669928}\label{classoomph_1_1BlockPreconditioner_a7297e4d24c2c7ae7af6a9ad009669928}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!internal\+\_\+master\+\_\+dof\+\_\+number@{internal\+\_\+master\+\_\+dof\+\_\+number}}
\index{internal\+\_\+master\+\_\+dof\+\_\+number@{internal\+\_\+master\+\_\+dof\+\_\+number}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{internal\+\_\+master\+\_\+dof\+\_\+number()}{internal\_master\_dof\_number()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
unsigned \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::internal\+\_\+master\+\_\+dof\+\_\+number (\begin{DoxyParamCaption}\item[{const unsigned \&}]{b }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}



Takes the block number within this preconditioner and returns the corresponding block number in the master preconditioner. If this preconditioner does not have a master block preconditioner then the block number passed is returned. 



Definition at line 3281 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a7c2b9ed482db072b0cabe5a51eb76efa}\label{classoomph_1_1BlockPreconditioner_a7c2b9ed482db072b0cabe5a51eb76efa}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!internal\+\_\+nblock\+\_\+types@{internal\+\_\+nblock\+\_\+types}}
\index{internal\+\_\+nblock\+\_\+types@{internal\+\_\+nblock\+\_\+types}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{internal\+\_\+nblock\+\_\+types()}{internal\_nblock\_types()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
unsigned \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::internal\+\_\+nblock\+\_\+types (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Return the number internal blocks. This should be the same as the number of internal dof types. Internally, the block preconditioning framework always work with the most fine grain blocks. I.\+e. it always deal with the most fine grain dof-\/level blocks. This allows for coarsening of dof types. When we extract a block, we look at the Block\+\_\+to\+\_\+dof\+\_\+map\+\_\+fine vector to find out which most fine grain dof types belongs to this block. 

The preconditioner writer should not have to deal with internal dof/block types and thus this function has been moved to private.

This is legacy code from before the coarsening dof type functionality was added. This is kept alive because it is still used in the internal workings of the block preconditioning framework.

The function nblock\+\_\+types(...) should be used if the number of block types is required. 

Definition at line 2554 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a4f3efe468cd6e133d6840ede8c3687b5}\label{classoomph_1_1BlockPreconditioner_a4f3efe468cd6e133d6840ede8c3687b5}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!internal\+\_\+ndof\+\_\+types@{internal\+\_\+ndof\+\_\+types}}
\index{internal\+\_\+ndof\+\_\+types@{internal\+\_\+ndof\+\_\+types}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{internal\+\_\+ndof\+\_\+types()}{internal\_ndof\_types()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
unsigned \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::internal\+\_\+ndof\+\_\+types (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Return the number of internal dof types. This is the number of most fine grain dof types. The preconditioner writer should not have to concern him/her-\/self with the internal dof/block types. Thus this fuction is moved to private. We have kept this function alive since it it still used deep within the inner workings of the block preconditioning framework. 



Definition at line 2596 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a3a16de88bd5369e729d761a6498fdd3f}\label{classoomph_1_1BlockPreconditioner_a3a16de88bd5369e729d761a6498fdd3f}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!internal\+\_\+preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt@{internal\+\_\+preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt}}
\index{internal\+\_\+preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt@{internal\+\_\+preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{internal\+\_\+preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt()}{internal\_preconditioner\_matrix\_distribution\_pt()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
const \hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution}$\ast$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::internal\+\_\+preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}



access function to the internal preconditioner matrix distribution pt. preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt always returns the concatenation of the internal block distributions. Since the writer of the preconditioner does not need to concern themselves with the internal dof/block, please use \hyperlink{classoomph_1_1BlockPreconditioner_a74eeff188f842dd8abdff1b7d9801d44}{preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt()}. 



Definition at line 3296 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a679a82067056628cc4bbc8bb68d088f2}\label{classoomph_1_1BlockPreconditioner_a679a82067056628cc4bbc8bb68d088f2}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!internal\+\_\+return\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector@{internal\+\_\+return\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector}}
\index{internal\+\_\+return\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector@{internal\+\_\+return\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{internal\+\_\+return\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector()}{internal\_return\_block\_ordered\_preconditioner\_vector()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX $>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::internal\+\_\+return\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{w,  }\item[{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{v }\end{DoxyParamCaption}) const}



Takes the block ordered vector, w, and reorders it in the natural order. Reordered vector is returned in v. Note\+: If the preconditioner is a subsidiary preconditioner then only the components of the vector associated with the blocks of the subsidiary preconditioner will be included. Hence the length of v is \hyperlink{classoomph_1_1BlockPreconditioner_a3e5b553f65e6c25354a5c908d507e8ee}{master\+\_\+nrow()} whereas that of the vector w is of length this-\/$>$\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_a7569556f14fd68b28508920e89bd5eee}{nrow()}. 

This is the return function for the function internal\+\_\+get\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector(...). Both internal\+\_\+get\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector(...) and internal\+\_\+return\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector(...) has been superseded by the functions

get\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector(...) and return\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector(...),

Thus this function is moved to the private section of the code. 

Definition at line 4794 of file block\+\_\+preconditioner.\+cc.



Referenced by oomph\+::\+Block\+Preconditioner$<$ C\+R\+Double\+Matrix $>$\+::get\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector().

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a04e260cc4160a952db2d410109fb2684}\label{classoomph_1_1BlockPreconditioner_a04e260cc4160a952db2d410109fb2684}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!internal\+\_\+return\+\_\+block\+\_\+vector@{internal\+\_\+return\+\_\+block\+\_\+vector}}
\index{internal\+\_\+return\+\_\+block\+\_\+vector@{internal\+\_\+return\+\_\+block\+\_\+vector}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{internal\+\_\+return\+\_\+block\+\_\+vector()}{internal\_return\_block\_vector()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX $>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::internal\+\_\+return\+\_\+block\+\_\+vector (\begin{DoxyParamCaption}\item[{const unsigned \&}]{b,  }\item[{const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{w,  }\item[{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{v }\end{DoxyParamCaption}) const}



Takes the n-\/th block ordered vector, b, and copies its entries to the appropriate entries in the naturally ordered vector, v. Here n is the block number in the current block preconditioner. If the preconditioner is a subsidiary block preconditioner the other entries in v that are not associated with it are left alone. 

This version works with the internal block types. This is legacy code but is kept alive, hence moved to private. Please use the function \char`\"{}return\+\_\+block\+\_\+vector(...)\char`\"{}. 

Definition at line 4245 of file block\+\_\+preconditioner.\+cc.



Referenced by oomph\+::\+Block\+Preconditioner$<$ C\+R\+Double\+Matrix $>$\+::get\+\_\+block\+\_\+vector().

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a2ca7f125e50493073d116ba8da271af5}\label{classoomph_1_1BlockPreconditioner_a2ca7f125e50493073d116ba8da271af5}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!internal\+\_\+return\+\_\+block\+\_\+vectors@{internal\+\_\+return\+\_\+block\+\_\+vectors}}
\index{internal\+\_\+return\+\_\+block\+\_\+vectors@{internal\+\_\+return\+\_\+block\+\_\+vectors}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{internal\+\_\+return\+\_\+block\+\_\+vectors()}{internal\_return\_block\_vectors()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX $>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::internal\+\_\+return\+\_\+block\+\_\+vectors (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \&}]{block\+\_\+vec\+\_\+number,  }\item[{const \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ \&}]{s,  }\item[{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{v }\end{DoxyParamCaption}) const}



A helper function, takes the vector of block vectors, s, and copies its entries into the naturally ordered vector, v. If this is a subsidiary block preconditioner only those entries in v that are associated with its blocks are affected. 

Takes the naturally ordered vector and rearranges it into a vector of sub vectors corresponding to the blocks, so s\mbox{[}b\mbox{]}\mbox{[}i\mbox{]} contains the i-\/th entry in the vector associated with block b. The block\+\_\+vec\+\_\+number indicates which blocks we want. These blocks and vectors are those corresponding to the internal blocks. Note\+: If the preconditioner is a subsidiary preconditioner then only the sub-\/vectors associated with the blocks of the subsidiary preconditioner will be included. Hence the length of v is \hyperlink{classoomph_1_1BlockPreconditioner_a3e5b553f65e6c25354a5c908d507e8ee}{master\+\_\+nrow()} whereas the total length of the s vectors is the sum of the Nrow of the sub vectors. 

Definition at line 3659 of file block\+\_\+preconditioner.\+cc.



Referenced by oomph\+::\+Block\+Preconditioner$<$ C\+R\+Double\+Matrix $>$\+::internal\+\_\+return\+\_\+block\+\_\+vectors(), and oomph\+::\+Block\+Preconditioner$<$ C\+R\+Double\+Matrix $>$\+::return\+\_\+block\+\_\+vectors().

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a9e2ce77e3efbcdd465f7ad7252936dfd}\label{classoomph_1_1BlockPreconditioner_a9e2ce77e3efbcdd465f7ad7252936dfd}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!internal\+\_\+return\+\_\+block\+\_\+vectors@{internal\+\_\+return\+\_\+block\+\_\+vectors}}
\index{internal\+\_\+return\+\_\+block\+\_\+vectors@{internal\+\_\+return\+\_\+block\+\_\+vectors}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{internal\+\_\+return\+\_\+block\+\_\+vectors()}{internal\_return\_block\_vectors()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX $>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::internal\+\_\+return\+\_\+block\+\_\+vectors (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ \&}]{s,  }\item[{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{v }\end{DoxyParamCaption}) const}



A helper function, takes the vector of block vectors, s, and copies its entries into the naturally ordered vector, v. If this is a subsidiary block preconditioner only those entries in v that are associated with its blocks are affected. This is simple a wrapper around the other internal\+\_\+return\+\_\+block\+\_\+vectors(...) function with the identity block\+\_\+vec\+\_\+number vector. 

A helper function, takes the naturally ordered vector and rearranges it into a vector of sub vectors corresponding to the blocks, so s\mbox{[}b\mbox{]}\mbox{[}i\mbox{]} contains the i-\/th entry in the vector associated with block b. The block\+\_\+vec\+\_\+number indicates which blocks we want. These blocks and vectors are those corresponding to the internal blocks. Note\+: If the preconditioner is a subsidiary preconditioner then only the sub-\/vectors associated with the blocks of the subsidiary preconditioner will be included. Hence the length of v is \hyperlink{classoomph_1_1BlockPreconditioner_a3e5b553f65e6c25354a5c908d507e8ee}{master\+\_\+nrow()} whereas the total length of the s vectors is the sum of the Nrow of the sub vectors. This is simply a wrapper around the other internal\+\_\+get\+\_\+block\+\_\+vectors(...) function with the identity block\+\_\+vec\+\_\+number vector. 

Definition at line 3944 of file block\+\_\+preconditioner.\+cc.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a804e1975f170d2ad941b3b7d2dd50407}\label{classoomph_1_1BlockPreconditioner_a804e1975f170d2ad941b3b7d2dd50407}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!is\+\_\+master\+\_\+block\+\_\+preconditioner@{is\+\_\+master\+\_\+block\+\_\+preconditioner}}
\index{is\+\_\+master\+\_\+block\+\_\+preconditioner@{is\+\_\+master\+\_\+block\+\_\+preconditioner}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{is\+\_\+master\+\_\+block\+\_\+preconditioner()}{is\_master\_block\_preconditioner()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
bool \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::is\+\_\+master\+\_\+block\+\_\+preconditioner (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Return true if this preconditioner is the master block preconditioner. 



Definition at line 2099 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a9ac4335ec07fc13f7bf1093fd0489c52}\label{classoomph_1_1BlockPreconditioner_a9ac4335ec07fc13f7bf1093fd0489c52}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!is\+\_\+subsidiary\+\_\+block\+\_\+preconditioner@{is\+\_\+subsidiary\+\_\+block\+\_\+preconditioner}}
\index{is\+\_\+subsidiary\+\_\+block\+\_\+preconditioner@{is\+\_\+subsidiary\+\_\+block\+\_\+preconditioner}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{is\+\_\+subsidiary\+\_\+block\+\_\+preconditioner()}{is\_subsidiary\_block\_preconditioner()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
bool \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::is\+\_\+subsidiary\+\_\+block\+\_\+preconditioner (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Return true if this preconditioner is a subsidiary preconditioner. 



Definition at line 2092 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_ab84701c65bdfd8d2c14611176e5e6209}\label{classoomph_1_1BlockPreconditioner_ab84701c65bdfd8d2c14611176e5e6209}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!master\+\_\+block\+\_\+preconditioner\+\_\+pt@{master\+\_\+block\+\_\+preconditioner\+\_\+pt}}
\index{master\+\_\+block\+\_\+preconditioner\+\_\+pt@{master\+\_\+block\+\_\+preconditioner\+\_\+pt}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{master\+\_\+block\+\_\+preconditioner\+\_\+pt()}{master\_block\_preconditioner\_pt()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1BlockPreconditioner}{Block\+Preconditioner}$<$M\+A\+T\+R\+IX$>$$\ast$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::master\+\_\+block\+\_\+preconditioner\+\_\+pt (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Access function to the master block preconditioner pt. 



Definition at line 2172 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a005d978655022d1a04da7397cf5d0e83}\label{classoomph_1_1BlockPreconditioner_a005d978655022d1a04da7397cf5d0e83}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!master\+\_\+distribution\+\_\+pt@{master\+\_\+distribution\+\_\+pt}}
\index{master\+\_\+distribution\+\_\+pt@{master\+\_\+distribution\+\_\+pt}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{master\+\_\+distribution\+\_\+pt()}{master\_distribution\_pt()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
const \hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution}$\ast$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::master\+\_\+distribution\+\_\+pt (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Access function to the distribution of the master preconditioner. If this preconditioner does not have a master preconditioner then the distribution of this preconditioner is returned. 



Definition at line 2048 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a3e5b553f65e6c25354a5c908d507e8ee}\label{classoomph_1_1BlockPreconditioner_a3e5b553f65e6c25354a5c908d507e8ee}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!master\+\_\+nrow@{master\+\_\+nrow}}
\index{master\+\_\+nrow@{master\+\_\+nrow}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{master\+\_\+nrow()}{master\_nrow()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
unsigned \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::master\+\_\+nrow (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}



Return the number of dofs (number of rows or columns) in the overall problem. The prefix \char`\"{}master\+\_\+\char`\"{} is sort of redundant when used as a stand-\/alone block preconditioner but is required to avoid ambiguities. The latter is stored (and maintained) separately for each specific block preconditioner regardless of its role. 



Definition at line 3265 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a9aac48fd53e579e6db8eeed58933a14b}\label{classoomph_1_1BlockPreconditioner_a9aac48fd53e579e6db8eeed58933a14b}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!matrix\+\_\+pt@{matrix\+\_\+pt}}
\index{matrix\+\_\+pt@{matrix\+\_\+pt}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{matrix\+\_\+pt()}{matrix\_pt()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
M\+A\+T\+R\+IX$\ast$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::matrix\+\_\+pt (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Access function to matrix\+\_\+pt. If this is the master then cast the matrix pointer to M\+A\+T\+R\+I\+X$\ast$, error check and return. Otherwise ask the master for its matrix pointer. 



Reimplemented from \hyperlink{classoomph_1_1Preconditioner_a66726e9df31365df646cdf83a975aa26}{oomph\+::\+Preconditioner}.



Definition at line 535 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a3c0e92cb77c3e3179007fe9fd99b6428}\label{classoomph_1_1BlockPreconditioner_a3c0e92cb77c3e3179007fe9fd99b6428}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!mesh\+\_\+pt@{mesh\+\_\+pt}}
\index{mesh\+\_\+pt@{mesh\+\_\+pt}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{mesh\+\_\+pt()}{mesh\_pt()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
const \hyperlink{classoomph_1_1Mesh}{Mesh}$\ast$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::mesh\+\_\+pt (\begin{DoxyParamCaption}\item[{const unsigned \&}]{i }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Access to i-\/th mesh (of the various meshes that contain block preconditionable elements of the same number of dof type). 

W\+A\+R\+N\+I\+NG\+: This should only be used if the derived class is the upper-\/most master block preconditioner. An error is thrown is this function is called from a subsidiary preconditioner. They (and since every block preconditioner can in principle be used as s subsidiary preconditioner\+: all block preconditioners) should store local copies of \char`\"{}their meshes\char`\"{} (if they\textquotesingle{}re needed for anything) 

Definition at line 1805 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a80808d42be8db74fd58af80b019bf317}\label{classoomph_1_1BlockPreconditioner_a80808d42be8db74fd58af80b019bf317}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!nblock\+\_\+types@{nblock\+\_\+types}}
\index{nblock\+\_\+types@{nblock\+\_\+types}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{nblock\+\_\+types()}{nblock\_types()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
unsigned \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::nblock\+\_\+types (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Return the number of block types. 



Definition at line 1691 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_ab6cca480686ea8e44244ac60a0db23ba}\label{classoomph_1_1BlockPreconditioner_ab6cca480686ea8e44244ac60a0db23ba}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!ndof\+\_\+types@{ndof\+\_\+types}}
\index{ndof\+\_\+types@{ndof\+\_\+types}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{ndof\+\_\+types()}{ndof\_types()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
unsigned \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::ndof\+\_\+types (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Return the total number of D\+OF types. 



Definition at line 1715 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a45509677ccef78be13b5e4485312ddc1}\label{classoomph_1_1BlockPreconditioner_a45509677ccef78be13b5e4485312ddc1}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!ndof\+\_\+types\+\_\+in\+\_\+mesh@{ndof\+\_\+types\+\_\+in\+\_\+mesh}}
\index{ndof\+\_\+types\+\_\+in\+\_\+mesh@{ndof\+\_\+types\+\_\+in\+\_\+mesh}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{ndof\+\_\+types\+\_\+in\+\_\+mesh()}{ndof\_types\_in\_mesh()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
unsigned \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::ndof\+\_\+types\+\_\+in\+\_\+mesh (\begin{DoxyParamCaption}\item[{const unsigned \&}]{i }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Return the number of D\+OF types in mesh i. W\+A\+R\+N\+I\+NG\+: This should only be used by the upper-\/most master block preconditioner. An error is thrown is this function is called from a subsidiary preconditioner. They (and since every block preconditioner can in principle be used as s subsidiary preconditioner\+: all block preconditioners) should store local copies of \char`\"{}their meshes\char`\"{} (if they\textquotesingle{}re needed for anything) 



Definition at line 2068 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a50b76a374797805f64e2af34d581cdc2}\label{classoomph_1_1BlockPreconditioner_a50b76a374797805f64e2af34d581cdc2}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!nfine\+\_\+grain\+\_\+dof\+\_\+types\+\_\+in@{nfine\+\_\+grain\+\_\+dof\+\_\+types\+\_\+in}}
\index{nfine\+\_\+grain\+\_\+dof\+\_\+types\+\_\+in@{nfine\+\_\+grain\+\_\+dof\+\_\+types\+\_\+in}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{nfine\+\_\+grain\+\_\+dof\+\_\+types\+\_\+in()}{nfine\_grain\_dof\_types\_in()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
unsigned \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::nfine\+\_\+grain\+\_\+dof\+\_\+types\+\_\+in (\begin{DoxyParamCaption}\item[{const unsigned \&}]{i }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Access function for the number of most fine grain dof types in a (possibly coarsened) dof type. 



Definition at line 2392 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a193776a271f7c23d20d2102de0ff1cb9}\label{classoomph_1_1BlockPreconditioner_a193776a271f7c23d20d2102de0ff1cb9}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!nmesh@{nmesh}}
\index{nmesh@{nmesh}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{nmesh()}{nmesh()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
unsigned \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::nmesh (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Return the number of meshes in Mesh\+\_\+pt. 

W\+A\+R\+N\+I\+NG\+: This should only be used if the derived class is the upper-\/most master block preconditioner. All block preconditioners) should store local copies of \char`\"{}their meshes\char`\"{} (if they\textquotesingle{}re needed for anything) 

Definition at line 1841 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a910f9395fa4f5f9bc4d13a9d104c432d}\label{classoomph_1_1BlockPreconditioner_a910f9395fa4f5f9bc4d13a9d104c432d}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!operator=@{operator=}}
\index{operator=@{operator=}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{operator=()}{operator=()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::operator= (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1BlockPreconditioner}{Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$ \&}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Broken assignment operator. 



Definition at line 527 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_adec848504d36ebcd8e27ec60f52f75a6}\label{classoomph_1_1BlockPreconditioner_adec848504d36ebcd8e27ec60f52f75a6}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!output\+\_\+blocks\+\_\+to\+\_\+files@{output\+\_\+blocks\+\_\+to\+\_\+files}}
\index{output\+\_\+blocks\+\_\+to\+\_\+files@{output\+\_\+blocks\+\_\+to\+\_\+files}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{output\+\_\+blocks\+\_\+to\+\_\+files()}{output\_blocks\_to\_files()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::output\+\_\+blocks\+\_\+to\+\_\+files (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{basefilename,  }\item[{const unsigned \&}]{precision = {\ttfamily 8} }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}

Output all blocks to numbered files. Called at the end of get blocks if an output filename has been set. 

Definition at line 2126 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_aa760ae71a5aae488547ccf721d412b1e}\label{classoomph_1_1BlockPreconditioner_aa760ae71a5aae488547ccf721d412b1e}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!post\+\_\+block\+\_\+matrix\+\_\+assembly\+\_\+partial\+\_\+clear@{post\+\_\+block\+\_\+matrix\+\_\+assembly\+\_\+partial\+\_\+clear}}
\index{post\+\_\+block\+\_\+matrix\+\_\+assembly\+\_\+partial\+\_\+clear@{post\+\_\+block\+\_\+matrix\+\_\+assembly\+\_\+partial\+\_\+clear}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{post\+\_\+block\+\_\+matrix\+\_\+assembly\+\_\+partial\+\_\+clear()}{post\_block\_matrix\_assembly\_partial\_clear()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::post\+\_\+block\+\_\+matrix\+\_\+assembly\+\_\+partial\+\_\+clear (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



A helper method to reduce the memory requirements of block preconditioners. Once the methods get\+\_\+block(...), get\+\_\+blocks(...) and build\+\_\+preconditioner\+\_\+matrix(...) have been called in this and all subsidiary block preconditioners this method can be called to clean up. 



Definition at line 2151 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a74eeff188f842dd8abdff1b7d9801d44}\label{classoomph_1_1BlockPreconditioner_a74eeff188f842dd8abdff1b7d9801d44}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt@{preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt}}
\index{preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt@{preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt()}{preconditioner\_matrix\_distribution\_pt()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
const \hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution}$\ast$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}



Access function to the preconditioner matrix distribution pointer. This is the concatenation of the block distributions with the identity ordering. I.\+e. if this preconditioner has three block types, with the three associated block distributions dist\+\_\+b0, dist\+\_\+b1 and dist\+\_\+b2, then this distribution is\+: Linear\+Algebra\+Distribution\+Helpers\+::concatenate(dist\+\_\+b0, dist\+\_\+b1, dist\+\_\+b2). 



Definition at line 3311 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_ac8ef0e69b712d9ab7902d277a14ed8f5}\label{classoomph_1_1BlockPreconditioner_ac8ef0e69b712d9ab7902d277a14ed8f5}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!replacement\+\_\+dof\+\_\+block\+\_\+pt@{replacement\+\_\+dof\+\_\+block\+\_\+pt}}
\index{replacement\+\_\+dof\+\_\+block\+\_\+pt@{replacement\+\_\+dof\+\_\+block\+\_\+pt}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{replacement\+\_\+dof\+\_\+block\+\_\+pt()}{replacement\_dof\_block\_pt()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1MapMatrix}{Map\+Matrix}$<$unsigned,\hyperlink{classoomph_1_1CRDoubleMatrix}{C\+R\+Double\+Matrix}$\ast$$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::replacement\+\_\+dof\+\_\+block\+\_\+pt (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Access function to the replaced dof-\/level blocks. 



Definition at line 2413 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a98e920e003f085b02dbb30510fb23a0f}\label{classoomph_1_1BlockPreconditioner_a98e920e003f085b02dbb30510fb23a0f}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!return\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector@{return\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector}}
\index{return\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector@{return\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{return\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector()}{return\_block\_ordered\_preconditioner\_vector()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX $>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::return\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{w,  }\item[{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{v }\end{DoxyParamCaption}) const}



Takes the block ordered vector, w, and reorders it in natural order. Reordered vector is returned in v. Note\+: If the preconditioner is a subsidiary preconditioner then only the components of the vector associated with the blocks of the subsidiary preconditioner will be included. Hence the length of v is \hyperlink{classoomph_1_1BlockPreconditioner_a3e5b553f65e6c25354a5c908d507e8ee}{master\+\_\+nrow()} whereas that of the vector w is of length this-\/$>$\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_a7569556f14fd68b28508920e89bd5eee}{nrow()}. 

This is the return function for the function get\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector(...).

It calls the function return\+\_\+concatenated\+\_\+block\+\_\+vector(...) with the identity block number ordering. 

Definition at line 4981 of file block\+\_\+preconditioner.\+cc.



Referenced by oomph\+::\+Block\+Preconditioner$<$ C\+R\+Double\+Matrix $>$\+::internal\+\_\+return\+\_\+block\+\_\+ordered\+\_\+preconditioner\+\_\+vector().

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a1dd4d3cd6b64fa64e1ff6730b0deecc7}\label{classoomph_1_1BlockPreconditioner_a1dd4d3cd6b64fa64e1ff6730b0deecc7}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!return\+\_\+block\+\_\+vector@{return\+\_\+block\+\_\+vector}}
\index{return\+\_\+block\+\_\+vector@{return\+\_\+block\+\_\+vector}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{return\+\_\+block\+\_\+vector()}{return\_block\_vector()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX $>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::return\+\_\+block\+\_\+vector (\begin{DoxyParamCaption}\item[{const unsigned \&}]{n,  }\item[{const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{b,  }\item[{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{v }\end{DoxyParamCaption}) const}



Takes the n-\/th block ordered vector, b, and copies its entries to the appropriate entries in the naturally ordered vector, v. Here n is the block number in the current block preconditioner. If the preconditioner is a subsidiary block preconditioner the other entries in v that are not associated with it are left alone. 



Definition at line 4436 of file block\+\_\+preconditioner.\+cc.



Referenced by oomph\+::\+Block\+Preconditioner$<$ C\+R\+Double\+Matrix $>$\+::internal\+\_\+return\+\_\+block\+\_\+vector().

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a71d48d8a70151ef0febd4537a2214c53}\label{classoomph_1_1BlockPreconditioner_a71d48d8a70151ef0febd4537a2214c53}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!return\+\_\+block\+\_\+vectors@{return\+\_\+block\+\_\+vectors}}
\index{return\+\_\+block\+\_\+vectors@{return\+\_\+block\+\_\+vectors}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{return\+\_\+block\+\_\+vectors()}{return\_block\_vectors()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX $>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::return\+\_\+block\+\_\+vectors (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \&}]{block\+\_\+vec\+\_\+number,  }\item[{const \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ \&}]{s,  }\item[{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{v }\end{DoxyParamCaption}) const}



Takes the vector of block vectors, s, and copies its entries into the naturally ordered vector, v. If this is a subsidiary block preconditioner only those entries in v that are associated with its blocks are affected. The block\+\_\+vec\+\_\+number indicates which block the vectors in s came from. The block number corresponds to the block numbers in this preconditioner. 



Definition at line 3408 of file block\+\_\+preconditioner.\+cc.



Referenced by oomph\+::\+Block\+Preconditioner$<$ C\+R\+Double\+Matrix $>$\+::internal\+\_\+get\+\_\+block\+\_\+vectors(), and oomph\+::\+Block\+Preconditioner$<$ C\+R\+Double\+Matrix $>$\+::return\+\_\+block\+\_\+vectors().

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a628f3ab6c3c41ccb449da642fb7e1feb}\label{classoomph_1_1BlockPreconditioner_a628f3ab6c3c41ccb449da642fb7e1feb}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!return\+\_\+block\+\_\+vectors@{return\+\_\+block\+\_\+vectors}}
\index{return\+\_\+block\+\_\+vectors@{return\+\_\+block\+\_\+vectors}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{return\+\_\+block\+\_\+vectors()}{return\_block\_vectors()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX $>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::return\+\_\+block\+\_\+vectors (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} $>$ \&}]{s,  }\item[{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{v }\end{DoxyParamCaption}) const}



Takes the vector of block vectors, s, and copies its entries into the naturally ordered vector, v. If this is a subsidiary block preconditioner only those entries in v that are associated with its blocks are affected. The block\+\_\+vec\+\_\+number indicates which block the vectors in s came from. The block number corresponds to the block numbers in this preconditioner. This is simply a wrapper around the other return\+\_\+block\+\_\+vectors(...) function where the block\+\_\+vec\+\_\+number \hyperlink{classoomph_1_1Vector}{Vector} is the identity, i.\+e. block\+\_\+vec\+\_\+number is \mbox{[}0, 1, ..., nblock\+\_\+types -\/ 1\mbox{]}. 



Definition at line 3631 of file block\+\_\+preconditioner.\+cc.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a6d5106c0b9dca23aa1cc7f7fd8e696cb}\label{classoomph_1_1BlockPreconditioner_a6d5106c0b9dca23aa1cc7f7fd8e696cb}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!return\+\_\+concatenated\+\_\+block\+\_\+vector@{return\+\_\+concatenated\+\_\+block\+\_\+vector}}
\index{return\+\_\+concatenated\+\_\+block\+\_\+vector@{return\+\_\+concatenated\+\_\+block\+\_\+vector}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{return\+\_\+concatenated\+\_\+block\+\_\+vector()}{return\_concatenated\_block\_vector()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX $>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::return\+\_\+concatenated\+\_\+block\+\_\+vector (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \&}]{block\+\_\+vec\+\_\+number,  }\item[{const \hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{b,  }\item[{\hyperlink{classoomph_1_1DoubleVector}{Double\+Vector} \&}]{v }\end{DoxyParamCaption}) const}



Takes concatenated block ordered vector, b, and copies its entries to the appropriate entries in the naturally ordered vector, v. Here the values in block\+\_\+vec\+\_\+number indicates which blocks the vector b is a concatenation of. The block number are those in the current preconditioner. If the preconditioner is a subsidiary block preconditioner the other entries in v that are not associated with it are left alone. 

Takes concatenated block ordered vector, b, and copies its. 

Definition at line 2742 of file block\+\_\+preconditioner.\+cc.



Referenced by oomph\+::\+Block\+Preconditioner$<$ C\+R\+Double\+Matrix $>$\+::get\+\_\+concatenated\+\_\+block\+\_\+vector().

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_ab36e905f7da268328709d62951d64ace}\label{classoomph_1_1BlockPreconditioner_ab36e905f7da268328709d62951d64ace}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!set\+\_\+block\+\_\+output\+\_\+to\+\_\+files@{set\+\_\+block\+\_\+output\+\_\+to\+\_\+files}}
\index{set\+\_\+block\+\_\+output\+\_\+to\+\_\+files@{set\+\_\+block\+\_\+output\+\_\+to\+\_\+files}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{set\+\_\+block\+\_\+output\+\_\+to\+\_\+files()}{set\_block\_output\_to\_files()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::set\+\_\+block\+\_\+output\+\_\+to\+\_\+files (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{basefilename }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Set the base part of the filename to output blocks to. If it is set then all blocks will be output at the end of block\+\_\+setup. If it is left empty nothing will be output. 



Definition at line 2107 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a748e2ad8836bc8edf5b9a42373a7ad61}\label{classoomph_1_1BlockPreconditioner_a748e2ad8836bc8edf5b9a42373a7ad61}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!set\+\_\+master\+\_\+matrix\+\_\+pt@{set\+\_\+master\+\_\+matrix\+\_\+pt}}
\index{set\+\_\+master\+\_\+matrix\+\_\+pt@{set\+\_\+master\+\_\+matrix\+\_\+pt}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{set\+\_\+master\+\_\+matrix\+\_\+pt()}{set\_master\_matrix\_pt()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::set\+\_\+master\+\_\+matrix\+\_\+pt (\begin{DoxyParamCaption}\item[{M\+A\+T\+R\+IX $\ast$}]{in\+\_\+matrix\+\_\+pt }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Set the matrix\+\_\+pt in the upper-\/most master preconditioner. 



Definition at line 1013 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_af97821621b570d409e6662939e5f818d}\label{classoomph_1_1BlockPreconditioner_af97821621b570d409e6662939e5f818d}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!set\+\_\+mesh@{set\+\_\+mesh}}
\index{set\+\_\+mesh@{set\+\_\+mesh}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{set\+\_\+mesh()}{set\_mesh()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::set\+\_\+mesh (\begin{DoxyParamCaption}\item[{const unsigned \&}]{i,  }\item[{const \hyperlink{classoomph_1_1Mesh}{Mesh} $\ast$const}]{mesh\+\_\+pt,  }\item[{const bool \&}]{allow\+\_\+multiple\+\_\+element\+\_\+type\+\_\+in\+\_\+mesh = {\ttfamily false} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}



Set the i-\/th mesh for this block preconditioner. Note\+: The method set\+\_\+nmesh(...) must be called before this method to specify the number of meshes. By default, it is assumed that each mesh only contains elements of the same type. This condition may be relaxed by setting the boolean allow\+\_\+multiple\+\_\+element\+\_\+type\+\_\+in\+\_\+mesh to true, however, each mesh must only contain elements with the same number of dof types. 



Definition at line 2903 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_ae055f998f6145656352aacac22e545ad}\label{classoomph_1_1BlockPreconditioner_ae055f998f6145656352aacac22e545ad}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!set\+\_\+nmesh@{set\+\_\+nmesh}}
\index{set\+\_\+nmesh@{set\+\_\+nmesh}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{set\+\_\+nmesh()}{set\_nmesh()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::set\+\_\+nmesh (\begin{DoxyParamCaption}\item[{const unsigned \&}]{n }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}



Specify the number of meshes required by this block preconditioner. Note\+: elements in different meshes correspond to different types of D\+OF. 



Definition at line 2888 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a8a0ae880f098d5b1e9df78fc74c31dbf}\label{classoomph_1_1BlockPreconditioner_a8a0ae880f098d5b1e9df78fc74c31dbf}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!set\+\_\+replacement\+\_\+dof\+\_\+block@{set\+\_\+replacement\+\_\+dof\+\_\+block}}
\index{set\+\_\+replacement\+\_\+dof\+\_\+block@{set\+\_\+replacement\+\_\+dof\+\_\+block}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{set\+\_\+replacement\+\_\+dof\+\_\+block()}{set\_replacement\_dof\_block()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::set\+\_\+replacement\+\_\+dof\+\_\+block (\begin{DoxyParamCaption}\item[{const unsigned \&}]{block\+\_\+i,  }\item[{const unsigned \&}]{block\+\_\+j,  }\item[{\hyperlink{classoomph_1_1CRDoubleMatrix}{C\+R\+Double\+Matrix} $\ast$}]{replacement\+\_\+dof\+\_\+block\+\_\+pt }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}



Set replacement dof-\/level blocks. Only dof-\/level blocks can be set. This is important due to how the dof type coarsening feature operates. 

I\+M\+P\+O\+R\+T\+A\+NT\+: The block indices (block\+\_\+i, block\+\_\+j) is the dof-\/level ordering, N\+OT the block-\/ordering. The block-\/ordering is determined by the parameters given to block\+\_\+setup(...). The D\+O\+F-\/ordering is determined by the two-\/level ordering scheme of first the elements, then the meshes. 

Definition at line 2950 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_adbe1ae854ee9831649249d50162bb6a9}\label{classoomph_1_1BlockPreconditioner_adbe1ae854ee9831649249d50162bb6a9}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!setup\+\_\+matrix\+\_\+vector\+\_\+product@{setup\+\_\+matrix\+\_\+vector\+\_\+product}}
\index{setup\+\_\+matrix\+\_\+vector\+\_\+product@{setup\+\_\+matrix\+\_\+vector\+\_\+product}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{setup\+\_\+matrix\+\_\+vector\+\_\+product()}{setup\_matrix\_vector\_product()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::setup\+\_\+matrix\+\_\+vector\+\_\+product (\begin{DoxyParamCaption}\item[{\hyperlink{classoomph_1_1MatrixVectorProduct}{Matrix\+Vector\+Product} $\ast$}]{matvec\+\_\+prod\+\_\+pt,  }\item[{\hyperlink{classoomph_1_1CRDoubleMatrix}{C\+R\+Double\+Matrix} $\ast$}]{block\+\_\+pt,  }\item[{const \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \&}]{block\+\_\+col\+\_\+indices }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Setup a matrix vector product. matvec\+\_\+prod\+\_\+pt is a pointer to the \hyperlink{classoomph_1_1MatrixVectorProduct}{Matrix\+Vector\+Product}, block\+\_\+pt is a pointer to the block matrix, block\+\_\+col\+\_\+indices is a vector indicating which block indices does the R\+HS vector we want to multiply the matrix by. 

The distribution of the block column must be the same as the R\+HS vector being solved. By default, O\+O\+M\+P\+H-\/\+L\+IB\textquotesingle{}s uniform row distribution is employed. When block matrices are concatenated without communication, the columns are permuted, as a result, the distribution of the columns may no longer be uniform. 

Definition at line 2429 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a65059c036724814a0e490716fa6eaf0a}\label{classoomph_1_1BlockPreconditioner_a65059c036724814a0e490716fa6eaf0a}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!setup\+\_\+matrix\+\_\+vector\+\_\+product@{setup\+\_\+matrix\+\_\+vector\+\_\+product}}
\index{setup\+\_\+matrix\+\_\+vector\+\_\+product@{setup\+\_\+matrix\+\_\+vector\+\_\+product}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{setup\+\_\+matrix\+\_\+vector\+\_\+product()}{setup\_matrix\_vector\_product()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::setup\+\_\+matrix\+\_\+vector\+\_\+product (\begin{DoxyParamCaption}\item[{\hyperlink{classoomph_1_1MatrixVectorProduct}{Matrix\+Vector\+Product} $\ast$}]{matvec\+\_\+prod\+\_\+pt,  }\item[{\hyperlink{classoomph_1_1CRDoubleMatrix}{C\+R\+Double\+Matrix} $\ast$}]{block\+\_\+pt,  }\item[{const unsigned \&}]{block\+\_\+col\+\_\+index }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Setup matrix vector product. This is simply a wrapper around the other setup\+\_\+matrix\+\_\+vector\+\_\+product function. 



Definition at line 2470 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_ab8e2478caa8370dd12462f17e1cc8082}\label{classoomph_1_1BlockPreconditioner_ab8e2478caa8370dd12462f17e1cc8082}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!turn\+\_\+into\+\_\+subsidiary\+\_\+block\+\_\+preconditioner@{turn\+\_\+into\+\_\+subsidiary\+\_\+block\+\_\+preconditioner}}
\index{turn\+\_\+into\+\_\+subsidiary\+\_\+block\+\_\+preconditioner@{turn\+\_\+into\+\_\+subsidiary\+\_\+block\+\_\+preconditioner}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{turn\+\_\+into\+\_\+subsidiary\+\_\+block\+\_\+preconditioner()}{turn\_into\_subsidiary\_block\_preconditioner()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::turn\+\_\+into\+\_\+subsidiary\+\_\+block\+\_\+preconditioner (\begin{DoxyParamCaption}\item[{\hyperlink{classoomph_1_1BlockPreconditioner}{Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$ $\ast$}]{master\+\_\+block\+\_\+prec\+\_\+pt,  }\item[{const \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \&}]{doftype\+\_\+in\+\_\+master\+\_\+preconditioner\+\_\+coarse }\end{DoxyParamCaption})}



Function to turn this preconditioner into a subsidiary preconditioner that operates within a bigger "master block preconditioner (e.\+g. a Navier-\/\+Stokes 2x2 block preconditioner dealing with the fluid sub-\/blocks within a 3x3 F\+SI preconditioner. Once this is done the master block preconditioner deals with the block setup etc. The vector doftype\+\_\+in\+\_\+master\+\_\+preconditioner\+\_\+coarse must specify the dof number in the master preconditioner that corresponds to a dof number in this preconditioner. {\bfseries 1}. The length of the vector is used to determine the number of blocks in this preconditioner therefore it must be correctly sized. {\bfseries 2}. block\+\_\+setup(...) should be called in the master preconditioner before this method is called. {\bfseries 3}. block\+\_\+setup(...) should be called in the corresponding subsidiary preconditioner after this method is called. 

Function to turn this preconditioner into a subsidiary preconditioner that operates within a bigger "master block preconditioner (e.\+g. a Navier-\/\+Stokes 2x2 block preconditioner dealing with the fluid sub-\/blocks within a 3x3 F\+SI preconditioner. Once this is done the master block preconditioner deals with the block setup etc. The vector block\+\_\+map must specify the dof number in the master preconditioner that corresponds to a block number in this preconditioner. ??ds horribly misleading comment! The length of the vector is used to determine the number of blocks in this preconditioner therefore it must be correctly sized. This calls the other turn\+\_\+into\+\_\+subsidiary\+\_\+block\+\_\+preconditioner(...) function providing an empty doftype\+\_\+to\+\_\+doftype\+\_\+map vector.

This calls the other turn\+\_\+into\+\_\+subsidiary\+\_\+block\+\_\+preconditioner function with the identity mapping for doftype\+\_\+coarsen\+\_\+map\+\_\+coarse vector. 

Definition at line 2330 of file block\+\_\+preconditioner.\+cc.



Referenced by oomph\+::\+Block\+Preconditioner$<$ C\+R\+Double\+Matrix $>$\+::block\+\_\+setup(), oomph\+::\+Pseudo\+Elastic\+F\+S\+I\+Preconditioner\+::setup(), oomph\+::\+Pseudo\+Elastic\+Preconditioner\+::setup(), oomph\+::\+Lagrange\+Enforced\+Flow\+Preconditioner\+::setup(), oomph\+::\+Pseudo\+Elastic\+Preconditioner\+Old\+::setup(), and oomph\+::\+Block\+Preconditioner$<$ C\+R\+Double\+Matrix $>$\+::turn\+\_\+into\+\_\+subsidiary\+\_\+block\+\_\+preconditioner().

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_ae9282acaaf19fa2cdb703d49f1a8de25}\label{classoomph_1_1BlockPreconditioner_ae9282acaaf19fa2cdb703d49f1a8de25}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!turn\+\_\+into\+\_\+subsidiary\+\_\+block\+\_\+preconditioner@{turn\+\_\+into\+\_\+subsidiary\+\_\+block\+\_\+preconditioner}}
\index{turn\+\_\+into\+\_\+subsidiary\+\_\+block\+\_\+preconditioner@{turn\+\_\+into\+\_\+subsidiary\+\_\+block\+\_\+preconditioner}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{turn\+\_\+into\+\_\+subsidiary\+\_\+block\+\_\+preconditioner()}{turn\_into\_subsidiary\_block\_preconditioner()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::turn\+\_\+into\+\_\+subsidiary\+\_\+block\+\_\+preconditioner (\begin{DoxyParamCaption}\item[{\hyperlink{classoomph_1_1BlockPreconditioner}{Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$ $\ast$}]{master\+\_\+block\+\_\+prec\+\_\+pt,  }\item[{const \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ \&}]{doftype\+\_\+in\+\_\+master\+\_\+preconditioner\+\_\+coarse,  }\item[{const \hyperlink{classoomph_1_1Vector}{Vector}$<$ \hyperlink{classoomph_1_1Vector}{Vector}$<$ unsigned $>$ $>$ \&}]{doftype\+\_\+coarsen\+\_\+map\+\_\+coarse }\end{DoxyParamCaption})}



Function to turn this preconditioner into a subsidiary preconditioner that operates within a bigger "master block preconditioner (e.\+g. a Navier-\/\+Stokes 2x2 block preconditioner dealing with the fluid sub-\/blocks within a 3x3 F\+SI preconditioner. Once this is done the master block preconditioner deals with the block setup etc. The vector doftype\+\_\+in\+\_\+master\+\_\+preconditioner\+\_\+coarse must specify the dof number in the master preconditioner that corresponds to a dof number in this preconditioner. {\bfseries 1}. The length of the vector is used to determine the number of blocks in this preconditioner therefore it must be correctly sized. {\bfseries 2}. block\+\_\+setup(...) should be called in the master preconditioner before this method is called. {\bfseries 3}. block\+\_\+setup(...) should be called in the corresponding subsidiary preconditioner after this method is called. 

Function to turn this block preconditioner into a subsidiary block preconditioner that operates within a bigger master block preconditioner (e.\+g. a Navier-\/\+Stokes 2x2 block preconditioner dealing with the fluid sub-\/blocks within a 3x3 F\+SI preconditioner. Once this is done the master block preconditioner deals with the block setup etc.

The doftype\+\_\+coarsen\+\_\+map\+\_\+coarse is a mapping of the dof numbers in the master preconditioner to the dof numbers R\+E\+Q\+U\+I\+R\+ED by T\+H\+IS preconditioner. This allows for coarsening of the dof types if the master preconditioner has a more fine grain dof type splitting.

For example, the Lagrangian preconditioner (in 3D with one constraint) has doftypes\+: 0 1 2 3 4 5 6 7 ub vb wb uc vc wc p Lc

We wish to use an existing Navier-\/\+Stokes preconditioner, for example, L\+SC, to solve the sub-\/system associated with the dof numbers 0, 1, 2, 3, 4, 5, 6. But the existing L\+SC preconditioner only works with four dof types (3 velocity dof types and 1 pressure dof types). We need to coarsen the number of dof types in the master preconditioner.

If the L\+SC preconditioner requires the dof ordering\+: u, v, w, p. Then the doftype\+\_\+coarsen\+\_\+map\+\_\+coarse will be\+: \mbox{[}0 3\mbox{]} -\/$>$ u velocity dof type \mbox{[}1 4\mbox{]} -\/$>$ v velocity dof type \mbox{[}2 5\mbox{]} -\/$>$ w velocity dof type \mbox{[}6\mbox{]} -\/$>$ pressure dof type.

The vector doftype\+\_\+map must specify the dof type in the master preconditioner that corresponds to a dof type in this block preconditioner.

In general, we want\+: doftype\+\_\+map\mbox{[}doftype in subsidiary prec\mbox{]} = doftype in master prec.

It tells this block preconditioner which dof types of the master block preconditioner it is working with.

The length of the vector is used to determine the number of dof types in T\+H\+IS block preconditioner therefore it must be correctly sized.

For example, let the master block preconditioner have 5 dof types in total and a 1-\/4 dof type splitting where the block (0,0) corresponds to dof type 0 and the block (1,1) corresponds to dof types 1, 2, 3 and 4 (i.\+e. it would have given to block\+\_\+setup the vector \mbox{[}0,1,1,1,1\mbox{]}). Furthermore, it solves (1,1) block with subsidiary block preconditioner. Then the doftype\+\_\+map passed to this function of the subsidiary block preconditioner would be \mbox{[}1, 2, 3, 4\mbox{]}.

Dof type coarsening (following on from the example above)\+: Let the subsidiary block preconditioner (T\+H\+IS block preconditioner) only works with two D\+OF types, then the master block preconditioner must \char`\"{}coarsen\char`\"{} the dof types by providing the optional argument doftype\+\_\+coarsen\+\_\+map vector.

The doftype\+\_\+coarsen\+\_\+map vector (in this case) might be \mbox{[}\mbox{[}0,1\mbox{]}, \mbox{[}2,3\mbox{]}\mbox{]} telling the subsidiary block preconditioner that the S\+U\+B\+S\+I\+D\+I\+A\+RY dof types 0 and 1 should be treated as dof type 0 and the subsidiary dof types 2 and 3 should be treated as subsidiary dof type 1.

If no doftype\+\_\+coarsen\+\_\+map vector is provided, then the identity is used automatically (see the turn\+\_\+into\+\_\+subsidiary\+\_\+block\+\_\+preconditioner(...) function with only two arguments). In the above case, the identity doftype\+\_\+coarsen\+\_\+map vector for the subsidiary block preconditioner would be the 2D vector \mbox{[}\mbox{[}0\mbox{]}, \mbox{[}1\mbox{]}, \mbox{[}2\mbox{]}, \mbox{[}3\mbox{]}\mbox{]} which means dof type 0 is treated as dof type 0, dof type 1 is treated as dof type 1, dof type 2 is treated as dof type 2, and dof type 3 is treated as dof type 3. 

Definition at line 2408 of file block\+\_\+preconditioner.\+cc.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a46c57c6a2f4b54e27d2aaccc4ec90665}\label{classoomph_1_1BlockPreconditioner_a46c57c6a2f4b54e27d2aaccc4ec90665}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!turn\+\_\+off\+\_\+debug\+\_\+flag@{turn\+\_\+off\+\_\+debug\+\_\+flag}}
\index{turn\+\_\+off\+\_\+debug\+\_\+flag@{turn\+\_\+off\+\_\+debug\+\_\+flag}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{turn\+\_\+off\+\_\+debug\+\_\+flag()}{turn\_off\_debug\_flag()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::turn\+\_\+off\+\_\+debug\+\_\+flag (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Toggles off the debug flag. 



Definition at line 586 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a8ed741a5fbf514fc29f0a332a211255f}\label{classoomph_1_1BlockPreconditioner_a8ed741a5fbf514fc29f0a332a211255f}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!turn\+\_\+off\+\_\+recursive\+\_\+debug\+\_\+flag@{turn\+\_\+off\+\_\+recursive\+\_\+debug\+\_\+flag}}
\index{turn\+\_\+off\+\_\+recursive\+\_\+debug\+\_\+flag@{turn\+\_\+off\+\_\+recursive\+\_\+debug\+\_\+flag}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{turn\+\_\+off\+\_\+recursive\+\_\+debug\+\_\+flag()}{turn\_off\_recursive\_debug\_flag()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::turn\+\_\+off\+\_\+recursive\+\_\+debug\+\_\+flag (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Toggles off the recursive debug flag. The change goes up the block preconditioning hierarchy. 



Definition at line 571 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a271bf5ea70579e43797187498d98f9a9}\label{classoomph_1_1BlockPreconditioner_a271bf5ea70579e43797187498d98f9a9}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!turn\+\_\+on\+\_\+debug\+\_\+flag@{turn\+\_\+on\+\_\+debug\+\_\+flag}}
\index{turn\+\_\+on\+\_\+debug\+\_\+flag@{turn\+\_\+on\+\_\+debug\+\_\+flag}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{turn\+\_\+on\+\_\+debug\+\_\+flag()}{turn\_on\_debug\_flag()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::turn\+\_\+on\+\_\+debug\+\_\+flag (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Toggles on the debug flag. 



Definition at line 580 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a0d977a81515458e59b94438a215e93e1}\label{classoomph_1_1BlockPreconditioner_a0d977a81515458e59b94438a215e93e1}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!turn\+\_\+on\+\_\+recursive\+\_\+debug\+\_\+flag@{turn\+\_\+on\+\_\+recursive\+\_\+debug\+\_\+flag}}
\index{turn\+\_\+on\+\_\+recursive\+\_\+debug\+\_\+flag@{turn\+\_\+on\+\_\+recursive\+\_\+debug\+\_\+flag}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{turn\+\_\+on\+\_\+recursive\+\_\+debug\+\_\+flag()}{turn\_on\_recursive\_debug\_flag()}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
void \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::turn\+\_\+on\+\_\+recursive\+\_\+debug\+\_\+flag (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Toggles on the recursive debug flag. The change goes up the block preconditioning hierarchy. 



Definition at line 561 of file block\+\_\+preconditioner.\+h.



\subsection{Member Data Documentation}
\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a2f3a3ac8c192a83facd5b560f017413e}\label{classoomph_1_1BlockPreconditioner_a2f3a3ac8c192a83facd5b560f017413e}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Allow\+\_\+multiple\+\_\+element\+\_\+type\+\_\+in\+\_\+mesh@{Allow\+\_\+multiple\+\_\+element\+\_\+type\+\_\+in\+\_\+mesh}}
\index{Allow\+\_\+multiple\+\_\+element\+\_\+type\+\_\+in\+\_\+mesh@{Allow\+\_\+multiple\+\_\+element\+\_\+type\+\_\+in\+\_\+mesh}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Allow\+\_\+multiple\+\_\+element\+\_\+type\+\_\+in\+\_\+mesh}{Allow\_multiple\_element\_type\_in\_mesh}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$unsigned$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Allow\+\_\+multiple\+\_\+element\+\_\+type\+\_\+in\+\_\+mesh\hspace{0.3cm}{\ttfamily [protected]}}



\hyperlink{classoomph_1_1Vector}{Vector} of unsigned to indicate which meshes contain multiple element types. 



Definition at line 3388 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a555ed672f4bcc8fcf72806154fd3ce0b}\label{classoomph_1_1BlockPreconditioner_a555ed672f4bcc8fcf72806154fd3ce0b}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Auxiliary\+\_\+block\+\_\+distribution\+\_\+pt@{Auxiliary\+\_\+block\+\_\+distribution\+\_\+pt}}
\index{Auxiliary\+\_\+block\+\_\+distribution\+\_\+pt@{Auxiliary\+\_\+block\+\_\+distribution\+\_\+pt}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Auxiliary\+\_\+block\+\_\+distribution\+\_\+pt}{Auxiliary\_block\_distribution\_pt}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
std\+::map$<$\hyperlink{classoomph_1_1Vector}{Vector}$<$unsigned$>$,\hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution}$\ast$$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Auxiliary\+\_\+block\+\_\+distribution\+\_\+pt\hspace{0.3cm}{\ttfamily [private]}}



Stores any block-\/level distributions / concatenation of block-\/level distributions required. The first in the pair (\hyperlink{classoomph_1_1Vector}{Vector$<$unsigned$>$}) represents the block numbers of the distributions concatenated to get the second in the pair (Linear\+Algebra\+Distribution$\ast$). 



Definition at line 3431 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a59e83eca59e3cdc41a93668539e138f1}\label{classoomph_1_1BlockPreconditioner_a59e83eca59e3cdc41a93668539e138f1}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Block\+\_\+distribution\+\_\+pt@{Block\+\_\+distribution\+\_\+pt}}
\index{Block\+\_\+distribution\+\_\+pt@{Block\+\_\+distribution\+\_\+pt}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Block\+\_\+distribution\+\_\+pt}{Block\_distribution\_pt}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$\hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution}$\ast$$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Block\+\_\+distribution\+\_\+pt\hspace{0.3cm}{\ttfamily [protected]}}



The distribution for the blocks. 



Definition at line 3320 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a61561c20a262195f1bdacda515a2394b}\label{classoomph_1_1BlockPreconditioner_a61561c20a262195f1bdacda515a2394b}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Block\+\_\+number\+\_\+to\+\_\+dof\+\_\+number\+\_\+lookup@{Block\+\_\+number\+\_\+to\+\_\+dof\+\_\+number\+\_\+lookup}}
\index{Block\+\_\+number\+\_\+to\+\_\+dof\+\_\+number\+\_\+lookup@{Block\+\_\+number\+\_\+to\+\_\+dof\+\_\+number\+\_\+lookup}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Block\+\_\+number\+\_\+to\+\_\+dof\+\_\+number\+\_\+lookup}{Block\_number\_to\_dof\_number\_lookup}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$\hyperlink{classoomph_1_1Vector}{Vector}$<$unsigned$>$ $>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Block\+\_\+number\+\_\+to\+\_\+dof\+\_\+number\+\_\+lookup\hspace{0.3cm}{\ttfamily [private]}}



\hyperlink{classoomph_1_1Vector}{Vector} of vectors to store the mapping from block number to the D\+OF number (each element could be a vector because we allow multiple D\+O\+Fs types in a single block). 



Definition at line 3512 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_ae047d81b8179dfd09b70cf35f40f62ca}\label{classoomph_1_1BlockPreconditioner_ae047d81b8179dfd09b70cf35f40f62ca}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Block\+\_\+to\+\_\+dof\+\_\+map\+\_\+coarse@{Block\+\_\+to\+\_\+dof\+\_\+map\+\_\+coarse}}
\index{Block\+\_\+to\+\_\+dof\+\_\+map\+\_\+coarse@{Block\+\_\+to\+\_\+dof\+\_\+map\+\_\+coarse}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Block\+\_\+to\+\_\+dof\+\_\+map\+\_\+coarse}{Block\_to\_dof\_map\_coarse}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$\hyperlink{classoomph_1_1Vector}{Vector}$<$unsigned$>$ $>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Block\+\_\+to\+\_\+dof\+\_\+map\+\_\+coarse\hspace{0.3cm}{\ttfamily [protected]}}



Mapping for block types to dof types. These are the dof types the writer of the preconditioner expects. For the upper-\/most master block preconditioner, this would be the sum of the dof types in the meshes. For subsidiary block preconditioners, this is determined by the parent preconditioner when passing in the doftype\+\_\+coarsen\+\_\+map\+\_\+coarse vector in turn\+\_\+into\+\_\+subsidiary\+\_\+block\+\_\+preconditioner(...). 



Definition at line 3328 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a278946969944848b12bdc2ceaed91a07}\label{classoomph_1_1BlockPreconditioner_a278946969944848b12bdc2ceaed91a07}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Block\+\_\+to\+\_\+dof\+\_\+map\+\_\+fine@{Block\+\_\+to\+\_\+dof\+\_\+map\+\_\+fine}}
\index{Block\+\_\+to\+\_\+dof\+\_\+map\+\_\+fine@{Block\+\_\+to\+\_\+dof\+\_\+map\+\_\+fine}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Block\+\_\+to\+\_\+dof\+\_\+map\+\_\+fine}{Block\_to\_dof\_map\_fine}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$\hyperlink{classoomph_1_1Vector}{Vector}$<$unsigned$>$ $>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Block\+\_\+to\+\_\+dof\+\_\+map\+\_\+fine\hspace{0.3cm}{\ttfamily [protected]}}



Mapping for the block types to the most fine grain dof types. 



Definition at line 3331 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_ab4647ea06ca7cf44c8de695ba35f3e97}\label{classoomph_1_1BlockPreconditioner_ab4647ea06ca7cf44c8de695ba35f3e97}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Debug\+\_\+flag@{Debug\+\_\+flag}}
\index{Debug\+\_\+flag@{Debug\+\_\+flag}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Debug\+\_\+flag}{Debug\_flag}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
bool \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Debug\+\_\+flag\hspace{0.3cm}{\ttfamily [private]}}



Debugging variable. Set true or false via the access functions turn\+\_\+on\+\_\+debug\+\_\+flag(...) turn\+\_\+off\+\_\+debug\+\_\+flag(...) 



Definition at line 3424 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a21867eb330dd1177c530a590ad1fa571}\label{classoomph_1_1BlockPreconditioner_a21867eb330dd1177c530a590ad1fa571}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Dof\+\_\+block\+\_\+distribution\+\_\+pt@{Dof\+\_\+block\+\_\+distribution\+\_\+pt}}
\index{Dof\+\_\+block\+\_\+distribution\+\_\+pt@{Dof\+\_\+block\+\_\+distribution\+\_\+pt}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Dof\+\_\+block\+\_\+distribution\+\_\+pt}{Dof\_block\_distribution\_pt}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$\hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution}$\ast$$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Dof\+\_\+block\+\_\+distribution\+\_\+pt\hspace{0.3cm}{\ttfamily [protected]}}



Storage for the default distribution for each dof block at this level. 



Definition at line 3384 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a55900a517c9e354b9fc49624483b7273}\label{classoomph_1_1BlockPreconditioner_a55900a517c9e354b9fc49624483b7273}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Dof\+\_\+dimension@{Dof\+\_\+dimension}}
\index{Dof\+\_\+dimension@{Dof\+\_\+dimension}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Dof\+\_\+dimension}{Dof\_dimension}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$unsigned$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Dof\+\_\+dimension\hspace{0.3cm}{\ttfamily [private]}}



\hyperlink{classoomph_1_1Vector}{Vector} containing the size of each block, i.\+e. the number of global D\+O\+Fs associated with it. (Empty if this preconditioner has a master preconditioner as this information is obtain from the master preconditioner.) 



Definition at line 3501 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a37b22a0a25030a4b08f2eaec261ae22b}\label{classoomph_1_1BlockPreconditioner_a37b22a0a25030a4b08f2eaec261ae22b}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Dof\+\_\+number\+\_\+dense@{Dof\+\_\+number\+\_\+dense}}
\index{Dof\+\_\+number\+\_\+dense@{Dof\+\_\+number\+\_\+dense}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Dof\+\_\+number\+\_\+dense}{Dof\_number\_dense}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$unsigned$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Dof\+\_\+number\+\_\+dense\hspace{0.3cm}{\ttfamily [private]}}



\hyperlink{classoomph_1_1Vector}{Vector} to store the mapping from the global D\+OF number to its block. Empty if this preconditioner has a master preconditioner, in this case the information is obtained from the master preconditioner. 



Definition at line 3464 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a5a6adc0423ef4d31562d149324c4a679}\label{classoomph_1_1BlockPreconditioner_a5a6adc0423ef4d31562d149324c4a679}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Dof\+\_\+number\+\_\+sparse@{Dof\+\_\+number\+\_\+sparse}}
\index{Dof\+\_\+number\+\_\+sparse@{Dof\+\_\+number\+\_\+sparse}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Dof\+\_\+number\+\_\+sparse}{Dof\_number\_sparse}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$unsigned$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Dof\+\_\+number\+\_\+sparse\hspace{0.3cm}{\ttfamily [private]}}



\hyperlink{classoomph_1_1Vector}{Vector} to store the mapping from the global D\+OF number to its block (empty if this preconditioner has a master preconditioner as this information is obtained from the master preconditioner). Sparse version\+: for global indices outside of the range this-\/$>$\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_ab00a3919b8634c698749f14a4d92947d}{first\+\_\+row()} to this-\/$>$\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_ab00a3919b8634c698749f14a4d92947d}{first\+\_\+row()}+this-\/$>$\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_a9bd7e1d242c69a28da85a804a7717fce}{nrow\+\_\+local()}. The global index of an element in this vector is defined in Global\+\_\+index\+\_\+sparse. 



Definition at line 3494 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_ae2f496bfa8307485101a3b8ac57e8c71}\label{classoomph_1_1BlockPreconditioner_ae2f496bfa8307485101a3b8ac57e8c71}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Dof\+\_\+number\+\_\+to\+\_\+block\+\_\+number\+\_\+lookup@{Dof\+\_\+number\+\_\+to\+\_\+block\+\_\+number\+\_\+lookup}}
\index{Dof\+\_\+number\+\_\+to\+\_\+block\+\_\+number\+\_\+lookup@{Dof\+\_\+number\+\_\+to\+\_\+block\+\_\+number\+\_\+lookup}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Dof\+\_\+number\+\_\+to\+\_\+block\+\_\+number\+\_\+lookup}{Dof\_number\_to\_block\_number\_lookup}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$unsigned$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Dof\+\_\+number\+\_\+to\+\_\+block\+\_\+number\+\_\+lookup\hspace{0.3cm}{\ttfamily [private]}}



\hyperlink{classoomph_1_1Vector}{Vector} to the mapping from D\+OF number to block number. 



Definition at line 3515 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a015ba85d839a80512c6c4065e39a3d4a}\label{classoomph_1_1BlockPreconditioner_a015ba85d839a80512c6c4065e39a3d4a}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Doftype\+\_\+coarsen\+\_\+map\+\_\+coarse@{Doftype\+\_\+coarsen\+\_\+map\+\_\+coarse}}
\index{Doftype\+\_\+coarsen\+\_\+map\+\_\+coarse@{Doftype\+\_\+coarsen\+\_\+map\+\_\+coarse}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Doftype\+\_\+coarsen\+\_\+map\+\_\+coarse}{Doftype\_coarsen\_map\_coarse}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$\hyperlink{classoomph_1_1Vector}{Vector}$<$unsigned$>$ $>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Doftype\+\_\+coarsen\+\_\+map\+\_\+coarse\hspace{0.3cm}{\ttfamily [protected]}}



Mapping for dof types within T\+H\+IS precondition. This is usually passed down from the parent preconditioner. This list is used to tell which does types should be considered as a single dof type within this preconditioner. I.\+e. we \char`\"{}coarsen\char`\"{} the dof types. The values are local to this preconditioner, for example, even if the Doftype\+\_\+in\+\_\+master\+\_\+preconditioner\+\_\+coarse = \mbox{[}2,3,4\mbox{]}, the vector Doftype\+\_\+coarsen\+\_\+map\+\_\+coarse = \mbox{[}\mbox{[}0\mbox{]},\mbox{[}1,2\mbox{]}\mbox{]}, saying your local dof types 0 should be considered as dof type 0 and dof types 1 and 2 are considered as dof type 1. 

Furthermore, the dof types are that the preconditioner above this one knows; these dof types may or may not be coarsened. For example, say that this preconditioner expects two dof types, 0 and 1. The preconditioner above this one wishes to use this preconditioner to solve the block associated with it\textquotesingle{}s dof types 2, 3 and 4. It passes the \hyperlink{classoomph_1_1Vector}{Vector} \mbox{[}2,3,4\mbox{]} to this preconditioner via the function turn\+\_\+into\+\_\+subsidiary\+\_\+block\+\_\+preconditioner(...), this list is to be stored in Doftype\+\_\+in\+\_\+master\+\_\+preconditioner\+\_\+coarse. It also passes in the 2D vector \mbox{[}\mbox{[}0\mbox{]}\mbox{[}1,2\mbox{]}\mbox{]} (as described above), this list is to be stored in Doftype\+\_\+coarsen\+\_\+map\+\_\+coarse. B\+UT, the master\textquotesingle{}s preconditioner dof types may also be coarsened. I.\+e. the underlying dof types of the master block preconditioner may be \mbox{[}0,1,2,3,4,5,6,7\mbox{]}, for which it may have the Doftype\+\_\+coarsen\+\_\+map\+\_\+coarse = \mbox{[}\mbox{[}0,1\mbox{]}\mbox{[}2,3\mbox{]}\mbox{[}4,5\mbox{]}\mbox{[}6,7\mbox{]}\mbox{]}.

An additional list has to be kept for the most fine grain dof type mapping. This is stored in Doftype\+\_\+coarsen\+\_\+map\+\_\+fine, in this case it would be\+:

Doftype\+\_\+coarsen\+\_\+map\+\_\+fine = \mbox{[}\mbox{[}0,1\mbox{]}\mbox{[}2,3,4,5\mbox{]}\mbox{]}, since the dof types passed to this preconditioner is \mbox{[}2, 3, 4\mbox{]} from the master preconditioner, but it actually refers to the underlying dof types \mbox{[}2,3,4,5,6,7\mbox{]}.

In the case of the top most master block preconditioner, the block\+\_\+setup(...) function fills the vector with the identity mapping. 

Definition at line 3369 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_aa4e2e47f537f9b6b4deae5792c493d65}\label{classoomph_1_1BlockPreconditioner_aa4e2e47f537f9b6b4deae5792c493d65}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Doftype\+\_\+coarsen\+\_\+map\+\_\+fine@{Doftype\+\_\+coarsen\+\_\+map\+\_\+fine}}
\index{Doftype\+\_\+coarsen\+\_\+map\+\_\+fine@{Doftype\+\_\+coarsen\+\_\+map\+\_\+fine}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Doftype\+\_\+coarsen\+\_\+map\+\_\+fine}{Doftype\_coarsen\_map\_fine}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$\hyperlink{classoomph_1_1Vector}{Vector}$<$unsigned$>$ $>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Doftype\+\_\+coarsen\+\_\+map\+\_\+fine\hspace{0.3cm}{\ttfamily [protected]}}



Mapping the dof types within this preconditioner. The values in here refers to the most grain dof types. This list is automatically generated either in block\+\_\+setup(...) (for the top-\/most preconditioner) or the turn\+\_\+into\+\_\+subsidiary\+\_\+block\+\_\+preconditioner(...) function. Please refer to the comment above Doftype\+\_\+coarsen\+\_\+map\+\_\+coarse for more details. 



Definition at line 3377 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a2d341eaf3312c7afcd663c7f4eba6fc2}\label{classoomph_1_1BlockPreconditioner_a2d341eaf3312c7afcd663c7f4eba6fc2}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Doftype\+\_\+in\+\_\+master\+\_\+preconditioner\+\_\+coarse@{Doftype\+\_\+in\+\_\+master\+\_\+preconditioner\+\_\+coarse}}
\index{Doftype\+\_\+in\+\_\+master\+\_\+preconditioner\+\_\+coarse@{Doftype\+\_\+in\+\_\+master\+\_\+preconditioner\+\_\+coarse}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Doftype\+\_\+in\+\_\+master\+\_\+preconditioner\+\_\+coarse}{Doftype\_in\_master\_preconditioner\_coarse}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$unsigned$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Doftype\+\_\+in\+\_\+master\+\_\+preconditioner\+\_\+coarse\hspace{0.3cm}{\ttfamily [private]}}



The map between the dof types in this preconditioner and the master preconditioner. If there is no master preconditioner, it remains empty. This is the version for which the master preconditioner expects. The dof types in here may or may not be coarsened in the preconditioner above this one. 



Definition at line 3455 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_ae8c06ce4f4baf8480a2f25b152031dad}\label{classoomph_1_1BlockPreconditioner_ae8c06ce4f4baf8480a2f25b152031dad}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Doftype\+\_\+in\+\_\+master\+\_\+preconditioner\+\_\+fine@{Doftype\+\_\+in\+\_\+master\+\_\+preconditioner\+\_\+fine}}
\index{Doftype\+\_\+in\+\_\+master\+\_\+preconditioner\+\_\+fine@{Doftype\+\_\+in\+\_\+master\+\_\+preconditioner\+\_\+fine}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Doftype\+\_\+in\+\_\+master\+\_\+preconditioner\+\_\+fine}{Doftype\_in\_master\_preconditioner\_fine}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$unsigned$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Doftype\+\_\+in\+\_\+master\+\_\+preconditioner\+\_\+fine\hspace{0.3cm}{\ttfamily [private]}}



The map between the dof types in this preconditioner and the master preconditioner. If there is no master preconditioner it remains empty. This list contains the mapping for the underlying dof types. 



Definition at line 3448 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a79ea9c428aa8533c371ef3f0048a3a92}\label{classoomph_1_1BlockPreconditioner_a79ea9c428aa8533c371ef3f0048a3a92}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Global\+\_\+index@{Global\+\_\+index}}
\index{Global\+\_\+index@{Global\+\_\+index}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Global\+\_\+index}{Global\_index}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$\hyperlink{classoomph_1_1Vector}{Vector}$<$unsigned$>$ $>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Global\+\_\+index\hspace{0.3cm}{\ttfamily [private]}}



Vectors of vectors for the mapping from block number and block row to global row number. Empty if this preconditioner has a master preconditioner as this information is obtain from the master preconditioner. 



Definition at line 3507 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_ae7a8d4a769319bffc94432a3c4adf30b}\label{classoomph_1_1BlockPreconditioner_ae7a8d4a769319bffc94432a3c4adf30b}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Global\+\_\+index\+\_\+sparse@{Global\+\_\+index\+\_\+sparse}}
\index{Global\+\_\+index\+\_\+sparse@{Global\+\_\+index\+\_\+sparse}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Global\+\_\+index\+\_\+sparse}{Global\_index\_sparse}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$unsigned$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Global\+\_\+index\+\_\+sparse\hspace{0.3cm}{\ttfamily [private]}}



For global indices outside of the range this-\/$>$\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_ab00a3919b8634c698749f14a4d92947d}{first\+\_\+row()} to this-\/$>$\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_ab00a3919b8634c698749f14a4d92947d}{first\+\_\+row()}+this-\/$>$\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_a9bd7e1d242c69a28da85a804a7717fce}{nrow\+\_\+local()}, the Index\+\_\+in\+\_\+dof\+\_\+block and Dof\+\_\+number are stored sparsely in the vectors\+: 


\begin{DoxyItemize}
\item Index\+\_\+in\+\_\+dof\+\_\+block\+\_\+sparse;
\item Dof\+\_\+number\+\_\+sparse; The corresponding global indices are stored in this vector. 
\end{DoxyItemize}

Definition at line 3477 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a0ad82070ce2f6cdfa9ea6c7226ea28af}\label{classoomph_1_1BlockPreconditioner_a0ad82070ce2f6cdfa9ea6c7226ea28af}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Index\+\_\+in\+\_\+dof\+\_\+block\+\_\+dense@{Index\+\_\+in\+\_\+dof\+\_\+block\+\_\+dense}}
\index{Index\+\_\+in\+\_\+dof\+\_\+block\+\_\+dense@{Index\+\_\+in\+\_\+dof\+\_\+block\+\_\+dense}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Index\+\_\+in\+\_\+dof\+\_\+block\+\_\+dense}{Index\_in\_dof\_block\_dense}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$unsigned$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Index\+\_\+in\+\_\+dof\+\_\+block\+\_\+dense\hspace{0.3cm}{\ttfamily [private]}}



{\bfseries This was uncommented} Presumably a non-\/distributed analogue of Index\+\_\+in\+\_\+dof\+\_\+block\+\_\+sparse. 



Definition at line 3459 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a06bef26c782dacdc6b5caa6419df73c9}\label{classoomph_1_1BlockPreconditioner_a06bef26c782dacdc6b5caa6419df73c9}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Index\+\_\+in\+\_\+dof\+\_\+block\+\_\+sparse@{Index\+\_\+in\+\_\+dof\+\_\+block\+\_\+sparse}}
\index{Index\+\_\+in\+\_\+dof\+\_\+block\+\_\+sparse@{Index\+\_\+in\+\_\+dof\+\_\+block\+\_\+sparse}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Index\+\_\+in\+\_\+dof\+\_\+block\+\_\+sparse}{Index\_in\_dof\_block\_sparse}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$unsigned$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Index\+\_\+in\+\_\+dof\+\_\+block\+\_\+sparse\hspace{0.3cm}{\ttfamily [private]}}



\hyperlink{classoomph_1_1Vector}{Vector} to store the mapping from the global D\+OF number to the index (row/column number) within its block (empty if this preconditioner has a master preconditioner as this information is obtained from the master preconditioner). Sparse version\+: for global indices outside of the range this-\/$>$\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_ab00a3919b8634c698749f14a4d92947d}{first\+\_\+row()} to this-\/$>$\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_ab00a3919b8634c698749f14a4d92947d}{first\+\_\+row()}+this-\/$>$\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_a9bd7e1d242c69a28da85a804a7717fce}{nrow\+\_\+local()}. The global index of an element in this vector is defined in Global\+\_\+index\+\_\+sparse. 



Definition at line 3486 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a38de6514d7065086335e0e6f60dc77a9}\label{classoomph_1_1BlockPreconditioner_a38de6514d7065086335e0e6f60dc77a9}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Internal\+\_\+block\+\_\+distribution\+\_\+pt@{Internal\+\_\+block\+\_\+distribution\+\_\+pt}}
\index{Internal\+\_\+block\+\_\+distribution\+\_\+pt@{Internal\+\_\+block\+\_\+distribution\+\_\+pt}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Internal\+\_\+block\+\_\+distribution\+\_\+pt}{Internal\_block\_distribution\_pt}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$\hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution}$\ast$$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Internal\+\_\+block\+\_\+distribution\+\_\+pt\hspace{0.3cm}{\ttfamily [protected]}}



Storage for the default distribution for each internal block. 



Definition at line 3380 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a06c7426a2c8c096c8f4dc583444e0e0e}\label{classoomph_1_1BlockPreconditioner_a06c7426a2c8c096c8f4dc583444e0e0e}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Internal\+\_\+nblock\+\_\+types@{Internal\+\_\+nblock\+\_\+types}}
\index{Internal\+\_\+nblock\+\_\+types@{Internal\+\_\+nblock\+\_\+types}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Internal\+\_\+nblock\+\_\+types}{Internal\_nblock\_types}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
unsigned \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Internal\+\_\+nblock\+\_\+types\hspace{0.3cm}{\ttfamily [protected]}}



Number of different block types in this preconditioner. Note that this information is maintained if used as a subsidiary or stand-\/alone block preconditioner, in the latter case it stores the number of blocks within the subsidiary preconditioner. 



Definition at line 3405 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a3985436e4645c202eadd47a4f4f466e2}\label{classoomph_1_1BlockPreconditioner_a3985436e4645c202eadd47a4f4f466e2}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Internal\+\_\+ndof\+\_\+types@{Internal\+\_\+ndof\+\_\+types}}
\index{Internal\+\_\+ndof\+\_\+types@{Internal\+\_\+ndof\+\_\+types}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Internal\+\_\+ndof\+\_\+types}{Internal\_ndof\_types}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
unsigned \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Internal\+\_\+ndof\+\_\+types\hspace{0.3cm}{\ttfamily [protected]}}



Number of different D\+OF types in this preconditioner. Note that this information is maintained if used as a subsidiary or stand-\/alone block preconditioner, in the latter case it stores the number of dofs within the subsidiary preconditioner. 



Definition at line 3411 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a58079eb938b4d3602d0819cf68b318c0}\label{classoomph_1_1BlockPreconditioner_a58079eb938b4d3602d0819cf68b318c0}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Internal\+\_\+preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt@{Internal\+\_\+preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt}}
\index{Internal\+\_\+preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt@{Internal\+\_\+preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Internal\+\_\+preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt}{Internal\_preconditioner\_matrix\_distribution\_pt}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution}$\ast$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Internal\+\_\+preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt\hspace{0.3cm}{\ttfamily [private]}}



The distribution of the (internal) preconditioner matrix. This is formed by concatenating the distribution of the internal blocks. This is obsolete code, maintained for backwards compatibility. Below is the old comment\+: 


\begin{DoxyItemize}
\item only used if this preconditioner is a master preconditioner. Warning\+: always use the access function \hyperlink{classoomph_1_1BlockPreconditioner_a3a16de88bd5369e729d761a6498fdd3f}{internal\+\_\+preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt()}. 
\end{DoxyItemize}

Definition at line 3564 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a7759d79eefa52fb688caac08a4ff4894}\label{classoomph_1_1BlockPreconditioner_a7759d79eefa52fb688caac08a4ff4894}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Master\+\_\+block\+\_\+preconditioner\+\_\+pt@{Master\+\_\+block\+\_\+preconditioner\+\_\+pt}}
\index{Master\+\_\+block\+\_\+preconditioner\+\_\+pt@{Master\+\_\+block\+\_\+preconditioner\+\_\+pt}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Master\+\_\+block\+\_\+preconditioner\+\_\+pt}{Master\_block\_preconditioner\_pt}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1BlockPreconditioner}{Block\+Preconditioner}$<$M\+A\+T\+R\+IX$>$$\ast$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Master\+\_\+block\+\_\+preconditioner\+\_\+pt\hspace{0.3cm}{\ttfamily [private]}}



If the block preconditioner is acting a subsidiary block preconditioner then a pointer to the master preconditioner is stored here. If the preconditioner does not have a master block preconditioner then this pointer remains null. 



Definition at line 3443 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a89adb506e8f9103c80b4b36cc309f536}\label{classoomph_1_1BlockPreconditioner_a89adb506e8f9103c80b4b36cc309f536}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Mesh\+\_\+pt@{Mesh\+\_\+pt}}
\index{Mesh\+\_\+pt@{Mesh\+\_\+pt}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Mesh\+\_\+pt}{Mesh\_pt}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$const \hyperlink{classoomph_1_1Mesh}{Mesh}$\ast$$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Mesh\+\_\+pt\hspace{0.3cm}{\ttfamily [protected]}}



\hyperlink{classoomph_1_1Vector}{Vector} of pointers to the meshes containing the elements used in the block preconditioner. Const pointers to prevent modification of the mesh by the preconditioner (this could be relaxed if needed). If this is a subsidiary preconditioner, then the information is looked up in the master preconditioner. 



Definition at line 3395 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a874cbe5520d546ee24004e229a48037e}\label{classoomph_1_1BlockPreconditioner_a874cbe5520d546ee24004e229a48037e}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Ndof\+\_\+in\+\_\+block@{Ndof\+\_\+in\+\_\+block}}
\index{Ndof\+\_\+in\+\_\+block@{Ndof\+\_\+in\+\_\+block}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Ndof\+\_\+in\+\_\+block}{Ndof\_in\_block}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$unsigned$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Ndof\+\_\+in\+\_\+block\hspace{0.3cm}{\ttfamily [private]}}



Number of types of degree of freedom associated with each block. 



Definition at line 3518 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a43e9d73ff61daa00aea4e4deff0d6aff}\label{classoomph_1_1BlockPreconditioner_a43e9d73ff61daa00aea4e4deff0d6aff}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Ndof\+\_\+types\+\_\+in\+\_\+mesh@{Ndof\+\_\+types\+\_\+in\+\_\+mesh}}
\index{Ndof\+\_\+types\+\_\+in\+\_\+mesh@{Ndof\+\_\+types\+\_\+in\+\_\+mesh}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Ndof\+\_\+types\+\_\+in\+\_\+mesh}{Ndof\_types\_in\_mesh}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$unsigned$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Ndof\+\_\+types\+\_\+in\+\_\+mesh\hspace{0.3cm}{\ttfamily [protected]}}



Storage for number of types of degree of freedom of the elements in each mesh. 



Definition at line 3399 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a4aa232afd2a76adac97fb7d484a18c5e}\label{classoomph_1_1BlockPreconditioner_a4aa232afd2a76adac97fb7d484a18c5e}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Nrow@{Nrow}}
\index{Nrow@{Nrow}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Nrow}{Nrow}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
unsigned \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Nrow\hspace{0.3cm}{\ttfamily [private]}}



Number of D\+O\+Fs (\# of rows or columns in the matrix) in this preconditioner. Note that this information is maintained if used as a subsidiary or stand-\/alone block preconditioner, in the latter case it stores the number of rows within the subsidiary preconditioner. 



Definition at line 3437 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a9ab1a931e617f04a50e8f24e75069628}\label{classoomph_1_1BlockPreconditioner_a9ab1a931e617f04a50e8f24e75069628}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Nrows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+block@{Nrows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+block}}
\index{Nrows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+block@{Nrows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+block}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Nrows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+block}{Nrows\_to\_recv\_for\_get\_block}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$unsigned$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Nrows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+block\hspace{0.3cm}{\ttfamily [private]}}



The number of block rows to be received from processor p for block b (matrix indexed \mbox{[}b\mbox{]}\mbox{[}p\mbox{]}). 



Definition at line 3537 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a0265c19418608d4a525c159abe1b5c60}\label{classoomph_1_1BlockPreconditioner_a0265c19418608d4a525c159abe1b5c60}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Nrows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+ordered@{Nrows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+ordered}}
\index{Nrows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+ordered@{Nrows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+ordered}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Nrows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+ordered}{Nrows\_to\_recv\_for\_get\_ordered}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$unsigned$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Nrows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+ordered\hspace{0.3cm}{\ttfamily [private]}}



The number of preconditioner rows to be received from processor p for get\+\_\+block\+\_\+ordered\+\_\+... type methods. 



Definition at line 3553 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a2080668f30dd3095ce8f2f791536f20e}\label{classoomph_1_1BlockPreconditioner_a2080668f30dd3095ce8f2f791536f20e}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Nrows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+block@{Nrows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+block}}
\index{Nrows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+block@{Nrows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+block}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Nrows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+block}{Nrows\_to\_send\_for\_get\_block}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$unsigned$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Nrows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+block\hspace{0.3cm}{\ttfamily [private]}}



The number of global rows to be sent of block b to processor p (matrix indexed \mbox{[}b\mbox{]}\mbox{[}p\mbox{]}). 



Definition at line 3529 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_ae1a0fcd29c4939f668d2225b5d33caf5}\label{classoomph_1_1BlockPreconditioner_ae1a0fcd29c4939f668d2225b5d33caf5}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Nrows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+ordered@{Nrows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+ordered}}
\index{Nrows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+ordered@{Nrows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+ordered}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Nrows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+ordered}{Nrows\_to\_send\_for\_get\_ordered}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$unsigned$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Nrows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+ordered\hspace{0.3cm}{\ttfamily [private]}}



The number global rows to be sent to processor p for get\+\_\+block\+\_\+ordered\+\_\+... type methods. 



Definition at line 3545 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a915ff2775ccef6ac3dadf072566da9e7}\label{classoomph_1_1BlockPreconditioner_a915ff2775ccef6ac3dadf072566da9e7}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Output\+\_\+base\+\_\+filename@{Output\+\_\+base\+\_\+filename}}
\index{Output\+\_\+base\+\_\+filename@{Output\+\_\+base\+\_\+filename}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Output\+\_\+base\+\_\+filename}{Output\_base\_filename}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
std\+::string \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Output\+\_\+base\+\_\+filename\hspace{0.3cm}{\ttfamily [private]}}



String giving the base of the files to write block data into. If empty then do not output blocks. Default is empty. 



Definition at line 3576 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_ad647cfa61939e3c118dcc2595a7f9240}\label{classoomph_1_1BlockPreconditioner_ad647cfa61939e3c118dcc2595a7f9240}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt@{Preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt}}
\index{Preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt@{Preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt}{Preconditioner\_matrix\_distribution\_pt}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1LinearAlgebraDistribution}{Linear\+Algebra\+Distribution}$\ast$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Preconditioner\+\_\+matrix\+\_\+distribution\+\_\+pt\hspace{0.3cm}{\ttfamily [private]}}



The distribution of the preconditioner matrix. This is the concatenation of the block distribution. 



Definition at line 3568 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_ae6ce543de76eedb34a2562eecceb222b}\label{classoomph_1_1BlockPreconditioner_ae6ce543de76eedb34a2562eecceb222b}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Recursive\+\_\+debug\+\_\+flag@{Recursive\+\_\+debug\+\_\+flag}}
\index{Recursive\+\_\+debug\+\_\+flag@{Recursive\+\_\+debug\+\_\+flag}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Recursive\+\_\+debug\+\_\+flag}{Recursive\_debug\_flag}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
bool \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Recursive\+\_\+debug\+\_\+flag\hspace{0.3cm}{\ttfamily [private]}}



Debugging variable. Set true or false via the access functions turn\+\_\+on\+\_\+recursive\+\_\+debug\+\_\+flag(...) turn\+\_\+off\+\_\+recursive\+\_\+debug\+\_\+flag(...) These will turn on/off the debug flag up the hierarchy. 



Definition at line 3419 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a6816cfc4c9d74a39aca7401f751bb235}\label{classoomph_1_1BlockPreconditioner_a6816cfc4c9d74a39aca7401f751bb235}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Replacement\+\_\+dof\+\_\+block\+\_\+pt@{Replacement\+\_\+dof\+\_\+block\+\_\+pt}}
\index{Replacement\+\_\+dof\+\_\+block\+\_\+pt@{Replacement\+\_\+dof\+\_\+block\+\_\+pt}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Replacement\+\_\+dof\+\_\+block\+\_\+pt}{Replacement\_dof\_block\_pt}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1MapMatrix}{Map\+Matrix}$<$unsigned,\hyperlink{classoomph_1_1CRDoubleMatrix}{C\+R\+Double\+Matrix}$\ast$$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Replacement\+\_\+dof\+\_\+block\+\_\+pt\hspace{0.3cm}{\ttfamily [protected]}}



The replacement dof-\/level blocks. 



Definition at line 3317 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a37d5573e5a7c9fba43f4364458e9075c}\label{classoomph_1_1BlockPreconditioner_a37d5573e5a7c9fba43f4364458e9075c}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Rows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+block@{Rows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+block}}
\index{Rows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+block@{Rows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+block}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Rows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+block}{Rows\_to\_recv\_for\_get\_block}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$int$\ast$$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Rows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+block\hspace{0.3cm}{\ttfamily [private]}}



The block rows to be received from processor p for block b (matrix indexed \mbox{[}b\mbox{]}\mbox{[}p\mbox{]}). 



Definition at line 3533 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a68830fbf53861f7b2e3e6a1b4843f6b2}\label{classoomph_1_1BlockPreconditioner_a68830fbf53861f7b2e3e6a1b4843f6b2}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Rows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+ordered@{Rows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+ordered}}
\index{Rows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+ordered@{Rows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+ordered}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Rows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+ordered}{Rows\_to\_recv\_for\_get\_ordered}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$int$\ast$$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Rows\+\_\+to\+\_\+recv\+\_\+for\+\_\+get\+\_\+ordered\hspace{0.3cm}{\ttfamily [private]}}



The preconditioner rows to be received from processor p for get\+\_\+block\+\_\+ordered\+\_\+... type methods. 



Definition at line 3549 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_ac24e5ec4afe8904b3de7975ff0b2649d}\label{classoomph_1_1BlockPreconditioner_ac24e5ec4afe8904b3de7975ff0b2649d}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Rows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+block@{Rows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+block}}
\index{Rows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+block@{Rows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+block}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Rows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+block}{Rows\_to\_send\_for\_get\_block}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$int$\ast$$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Rows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+block\hspace{0.3cm}{\ttfamily [private]}}



The global rows to be sent of block b to processor p (matrix indexed \mbox{[}b\mbox{]}\mbox{[}p\mbox{]}). 



Definition at line 3525 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a47d5bfe73b47ab79504e878d372dd65f}\label{classoomph_1_1BlockPreconditioner_a47d5bfe73b47ab79504e878d372dd65f}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Rows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+ordered@{Rows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+ordered}}
\index{Rows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+ordered@{Rows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+ordered}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Rows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+ordered}{Rows\_to\_send\_for\_get\_ordered}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
\hyperlink{classoomph_1_1Vector}{Vector}$<$int$\ast$$>$ \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Rows\+\_\+to\+\_\+send\+\_\+for\+\_\+get\+\_\+ordered\hspace{0.3cm}{\ttfamily [private]}}



The global rows to be sent to processor p for get\+\_\+block\+\_\+ordered\+\_\+... type methods. 



Definition at line 3541 of file block\+\_\+preconditioner.\+h.

\mbox{\Hypertarget{classoomph_1_1BlockPreconditioner_a6e6a40988711a64c622c2fd9104c56cf}\label{classoomph_1_1BlockPreconditioner_a6e6a40988711a64c622c2fd9104c56cf}} 
\index{oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}!Run\+\_\+block\+\_\+matrix\+\_\+test@{Run\+\_\+block\+\_\+matrix\+\_\+test}}
\index{Run\+\_\+block\+\_\+matrix\+\_\+test@{Run\+\_\+block\+\_\+matrix\+\_\+test}!oomph\+::\+Block\+Preconditioner@{oomph\+::\+Block\+Preconditioner}}
\subsubsection{\texorpdfstring{Run\+\_\+block\+\_\+matrix\+\_\+test}{Run\_block\_matrix\_test}}
{\footnotesize\ttfamily template$<$typename M\+A\+T\+R\+IX$>$ \\
bool \hyperlink{classoomph_1_1BlockPreconditioner}{oomph\+::\+Block\+Preconditioner}$<$ M\+A\+T\+R\+IX $>$\+::Run\+\_\+block\+\_\+matrix\+\_\+test =false\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}



Static boolean to allow block\+\_\+matrix\+\_\+test(...) to be run. Defaults to false. 



Definition at line 3572 of file block\+\_\+preconditioner.\+h.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
\hyperlink{block__preconditioner_8h}{block\+\_\+preconditioner.\+h}\item 
\hyperlink{block__preconditioner_8cc}{block\+\_\+preconditioner.\+cc}\end{DoxyCompactItemize}
