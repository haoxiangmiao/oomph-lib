\hypertarget{classoomph_1_1ConstitutiveLaw}{}\section{oomph\+:\+:Constitutive\+Law Class Reference}
\label{classoomph_1_1ConstitutiveLaw}\index{oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}}


{\ttfamily \#include $<$constitutive\+\_\+laws.\+h$>$}

Inheritance diagram for oomph\+:\+:Constitutive\+Law\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=1.739130cm]{classoomph_1_1ConstitutiveLaw}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classoomph_1_1ConstitutiveLaw_a864c36413e8ea31e63552f3db3b97a2f}{Constitutive\+Law} ()
\begin{DoxyCompactList}\small\item\em Empty constructor. \end{DoxyCompactList}\item 
virtual \hyperlink{classoomph_1_1ConstitutiveLaw_aa75b88c826723ba090ace39c26da0ae6}{$\sim$\+Constitutive\+Law} ()
\begin{DoxyCompactList}\small\item\em Empty virtual destructor. \end{DoxyCompactList}\item 
virtual void \hyperlink{classoomph_1_1ConstitutiveLaw_a93527d910de908035feb8f41b0401065}{calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress} (const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&g, const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&G, \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&sigma)=0
\begin{DoxyCompactList}\small\item\em Calculate the contravariant 2nd Piola Kirchhoff stress tensor. Arguments are the covariant undeformed and deformed metric tensor and the matrix in which to return the stress tensor. \end{DoxyCompactList}\item 
virtual void \hyperlink{classoomph_1_1ConstitutiveLaw_a6076752384082cfa3de3e0cf17daa9aa}{calculate\+\_\+d\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress\+\_\+dG} (const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&g, const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&G, const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&sigma, \hyperlink{classoomph_1_1RankFourTensor}{Rank\+Four\+Tensor}$<$ double $>$ \&d\+\_\+sigma\+\_\+dG, const bool \&symmetrize\+\_\+tensor=true)
\begin{DoxyCompactList}\small\item\em Calculate the derivatives of the contravariant 2nd Piola Kirchhoff stress tensor with respect to the deformed metric tensor. Arguments are the covariant undeformed and deformed metric tensor, the current value of the stress tensor and the rank four tensor in which to return the derivatives of the stress tensor The default implementation uses finite differences, but can be overloaded for constitutive laws in which an analytic formulation is possible. If the boolean flag symmetrize\+\_\+tensor is false, only the \char`\"{}upper  triangular\char`\"{} entries of the tensor will be filled in. This is a useful efficiency when using the derivatives in Jacobian calculations. \end{DoxyCompactList}\item 
virtual void \hyperlink{classoomph_1_1ConstitutiveLaw_ac8178b1b7cd7e6a64942dba9e0997b30}{calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress} (const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&g, const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&G, \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&sigma\+\_\+dev, \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&G\+\_\+contra, double \&Gdet)
\begin{DoxyCompactList}\small\item\em Calculate the deviatoric part $ \overline{ \sigma^{ij}}$ of the contravariant 2nd Piola Kirchhoff stress tensor $ \sigma^{ij}$. Also return the contravariant deformed metric tensor and the determinant of the deformed metric tensor. This form is appropriate for truly-\/incompressible materials for which $ \sigma^{ij} = - p G^{ij} +\overline{ \sigma^{ij}} $ where the \char`\"{}pressure\char`\"{} $ p $ is determined by $ \det G_{ij} - \det g_{ij} = 0 $. \end{DoxyCompactList}\item 
virtual void \hyperlink{classoomph_1_1ConstitutiveLaw_af13f9d05db09870d1b90b7ef389bdb71}{calculate\+\_\+d\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress\+\_\+dG} (const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&g, const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&G, const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&sigma, const double \&detG, const double \&interpolated\+\_\+solid\+\_\+p, \hyperlink{classoomph_1_1RankFourTensor}{Rank\+Four\+Tensor}$<$ double $>$ \&d\+\_\+sigma\+\_\+dG, \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&d\+\_\+det\+G\+\_\+dG, const bool \&symmetrize\+\_\+tensor=true)
\begin{DoxyCompactList}\small\item\em Calculate the derivatives of the contravariant 2nd Piola Kirchhoff stress tensor $ \sigma^{ij}$. with respect to the deformed metric tensor. Also return the derivatives of the determinant of the deformed metric tensor with respect to the deformed metric tensor. This form is appropriate for truly-\/incompressible materials. The default implementation uses finite differences for the derivatives that depend on the constitutive law, but not for the derivatives of the determinant, which are generic. \end{DoxyCompactList}\item 
virtual void \hyperlink{classoomph_1_1ConstitutiveLaw_a26f34355b626bebcad8f498fa5271d20}{calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress} (const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&g, const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&G, \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&sigma\+\_\+dev, \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&Gcontra, double \&gen\+\_\+dil, double \&inv\+\_\+kappa)
\begin{DoxyCompactList}\small\item\em Calculate the deviatoric part of the contravariant 2nd Piola Kirchoff stress tensor. Also return the contravariant deformed metric tensor, the generalised dilatation, $ d, $ and the inverse of the bulk modulus $ \kappa$. This form is appropriate for near-\/incompressible materials for which $ \sigma^{ij} = -p G^{ij} + \overline{ \sigma^{ij}} $ where the \char`\"{}pressure\char`\"{} $ p $ is determined from $ p / \kappa - d =0 $. \end{DoxyCompactList}\item 
virtual void \hyperlink{classoomph_1_1ConstitutiveLaw_a8a4f1bcac8d308d9ad0013ddf5def505}{calculate\+\_\+d\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress\+\_\+dG} (const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&g, const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&G, const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&sigma, const double \&gen\+\_\+dil, const double \&inv\+\_\+kappa, const double \&interpolated\+\_\+solid\+\_\+p, \hyperlink{classoomph_1_1RankFourTensor}{Rank\+Four\+Tensor}$<$ double $>$ \&d\+\_\+sigma\+\_\+dG, \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&d\+\_\+gen\+\_\+dil\+\_\+dG, const bool \&symmetrize\+\_\+tensor=true)
\begin{DoxyCompactList}\small\item\em Calculate the derivatives of the contravariant 2nd Piola Kirchoff stress tensor with respect to the deformed metric tensor. Also return the derivatives of the generalised dilatation, $ d, $ with respect to the deformed metric tensor. This form is appropriate for near-\/incompressible materials. The default implementation uses finite differences. If the boolean flag symmetrize\+\_\+tensor is false, only the \char`\"{}upper  triangular\char`\"{} entries of the tensor will be filled in. This is a useful efficiency when using the derivatives in Jacobian calculations. \end{DoxyCompactList}\item 
virtual bool \hyperlink{classoomph_1_1ConstitutiveLaw_a446452158a8ae9fbc3dde4277155f824}{requires\+\_\+incompressibility\+\_\+constraint} ()=0
\begin{DoxyCompactList}\small\item\em Pure virtual function in which the user must declare if the constitutive equation requires an incompressible formulation in which the volume constraint is enforced explicitly. Used as a sanity check in P\+A\+R\+A\+N\+O\+ID mode. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
bool \hyperlink{classoomph_1_1ConstitutiveLaw_a73f01e1459e7ba998ef78f7ece6baa37}{is\+\_\+matrix\+\_\+square} (const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&M)
\begin{DoxyCompactList}\small\item\em Test whether a matrix is square. \end{DoxyCompactList}\item 
bool \hyperlink{classoomph_1_1ConstitutiveLaw_a8a89bb96a9b922294509923563a13063}{are\+\_\+matrices\+\_\+of\+\_\+equal\+\_\+dimensions} (const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&M1, const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&M2)
\begin{DoxyCompactList}\small\item\em Test whether two matrices are of equal dimensions. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1ConstitutiveLaw_a01763658a56a962460a80607653a33b4}{error\+\_\+checking\+\_\+in\+\_\+input} (const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&g, const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&G, \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&sigma)
\begin{DoxyCompactList}\small\item\em Check for errors in the input, i.\+e. check that the dimensions of the arrays are all consistent. \end{DoxyCompactList}\item 
double \hyperlink{classoomph_1_1ConstitutiveLaw_a5c188df10b08b340b923c3a733c0d178}{calculate\+\_\+contravariant} (const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&Gcov, \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&Gcontra)
\begin{DoxyCompactList}\small\item\em Calculate a contravariant tensor from a covariant tensor, and return the determinant of the covariant tensor. \end{DoxyCompactList}\item 
void \hyperlink{classoomph_1_1ConstitutiveLaw_a6dda64e60ed8128cb4603041dc66036f}{calculate\+\_\+d\+\_\+contravariant\+\_\+dG} (const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&Gcov, \hyperlink{classoomph_1_1RankFourTensor}{Rank\+Four\+Tensor}$<$ double $>$ \&d\+Gcontra\+\_\+dG, \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&d\+\_\+det\+G\+\_\+dG)
\begin{DoxyCompactList}\small\item\em Calculate the derivatives of the contravariant tensor and the derivatives of the determinant of the covariant tensor with respect to the components of the covariant tensor. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
A class for constitutive laws for elements that solve the equations of solid mechanics based upon the principle of virtual displacements. In that formulation, the information required from a constitutive law is the (2nd Piola-\/\+Kirchhoff) stress tensor $ \sigma^{ij} $ as a function of the (Green) strain $ \gamma^{ij} $\+: \[ \sigma^{ij} = \sigma^{ij}(\gamma_{ij}). \] The Green strain is defined as \[ \gamma_{ij} = \frac{1}{2} (G_{ij} - g_{ij}), \ \ \ \ \ \ \ \ \ \ \ (1) \] where $G_{ij} $ and $ g_{ij}$ are the metric tensors in the deformed and undeformed (stress-\/free) configurations, respectively. A specific \hyperlink{classoomph_1_1ConstitutiveLaw}{Constitutive\+Law} needs to be implement the pure virtual function 
\begin{DoxyCode}
\hyperlink{classoomph_1_1ConstitutiveLaw_a93527d910de908035feb8f41b0401065}{ConstitutiveLaw::calculate\_second\_piola\_kirchhoff\_stress}
      (...)
\end{DoxyCode}
 Equation (1) shows that the strain may be calculated from the undeformed and deformed metric tensors. Frequently, these tensors are also required in the constitutive law itself. To avoid unnecessary re-\/computation of these quantities, we pass the deformed and undeformed metric tensor to {\ttfamily calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress}(...) rather than the strain tensor itself.

The functional form of the constitutive equation is different for compressible/incompressible/near-\/incompressible behaviour and we provide interfaces that are appropriate for all of these cases.
\begin{DoxyEnumerate}
\item {\bfseries Compressible} {\bfseries Behaviour\+:} ~\newline
 If the material is compressible, the stress can be computed from the deformed and undeformed metric tensors, \[ \sigma^{ij} = \sigma^{ij}(\gamma_{ij}) = \sigma^{ij}\bigg( \frac{1}{2} (G_{ij} - g_{ij})\bigg), \] using the interface 
\begin{DoxyCode}
\textcolor{comment}{// 2nd Piola Kirchhoff stress tensor}
DenseMatrix<double> sigma(DIM,DIM);

\textcolor{comment}{// Metric tensor in the undeformed (stress-free) configuration}
DenseMatrix<double> g(DIM,DIM);

\textcolor{comment}{// Metric tensor in the deformed  configuration}
DenseMatrix<double> G(DIM,DIM);

\textcolor{comment}{// Compute stress from the two metric tensors:}
\hyperlink{classoomph_1_1ConstitutiveLaw_a93527d910de908035feb8f41b0401065}{calculate\_second\_piola\_kirchhoff\_stress}(g,G,sigma);
\end{DoxyCode}
 ~\newline
 ~\newline
 ~\newline

\item {\bfseries Incompressible} {\bfseries Behaviour\+:} ~\newline
 If the material is incompressible, its deformation is constrained by the condition that \[ \det G_{ij} - \det g_{ij}= 0 \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (2) \] which ensures that the volume of infinitesimal material elements remains constant during the deformation. This condition is typically enforced by a Lagrange multiplier which plays the role of a pressure. In such cases, the stress tensor has form \[ \sigma^{ij} = -p G^{ij} + \overline{\sigma}^{ij}\big(\gamma_{kl}\big), \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (3) \] where only the deviatoric part of the stress tensor, $ \overline{\sigma}^{ij}, $ depends directly on the strain. The pressure $ p $ needs to be determined independently from (2). Given the deformed and undeformed metric tensors, the computation of the stress tensor $ \sigma^{ij} $ for an incompressible material therefore requires the computation of the following quantities\+:
\begin{DoxyItemize}
\item The deviatoric stress $ \overline{\sigma}^{ij} $
\item The contravariant deformed metric tensor $ G^{ij} $
\item The determinant of the deformed metric tensors, $ \det G_{ij}, $ which is required in equation (2) whose solution determines the pressure.
\end{DoxyItemize}~\newline
 These quantities can be obtained from the following interface ~\newline

\begin{DoxyCode}
\textcolor{comment}{// Deviatoric part of the 2nd Piola Kirchhoff stress tensor}
DenseMatrix<double> sigma\_dev(DIM,DIM);

\textcolor{comment}{// Metric tensor in the undeformed (stress-free) configuration}
DenseMatrix<double> g(DIM,DIM);

\textcolor{comment}{// Metric tensor in the deformed  configuration}
DenseMatrix<double> G(DIM,DIM);

\textcolor{comment}{// Determinant of the deformed metric tensor}
\textcolor{keywordtype}{double} Gdet;

\textcolor{comment}{// Contravariant deformed metric tensor}
DenseMatrix<double> G\_contra(DIM,DIM);

\textcolor{comment}{// Compute stress from the two metric tensors:}
\hyperlink{classoomph_1_1ConstitutiveLaw_a93527d910de908035feb8f41b0401065}{calculate\_second\_piola\_kirchhoff\_stress}(g,G,sigma\_dev,G\_contra,Gdet)
      ;
\end{DoxyCode}
 ~\newline
 ~\newline
 ~\newline

\item {\bfseries Nearly} {\bfseries Incompressible} {\bfseries Behaviour\+:} ~\newline
 If the material is nearly incompressible, it is advantageous to split the stress into its deviatoric and hydrostatic parts by writing the constitutive law in the form \[ \sigma^{ij} = -p G^{ij} + \overline{\sigma}^{ij}\big(\gamma_{kl}\big), \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (3) \] where the deviatoric part of the stress tensor, $ \overline{\sigma}^{ij}, $ depends on the strain. This form of the constitutive law is identical to that of the incompressible case and it involves a pressure $ p $ which needs to be determined from an additional equation. In the incompressible case, this equation was given by the incompressibility constraint (2). Here, we need to augment the constitutive law (3) by a separate equation for the pressure. Generally this takes the form \[ p = - \kappa \ d \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (4) \] where $ \kappa $ is the \char`\"{}bulk modulus\char`\"{}, a material property that needs to be specified by the constitutive law. $ d $ is the (generalised) dilatation, i.\+e. the relative change in the volume of an infinitesimal material element (or some suitable generalised quantitiy that is related to it). As the material approaches incompressibility, $ \kappa \to \infty$, so that infinitely large pressures would be required to achieve any change in volume. To facilitate the implementation of (4) as the equation for the pressure, we re-\/write it in the form \[ p \ \frac{1}{\kappa} + d\big(g_{ij},G_{ij}\big) = 0 \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (5) \] which only involves quantities that remain finite as we approach true incompressibility. ~\newline
 Given the deformed and undeformed metric tensors, the computation of the stress tensor $ \sigma^{ij} $ for a nearly incompressible material therefore requires the computation of the following quantities\+:
\begin{DoxyItemize}
\item The deviatoric stress $ \overline{\sigma}^{ij} $
\item The contravariant deformed metric tensor $ G^{ij} $
\item The generalised dilatation $ d $
\item The inverse of the bulk modulus $ \kappa $
\end{DoxyItemize}~\newline
 These quantities can be obtained from the following interface ~\newline

\begin{DoxyCode}
\textcolor{comment}{// Deviatoric part of the 2nd Piola Kirchhoff stress tensor}
DenseMatrix<double> sigma\_dev(DIM,DIM);

\textcolor{comment}{// Metric tensor in the undeformed (stress-free) configuration}
DenseMatrix<double> g(DIM,DIM);

\textcolor{comment}{// Metric tensor in the deformed  configuration}
DenseMatrix<double> G(DIM,DIM);

\textcolor{comment}{// Contravariant deformed metric tensor}
DenseMatrix<double> G\_contra(DIM,DIM);

\textcolor{comment}{// Inverse of the bulk modulus}
\textcolor{keywordtype}{double} inv\_kappa;

\textcolor{comment}{// Generalised dilatation}
\textcolor{keywordtype}{double} gen\_dil;

\textcolor{comment}{// Compute stress from the two metric tensors:}
\hyperlink{classoomph_1_1ConstitutiveLaw_a93527d910de908035feb8f41b0401065}{calculate\_second\_piola\_kirchhoff\_stress}(g,G,sigma\_dev,G\_contra,
      inv\_kappa,gen\_dil);
\end{DoxyCode}
 
\end{DoxyEnumerate}

Definition at line 489 of file constitutive\+\_\+laws.\+h.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classoomph_1_1ConstitutiveLaw_a864c36413e8ea31e63552f3db3b97a2f}\label{classoomph_1_1ConstitutiveLaw_a864c36413e8ea31e63552f3db3b97a2f}} 
\index{oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}!Constitutive\+Law@{Constitutive\+Law}}
\index{Constitutive\+Law@{Constitutive\+Law}!oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}}
\subsubsection{\texorpdfstring{Constitutive\+Law()}{ConstitutiveLaw()}}
{\footnotesize\ttfamily oomph\+::\+Constitutive\+Law\+::\+Constitutive\+Law (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Empty constructor. 



Definition at line 522 of file constitutive\+\_\+laws.\+h.

\mbox{\Hypertarget{classoomph_1_1ConstitutiveLaw_aa75b88c826723ba090ace39c26da0ae6}\label{classoomph_1_1ConstitutiveLaw_aa75b88c826723ba090ace39c26da0ae6}} 
\index{oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}!````~Constitutive\+Law@{$\sim$\+Constitutive\+Law}}
\index{````~Constitutive\+Law@{$\sim$\+Constitutive\+Law}!oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}}
\subsubsection{\texorpdfstring{$\sim$\+Constitutive\+Law()}{~ConstitutiveLaw()}}
{\footnotesize\ttfamily virtual oomph\+::\+Constitutive\+Law\+::$\sim$\+Constitutive\+Law (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Empty virtual destructor. 



Definition at line 526 of file constitutive\+\_\+laws.\+h.



\subsection{Member Function Documentation}
\mbox{\Hypertarget{classoomph_1_1ConstitutiveLaw_a8a89bb96a9b922294509923563a13063}\label{classoomph_1_1ConstitutiveLaw_a8a89bb96a9b922294509923563a13063}} 
\index{oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}!are\+\_\+matrices\+\_\+of\+\_\+equal\+\_\+dimensions@{are\+\_\+matrices\+\_\+of\+\_\+equal\+\_\+dimensions}}
\index{are\+\_\+matrices\+\_\+of\+\_\+equal\+\_\+dimensions@{are\+\_\+matrices\+\_\+of\+\_\+equal\+\_\+dimensions}!oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}}
\subsubsection{\texorpdfstring{are\+\_\+matrices\+\_\+of\+\_\+equal\+\_\+dimensions()}{are\_matrices\_of\_equal\_dimensions()}}
{\footnotesize\ttfamily bool oomph\+::\+Constitutive\+Law\+::are\+\_\+matrices\+\_\+of\+\_\+equal\+\_\+dimensions (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{M1,  }\item[{const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{M2 }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Test whether two matrices are of equal dimensions. 

This function is used to check whether matrices are of equal dimension. 

Definition at line 51 of file constitutive\+\_\+laws.\+cc.



References oomph\+::\+Dense\+Matrix$<$ T $>$\+::ncol(), and oomph\+::\+Dense\+Matrix$<$ T $>$\+::nrow().



Referenced by calculate\+\_\+contravariant(), calculate\+\_\+d\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress\+\_\+d\+G(), and error\+\_\+checking\+\_\+in\+\_\+input().

\mbox{\Hypertarget{classoomph_1_1ConstitutiveLaw_a5c188df10b08b340b923c3a733c0d178}\label{classoomph_1_1ConstitutiveLaw_a5c188df10b08b340b923c3a733c0d178}} 
\index{oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}!calculate\+\_\+contravariant@{calculate\+\_\+contravariant}}
\index{calculate\+\_\+contravariant@{calculate\+\_\+contravariant}!oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}}
\subsubsection{\texorpdfstring{calculate\+\_\+contravariant()}{calculate\_contravariant()}}
{\footnotesize\ttfamily double oomph\+::\+Constitutive\+Law\+::calculate\+\_\+contravariant (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{Gcov,  }\item[{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{Gcontra }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Calculate a contravariant tensor from a covariant tensor, and return the determinant of the covariant tensor. 

The function to calculate the contravariant tensor from a covariant one. Three dimensions 

Definition at line 111 of file constitutive\+\_\+laws.\+cc.



References are\+\_\+matrices\+\_\+of\+\_\+equal\+\_\+dimensions(), calculate\+\_\+d\+\_\+contravariant\+\_\+d\+G(), is\+\_\+matrix\+\_\+square(), oomph\+::\+Dense\+Matrix$<$ T $>$\+::ncol(), and oomph\+::\+Global\+\_\+string\+\_\+for\+\_\+annotation\+::string().



Referenced by oomph\+::\+Generalised\+Hookean\+::calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress(), oomph\+::\+Isotropic\+Strain\+Energy\+Function\+Constitutive\+Law\+::calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress(), and error\+\_\+checking\+\_\+in\+\_\+input().

\mbox{\Hypertarget{classoomph_1_1ConstitutiveLaw_a6dda64e60ed8128cb4603041dc66036f}\label{classoomph_1_1ConstitutiveLaw_a6dda64e60ed8128cb4603041dc66036f}} 
\index{oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}!calculate\+\_\+d\+\_\+contravariant\+\_\+dG@{calculate\+\_\+d\+\_\+contravariant\+\_\+dG}}
\index{calculate\+\_\+d\+\_\+contravariant\+\_\+dG@{calculate\+\_\+d\+\_\+contravariant\+\_\+dG}!oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}}
\subsubsection{\texorpdfstring{calculate\+\_\+d\+\_\+contravariant\+\_\+d\+G()}{calculate\_d\_contravariant\_dG()}}
{\footnotesize\ttfamily void oomph\+::\+Constitutive\+Law\+::calculate\+\_\+d\+\_\+contravariant\+\_\+dG (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{Gdown,  }\item[{\hyperlink{classoomph_1_1RankFourTensor}{Rank\+Four\+Tensor}$<$ double $>$ \&}]{d\+\_\+\+Gup\+\_\+dG,  }\item[{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{d\+\_\+det\+G\+\_\+dG }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Calculate the derivatives of the contravariant tensor and the derivatives of the determinant of the covariant tensor with respect to the components of the covariant tensor. 

The function to calculate the derivatives of the contravariant tensor and determinant of covariant tensor with respect to the components of the covariant tensor Three dimensions 

Definition at line 218 of file constitutive\+\_\+laws.\+cc.



References is\+\_\+matrix\+\_\+square(), oomph\+::\+Dense\+Matrix$<$ T $>$\+::ncol(), and oomph\+::\+Global\+\_\+string\+\_\+for\+\_\+annotation\+::string().



Referenced by calculate\+\_\+contravariant().

\mbox{\Hypertarget{classoomph_1_1ConstitutiveLaw_a6076752384082cfa3de3e0cf17daa9aa}\label{classoomph_1_1ConstitutiveLaw_a6076752384082cfa3de3e0cf17daa9aa}} 
\index{oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}!calculate\+\_\+d\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress\+\_\+dG@{calculate\+\_\+d\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress\+\_\+dG}}
\index{calculate\+\_\+d\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress\+\_\+dG@{calculate\+\_\+d\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress\+\_\+dG}!oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}}
\subsubsection{\texorpdfstring{calculate\+\_\+d\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress\+\_\+d\+G()}{calculate\_d\_second\_piola\_kirchhoff\_stress\_dG()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily void oomph\+::\+Constitutive\+Law\+::calculate\+\_\+d\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress\+\_\+dG (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{g,  }\item[{const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{G,  }\item[{const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{sigma,  }\item[{\hyperlink{classoomph_1_1RankFourTensor}{Rank\+Four\+Tensor}$<$ double $>$ \&}]{d\+\_\+sigma\+\_\+dG,  }\item[{const bool \&}]{symmetrize\+\_\+tensor = {\ttfamily true} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Calculate the derivatives of the contravariant 2nd Piola Kirchhoff stress tensor with respect to the deformed metric tensor. Arguments are the covariant undeformed and deformed metric tensor, the current value of the stress tensor and the rank four tensor in which to return the derivatives of the stress tensor The default implementation uses finite differences, but can be overloaded for constitutive laws in which an analytic formulation is possible. If the boolean flag symmetrize\+\_\+tensor is false, only the \char`\"{}upper  triangular\char`\"{} entries of the tensor will be filled in. This is a useful efficiency when using the derivatives in Jacobian calculations. 

Calculate the derivatives of the contravariant 2nd Piola Kirchhoff stress tensor with respect to the deformed metric tensor. Arguments are the covariant undeformed and deformed metric tensor and the matrix in which to return the derivatives of the stress tensor The default implementation uses finite differences, but can be overloaded for constitutive laws in which an analytic formulation is possible. 

Definition at line 344 of file constitutive\+\_\+laws.\+cc.



References are\+\_\+matrices\+\_\+of\+\_\+equal\+\_\+dimensions(), calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress(), oomph\+::\+Generalised\+Element\+::\+Default\+\_\+fd\+\_\+jacobian\+\_\+step, i, and oomph\+::\+Dense\+Matrix$<$ T $>$\+::ncol().



Referenced by oomph\+::\+P\+V\+D\+Equations$<$ D\+I\+M $>$\+::get\+\_\+d\+\_\+stress\+\_\+d\+G\+\_\+upper().

\mbox{\Hypertarget{classoomph_1_1ConstitutiveLaw_af13f9d05db09870d1b90b7ef389bdb71}\label{classoomph_1_1ConstitutiveLaw_af13f9d05db09870d1b90b7ef389bdb71}} 
\index{oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}!calculate\+\_\+d\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress\+\_\+dG@{calculate\+\_\+d\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress\+\_\+dG}}
\index{calculate\+\_\+d\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress\+\_\+dG@{calculate\+\_\+d\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress\+\_\+dG}!oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}}
\subsubsection{\texorpdfstring{calculate\+\_\+d\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress\+\_\+d\+G()}{calculate\_d\_second\_piola\_kirchhoff\_stress\_dG()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily void oomph\+::\+Constitutive\+Law\+::calculate\+\_\+d\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress\+\_\+dG (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{g,  }\item[{const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{G,  }\item[{const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{sigma,  }\item[{const double \&}]{detG,  }\item[{const double \&}]{interpolated\+\_\+solid\+\_\+p,  }\item[{\hyperlink{classoomph_1_1RankFourTensor}{Rank\+Four\+Tensor}$<$ double $>$ \&}]{d\+\_\+sigma\+\_\+dG,  }\item[{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{d\+\_\+det\+G\+\_\+dG,  }\item[{const bool \&}]{symmetrize\+\_\+tensor = {\ttfamily true} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Calculate the derivatives of the contravariant 2nd Piola Kirchhoff stress tensor $ \sigma^{ij}$. with respect to the deformed metric tensor. Also return the derivatives of the determinant of the deformed metric tensor with respect to the deformed metric tensor. This form is appropriate for truly-\/incompressible materials. The default implementation uses finite differences for the derivatives that depend on the constitutive law, but not for the derivatives of the determinant, which are generic. 

If the boolean flag symmetrize\+\_\+tensor is false, only the \char`\"{}upper  triangular\char`\"{} entries of the tensor will be filled in. This is a useful efficiency when using the derivatives in Jacobian calculations. 

Definition at line 444 of file constitutive\+\_\+laws.\+cc.



References are\+\_\+matrices\+\_\+of\+\_\+equal\+\_\+dimensions(), calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress(), oomph\+::\+Generalised\+Element\+::\+Default\+\_\+fd\+\_\+jacobian\+\_\+step, i, and oomph\+::\+Dense\+Matrix$<$ T $>$\+::ncol().

\mbox{\Hypertarget{classoomph_1_1ConstitutiveLaw_a8a4f1bcac8d308d9ad0013ddf5def505}\label{classoomph_1_1ConstitutiveLaw_a8a4f1bcac8d308d9ad0013ddf5def505}} 
\index{oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}!calculate\+\_\+d\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress\+\_\+dG@{calculate\+\_\+d\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress\+\_\+dG}}
\index{calculate\+\_\+d\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress\+\_\+dG@{calculate\+\_\+d\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress\+\_\+dG}!oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}}
\subsubsection{\texorpdfstring{calculate\+\_\+d\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress\+\_\+d\+G()}{calculate\_d\_second\_piola\_kirchhoff\_stress\_dG()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily void oomph\+::\+Constitutive\+Law\+::calculate\+\_\+d\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress\+\_\+dG (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{g,  }\item[{const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{G,  }\item[{const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{sigma,  }\item[{const double \&}]{gen\+\_\+dil,  }\item[{const double \&}]{inv\+\_\+kappa,  }\item[{const double \&}]{interpolated\+\_\+solid\+\_\+p,  }\item[{\hyperlink{classoomph_1_1RankFourTensor}{Rank\+Four\+Tensor}$<$ double $>$ \&}]{d\+\_\+sigma\+\_\+dG,  }\item[{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{d\+\_\+gen\+\_\+dil\+\_\+dG,  }\item[{const bool \&}]{symmetrize\+\_\+tensor = {\ttfamily true} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Calculate the derivatives of the contravariant 2nd Piola Kirchoff stress tensor with respect to the deformed metric tensor. Also return the derivatives of the generalised dilatation, $ d, $ with respect to the deformed metric tensor. This form is appropriate for near-\/incompressible materials. The default implementation uses finite differences. If the boolean flag symmetrize\+\_\+tensor is false, only the \char`\"{}upper  triangular\char`\"{} entries of the tensor will be filled in. This is a useful efficiency when using the derivatives in Jacobian calculations. 

Calculate the derivatives of the contravariant 2nd Piola Kirchoff stress tensor with respect to the deformed metric tensor. Also return the derivatives of the generalised dilatation, $ d, $ with respect to the deformed metric tensor. This form is appropriate for near-\/incompressible materials. The default implementation uses finite differences. 

Definition at line 556 of file constitutive\+\_\+laws.\+cc.



References are\+\_\+matrices\+\_\+of\+\_\+equal\+\_\+dimensions(), calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress(), oomph\+::\+Generalised\+Hookean\+::calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress(), oomph\+::\+Generalised\+Element\+::\+Default\+\_\+fd\+\_\+jacobian\+\_\+step, i, and oomph\+::\+Dense\+Matrix$<$ T $>$\+::ncol().

\mbox{\Hypertarget{classoomph_1_1ConstitutiveLaw_a93527d910de908035feb8f41b0401065}\label{classoomph_1_1ConstitutiveLaw_a93527d910de908035feb8f41b0401065}} 
\index{oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}!calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress@{calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress}}
\index{calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress@{calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress}!oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}}
\subsubsection{\texorpdfstring{calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress()}{calculate\_second\_piola\_kirchhoff\_stress()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily virtual void oomph\+::\+Constitutive\+Law\+::calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{g,  }\item[{const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{G,  }\item[{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{sigma }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [pure virtual]}}



Calculate the contravariant 2nd Piola Kirchhoff stress tensor. Arguments are the covariant undeformed and deformed metric tensor and the matrix in which to return the stress tensor. 



Implemented in \hyperlink{classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw_af6c25617b8be6cc454d6b526ec6121fc}{oomph\+::\+Isotropic\+Strain\+Energy\+Function\+Constitutive\+Law}, and \hyperlink{classoomph_1_1GeneralisedHookean_a5beca3e59f04d109c394bf9fd24bb7c1}{oomph\+::\+Generalised\+Hookean}.



Referenced by calculate\+\_\+d\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress\+\_\+d\+G(), oomph\+::\+Generalised\+Hookean\+::calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress(), oomph\+::\+Axisymmetric\+P\+V\+D\+Equations\+::get\+\_\+stress(), and oomph\+::\+P\+V\+D\+Equations$<$ D\+I\+M $>$\+::get\+\_\+stress().

\mbox{\Hypertarget{classoomph_1_1ConstitutiveLaw_ac8178b1b7cd7e6a64942dba9e0997b30}\label{classoomph_1_1ConstitutiveLaw_ac8178b1b7cd7e6a64942dba9e0997b30}} 
\index{oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}!calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress@{calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress}}
\index{calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress@{calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress}!oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}}
\subsubsection{\texorpdfstring{calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress()}{calculate\_second\_piola\_kirchhoff\_stress()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily virtual void oomph\+::\+Constitutive\+Law\+::calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{g,  }\item[{const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{G,  }\item[{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{sigma\+\_\+dev,  }\item[{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{G\+\_\+contra,  }\item[{double \&}]{Gdet }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Calculate the deviatoric part $ \overline{ \sigma^{ij}}$ of the contravariant 2nd Piola Kirchhoff stress tensor $ \sigma^{ij}$. Also return the contravariant deformed metric tensor and the determinant of the deformed metric tensor. This form is appropriate for truly-\/incompressible materials for which $ \sigma^{ij} = - p G^{ij} +\overline{ \sigma^{ij}} $ where the \char`\"{}pressure\char`\"{} $ p $ is determined by $ \det G_{ij} - \det g_{ij} = 0 $. 



Reimplemented in \hyperlink{classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw_acf61673ecc4f960fee908378ac48544a}{oomph\+::\+Isotropic\+Strain\+Energy\+Function\+Constitutive\+Law}, and \hyperlink{classoomph_1_1GeneralisedHookean_a641d0893e485df52b48b15e189a850ed}{oomph\+::\+Generalised\+Hookean}.



Definition at line 565 of file constitutive\+\_\+laws.\+h.

\mbox{\Hypertarget{classoomph_1_1ConstitutiveLaw_a26f34355b626bebcad8f498fa5271d20}\label{classoomph_1_1ConstitutiveLaw_a26f34355b626bebcad8f498fa5271d20}} 
\index{oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}!calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress@{calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress}}
\index{calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress@{calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress}!oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}}
\subsubsection{\texorpdfstring{calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress()}{calculate\_second\_piola\_kirchhoff\_stress()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily virtual void oomph\+::\+Constitutive\+Law\+::calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{g,  }\item[{const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{G,  }\item[{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{sigma\+\_\+dev,  }\item[{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{Gcontra,  }\item[{double \&}]{gen\+\_\+dil,  }\item[{double \&}]{inv\+\_\+kappa }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Calculate the deviatoric part of the contravariant 2nd Piola Kirchoff stress tensor. Also return the contravariant deformed metric tensor, the generalised dilatation, $ d, $ and the inverse of the bulk modulus $ \kappa$. This form is appropriate for near-\/incompressible materials for which $ \sigma^{ij} = -p G^{ij} + \overline{ \sigma^{ij}} $ where the \char`\"{}pressure\char`\"{} $ p $ is determined from $ p / \kappa - d =0 $. 



Reimplemented in \hyperlink{classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw_aa45d82d322fda480f88e78cddd557837}{oomph\+::\+Isotropic\+Strain\+Energy\+Function\+Constitutive\+Law}, and \hyperlink{classoomph_1_1GeneralisedHookean_ad19b5e80755f5d8e5513c4199f62fe03}{oomph\+::\+Generalised\+Hookean}.



Definition at line 606 of file constitutive\+\_\+laws.\+h.



References oomph\+::\+Strain\+Energy\+Function\+::requires\+\_\+incompressibility\+\_\+constraint().

\mbox{\Hypertarget{classoomph_1_1ConstitutiveLaw_a01763658a56a962460a80607653a33b4}\label{classoomph_1_1ConstitutiveLaw_a01763658a56a962460a80607653a33b4}} 
\index{oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}!error\+\_\+checking\+\_\+in\+\_\+input@{error\+\_\+checking\+\_\+in\+\_\+input}}
\index{error\+\_\+checking\+\_\+in\+\_\+input@{error\+\_\+checking\+\_\+in\+\_\+input}!oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}}
\subsubsection{\texorpdfstring{error\+\_\+checking\+\_\+in\+\_\+input()}{error\_checking\_in\_input()}}
{\footnotesize\ttfamily void oomph\+::\+Constitutive\+Law\+::error\+\_\+checking\+\_\+in\+\_\+input (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{g,  }\item[{const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{G,  }\item[{\hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{sigma }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Check for errors in the input, i.\+e. check that the dimensions of the arrays are all consistent. 

This function is used to provide simple error (bounce) checks on the input to any calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress 

Definition at line 64 of file constitutive\+\_\+laws.\+cc.



References are\+\_\+matrices\+\_\+of\+\_\+equal\+\_\+dimensions(), calculate\+\_\+contravariant(), is\+\_\+matrix\+\_\+square(), and oomph\+::\+Global\+\_\+string\+\_\+for\+\_\+annotation\+::string().



Referenced by oomph\+::\+Generalised\+Hookean\+::calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress(), and oomph\+::\+Isotropic\+Strain\+Energy\+Function\+Constitutive\+Law\+::calculate\+\_\+second\+\_\+piola\+\_\+kirchhoff\+\_\+stress().

\mbox{\Hypertarget{classoomph_1_1ConstitutiveLaw_a73f01e1459e7ba998ef78f7ece6baa37}\label{classoomph_1_1ConstitutiveLaw_a73f01e1459e7ba998ef78f7ece6baa37}} 
\index{oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}!is\+\_\+matrix\+\_\+square@{is\+\_\+matrix\+\_\+square}}
\index{is\+\_\+matrix\+\_\+square@{is\+\_\+matrix\+\_\+square}!oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}}
\subsubsection{\texorpdfstring{is\+\_\+matrix\+\_\+square()}{is\_matrix\_square()}}
{\footnotesize\ttfamily bool oomph\+::\+Constitutive\+Law\+::is\+\_\+matrix\+\_\+square (\begin{DoxyParamCaption}\item[{const \hyperlink{classoomph_1_1DenseMatrix}{Dense\+Matrix}$<$ double $>$ \&}]{M }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Test whether a matrix is square. 

This function is used to check whether a matrix is square. 

Definition at line 41 of file constitutive\+\_\+laws.\+cc.



References oomph\+::\+Dense\+Matrix$<$ T $>$\+::ncol(), and oomph\+::\+Dense\+Matrix$<$ T $>$\+::nrow().



Referenced by calculate\+\_\+contravariant(), calculate\+\_\+d\+\_\+contravariant\+\_\+d\+G(), and error\+\_\+checking\+\_\+in\+\_\+input().

\mbox{\Hypertarget{classoomph_1_1ConstitutiveLaw_a446452158a8ae9fbc3dde4277155f824}\label{classoomph_1_1ConstitutiveLaw_a446452158a8ae9fbc3dde4277155f824}} 
\index{oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}!requires\+\_\+incompressibility\+\_\+constraint@{requires\+\_\+incompressibility\+\_\+constraint}}
\index{requires\+\_\+incompressibility\+\_\+constraint@{requires\+\_\+incompressibility\+\_\+constraint}!oomph\+::\+Constitutive\+Law@{oomph\+::\+Constitutive\+Law}}
\subsubsection{\texorpdfstring{requires\+\_\+incompressibility\+\_\+constraint()}{requires\_incompressibility\_constraint()}}
{\footnotesize\ttfamily virtual bool oomph\+::\+Constitutive\+Law\+::requires\+\_\+incompressibility\+\_\+constraint (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [pure virtual]}}



Pure virtual function in which the user must declare if the constitutive equation requires an incompressible formulation in which the volume constraint is enforced explicitly. Used as a sanity check in P\+A\+R\+A\+N\+O\+ID mode. 



Implemented in \hyperlink{classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw_a6b9a454988b023a42782f78e4e3eebc4}{oomph\+::\+Isotropic\+Strain\+Energy\+Function\+Constitutive\+Law}, and \hyperlink{classoomph_1_1GeneralisedHookean_a9ed467d8b7c838cb7fed8c861aa652e9}{oomph\+::\+Generalised\+Hookean}.



Referenced by oomph\+::\+Refineable\+P\+V\+D\+Equations$<$ D\+I\+M $>$\+::fill\+\_\+in\+\_\+generic\+\_\+contribution\+\_\+to\+\_\+residuals\+\_\+pvd(), oomph\+::\+P\+V\+D\+Equations$<$ D\+I\+M $>$\+::fill\+\_\+in\+\_\+generic\+\_\+contribution\+\_\+to\+\_\+residuals\+\_\+pvd(), oomph\+::\+Refineable\+P\+V\+D\+Equations\+With\+Pressure$<$ D\+I\+M $>$\+::fill\+\_\+in\+\_\+generic\+\_\+residual\+\_\+contribution\+\_\+pvd\+\_\+with\+\_\+pressure(), and oomph\+::\+P\+V\+D\+Equations\+With\+Pressure$<$ D\+I\+M $>$\+::fill\+\_\+in\+\_\+generic\+\_\+residual\+\_\+contribution\+\_\+pvd\+\_\+with\+\_\+pressure().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
\hyperlink{constitutive__laws_8h}{constitutive\+\_\+laws.\+h}\item 
\hyperlink{constitutive__laws_8cc}{constitutive\+\_\+laws.\+cc}\end{DoxyCompactItemize}
